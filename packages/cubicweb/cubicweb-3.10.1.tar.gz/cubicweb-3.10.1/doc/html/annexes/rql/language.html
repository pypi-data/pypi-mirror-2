<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>3.2. RQL syntax &mdash; CubicWeb 3.10.1</title>
    <link rel="stylesheet" href="../../_static/lglb-sphinx-doc.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '3.10.1',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="CubicWeb 3.10.1" href="../../index.html" />
    <link rel="up" title="3. Relation Query Language (RQL)" href="index.html" />
    <link rel="next" title="3.3. Debugging RQL" href="debugging.html" />
    <link rel="prev" title="3.1. Introduction" href="intro.html" /> 
  </head>
  <body>
<div class="header">
 <a href="http://www.cubicweb.org">
  <img alt="cubicweb logo" src="../../_static/cubicweb.png"/>
 </a>
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../modindex.html" title="Global Module Index"
             accesskey="M">modules</a> |</li>
        <li class="right" >
          <a href="debugging.html" title="3.3. Debugging RQL"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="intro.html" title="3.1. Introduction"
             accesskey="P">previous</a> |</li>
        <li><a href="../../index.html">CubicWeb 3.10.1</a> &raquo;</li>
          <li><a href="../index.html" >Appendixes</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">3. Relation Query Language (RQL)</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="../../index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference external" href="#">3.2. RQL syntax</a><ul>
<li><a class="reference external" href="#reserved-keywords">3.2.1. Reserved keywords</a></li>
<li><a class="reference external" href="#variables-and-typing">3.2.2. Variables and Typing</a><ul>
<li><a class="reference external" href="#built-in-types">3.2.2.1. Built-in types</a></li>
</ul>
</li>
<li><a class="reference external" href="#operators">3.2.3. Operators</a><ul>
<li><a class="reference external" href="#logical-operators">3.2.3.1. Logical Operators</a></li>
<li><a class="reference external" href="#mathematical-operators">3.2.3.2. Mathematical Operators</a></li>
<li><a class="reference external" href="#comparison-operators">3.2.3.3. Comparison operators</a></li>
<li><a class="reference external" href="#operators-priority">3.2.3.4. Operators priority</a></li>
</ul>
</li>
<li><a class="reference external" href="#search-query">3.2.4. Search Query</a><ul>
<li><a class="reference external" href="#sorting-and-groups">3.2.4.1. Sorting and groups</a></li>
<li><a class="reference external" href="#having">3.2.4.2. Having</a></li>
<li><a class="reference external" href="#negation">3.2.4.3. Negation</a></li>
<li><a class="reference external" href="#identity">3.2.4.4. Identity</a></li>
<li><a class="reference external" href="#limit-offset">3.2.4.5. Limit / offset</a></li>
<li><a class="reference external" href="#exists">3.2.4.6. Exists</a></li>
<li><a class="reference external" href="#optional-relations">3.2.4.7. Optional relations</a></li>
<li><a class="reference external" href="#subqueries">3.2.4.8. Subqueries</a></li>
<li><a class="reference external" href="#function-calls">3.2.4.9. Function calls</a></li>
</ul>
</li>
<li><a class="reference external" href="#examples">3.2.5. Examples</a></li>
<li><a class="reference external" href="#insertion-query">3.2.6. Insertion query</a></li>
<li><a class="reference external" href="#update-and-relation-creation-queries">3.2.7. Update and relation creation queries</a></li>
<li><a class="reference external" href="#deletion-query">3.2.8. Deletion query</a></li>
<li><a class="reference external" href="#virtual-rql-relations">3.2.9. Virtual RQL relations</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="intro.html"
                                  title="previous chapter">3.1. Introduction</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="debugging.html"
                                  title="next chapter">3.3. Debugging RQL</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../_sources/annexes/rql/language.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="rql-syntax">
<span id="rql"></span><h1>3.2. RQL syntax<a class="headerlink" href="#rql-syntax" title="Permalink to this headline">¶</a></h1>
<div class="section" id="reserved-keywords">
<h2>3.2.1. Reserved keywords<a class="headerlink" href="#reserved-keywords" title="Permalink to this headline">¶</a></h2>
<p>The keywords are not case sensitive.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">AND</span><span class="p">,</span> <span class="n">ASC</span><span class="p">,</span> <span class="n">BEING</span><span class="p">,</span> <span class="n">DELETE</span><span class="p">,</span> <span class="n">DESC</span><span class="p">,</span> <span class="n">DISTINCT</span><span class="p">,</span> <span class="n">EXISTS</span><span class="p">,</span> <span class="n">FALSE</span><span class="p">,</span> <span class="n">GROUPBY</span><span class="p">,</span>
<span class="n">HAVING</span><span class="p">,</span> <span class="n">ILIKE</span><span class="p">,</span> <span class="n">IN</span><span class="p">,</span> <span class="n">INSERT</span><span class="p">,</span> <span class="n">LIKE</span><span class="p">,</span> <span class="n">LIMIT</span><span class="p">,</span> <span class="n">NOT</span><span class="p">,</span> <span class="n">NOW</span><span class="p">,</span> <span class="n">NULL</span><span class="p">,</span> <span class="n">OFFSET</span><span class="p">,</span>
<span class="n">OR</span><span class="p">,</span> <span class="n">ORDERBY</span><span class="p">,</span> <span class="n">SET</span><span class="p">,</span> <span class="n">TODAY</span><span class="p">,</span> <span class="n">TRUE</span><span class="p">,</span> <span class="n">UNION</span><span class="p">,</span> <span class="n">WHERE</span><span class="p">,</span> <span class="n">WITH</span>
</pre></div>
</div>
</div>
<div class="section" id="variables-and-typing">
<h2>3.2.2. Variables and Typing<a class="headerlink" href="#variables-and-typing" title="Permalink to this headline">¶</a></h2>
<p>With RQL, we do not distinguish between entities and attributes. The
value of an attribute is considered an entity of a particular type (see
below), linked to one (real) entity by a relation called the name of
the attribute.</p>
<p>Entities and values to browse and/or select are represented in
the query by <em>variables</em> that must be written in capital letters.</p>
<p>There is a special type <strong>Any</strong>, referring to a non specific type.</p>
<p>We can restrict the possible types for a variable using the
special relation <strong>is</strong> in the constraints.</p>
<p>The possible type(s) for each variable is derived from the schema
according to the constraints expressed above and thanks to the relations
between each variable.</p>
<div class="section" id="built-in-types">
<h3>3.2.2.1. Built-in types<a class="headerlink" href="#built-in-types" title="Permalink to this headline">¶</a></h3>
<p>The base types supported are string (between double or single quotes),
integers or floats (the separator is &#8216;.&#8217;), dates and
boolean. We expect to receive a schema in which types String,
Int, Float, Date and Boolean are defined.</p>
<ul class="simple">
<li><cite>String</cite> (literal: between double or single quotes).</li>
<li><cite>Int</cite>, <cite>Float</cite> (separator being&#8217;.&#8217;).</li>
<li><cite>Date</cite>, <cite>Datetime</cite>, <cite>Time</cite> (literal: string YYYY/MM/DD [hh:mm] or keywords
<cite>TODAY</cite> and <cite>NOW</cite>).</li>
<li><cite>Boolean</cite> (keywords <cite>TRUE</cite> and <cite>FALSE</cite>).</li>
<li><cite>Keyword</cite> NULL.</li>
</ul>
</div>
</div>
<div class="section" id="operators">
<h2>3.2.3. Operators<a class="headerlink" href="#operators" title="Permalink to this headline">¶</a></h2>
<div class="section" id="logical-operators">
<h3>3.2.3.1. Logical Operators<a class="headerlink" href="#logical-operators" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><pre>   AND, OR, NOT, ','

',' is equivalent to 'AND' but with the smallest among the priority
of logical operators (see :ref:`PriorityOperators`).</pre>
</div>
</div>
<div class="section" id="mathematical-operators">
<h3>3.2.3.2. Mathematical Operators<a class="headerlink" href="#mathematical-operators" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><pre>+, -, *, /</pre>
</div>
</div>
<div class="section" id="comparison-operators">
<h3>3.2.3.3. Comparison operators<a class="headerlink" href="#comparison-operators" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><pre>=, &lt;, &lt;=, &gt;=, &gt;, ~=, IN, LIKE, ILIKE</pre>
</div>
<ul>
<li><p class="first">Syntax to use comparison operator:</p>
<blockquote>
<p><cite>VARIABLE relation operator VALUE</cite></p>
</blockquote>
</li>
<li><p class="first">The operator <cite>=</cite> is the default operator and can be omitted.</p>
</li>
<li><p class="first"><cite>relation</cite> name is always attended</p>
</li>
<li><p class="first">The operator <cite>LIKE</cite> equivalent to <cite>~=</cite> can be used with the
special character <cite>%</cite> in a string to indicate that the chain
must start or finish by a prefix/suffix:</p>
<div class="highlight-python"><pre>Any X WHERE X name ~= 'Th%'
Any X WHERE X name LIKE '%lt'</pre>
</div>
</li>
<li><p class="first">The operator <cite>ILIKE</cite> is the case insensitive version of <cite>LIKE</cite>.</p>
</li>
<li><p class="first">The operator <cite>IN</cite> provides a list of possible values:</p>
<div class="highlight-python"><pre>Any X WHERE X name IN ('chauvat', 'fayolle', 'di mascio', 'thenault')</pre>
</div>
</li>
</ul>
</div>
<div class="section" id="operators-priority">
<span id="priorityoperators"></span><h3>3.2.3.4. Operators priority<a class="headerlink" href="#operators-priority" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>&#8220;(&#8220;, &#8220;)&#8221;</li>
<li>&#8216;*&#8217;, &#8216;/&#8217;</li>
<li>&#8216;+&#8217;, &#8216;-&#8216;</li>
<li>&#8216;NOT&#8217;</li>
<li>&#8216;AND&#8217;</li>
<li>&#8216;OR&#8217;</li>
<li>&#8216;,&#8217;</li>
</ol>
</div>
</div>
<div class="section" id="search-query">
<h2>3.2.4. Search Query<a class="headerlink" href="#search-query" title="Permalink to this headline">¶</a></h2>
<blockquote>
[ <cite>DISTINCT</cite>] &lt;entity type&gt; V1 (, V2) *
[ <cite>GROUPBY</cite> V1 (V2) *] [ <cite>ORDERBY</cite> &lt;orderterms&gt;]
[ <cite>LIMIT</cite> &lt;value&gt;] [ <cite>OFFSET</cite> &lt;value&gt;]
[ <cite>WHERE</cite> &lt;restriction&gt;]
[ <cite>WITH</cite> V1 (, V2) * BEING (&lt;query&gt;)]
[ <cite>HAVING</cite> &lt;restriction&gt;]
[ <cite>UNION</cite> &lt;query&gt;]</blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">entity type:</th><td class="field-body"><p class="first">Type of selected variables.
The special type <cite>Any</cite> is equivalent to not specify a type.</p>
</td>
</tr>
<tr class="field"><th class="field-name">restriction:</th><td class="field-body"><dl class="first docutils">
<dt>list of conditions to test successively</dt>
<dd><p class="first last"><cite>V1 relation V2 | &lt;static value&gt;</cite></p>
</dd>
</dl>
</td>
</tr>
<tr class="field"><th class="field-name">orderterms:</th><td class="field-body"><p class="first">Definition of the selection order: variable or column number followed by
sorting method ( <cite>ASC</cite>, <cite>DESC</cite>), ASC is the default.</p>
</td>
</tr>
<tr class="field"><th class="field-name" colspan="2">note for grouped queries:</th></tr>
<tr><td>&nbsp;</td><td class="field-body"><p class="first last">For grouped queries (e.g., a clause <cite>GROUPBY</cite>), all
selected variables must be aggregated or grouped.</p>
</td>
</tr>
</tbody>
</table>
<div class="section" id="sorting-and-groups">
<h3>3.2.4.1. Sorting and groups<a class="headerlink" href="#sorting-and-groups" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>For grouped queries (e.g. with a GROUPBY clause), all
selected variables should be grouped at the right of the keyword.</li>
<li>If the sorting method (SORT_METHOD) is not specified, then the sorting is
ascendant (<cite>ASC</cite>).</li>
<li>Aggregate Functions: COUNT, MIN, MAX, AVG, SUM, GROUP_CONCAT</li>
</ul>
</div>
<div class="section" id="having">
<h3>3.2.4.2. Having<a class="headerlink" href="#having" title="Permalink to this headline">¶</a></h3>
<p>The HAVING clause, as in SQL, has been originally introduced to restrict a query
according to value returned by an aggregate function, e.g.:</p>
<div class="highlight-python"><pre>Any X GROUPBY X WHERE X relation Y HAVING COUNT(Y) &gt; 10</pre>
</div>
<p>It may however be used for something else...</p>
<p>In the WHERE clause, we are limited to 3-expression, such thing can&#8217;t be
expressed directly as in the SQL&#8217;s way. But this can be expressed using HAVING
comparison expression.</p>
<p>For instance, let&#8217;s say you want to get people whose uppercased first name equals
to another person uppercased first name:</p>
<div class="highlight-python"><pre>Person X WHERE X firstname XFN, Y firstname YFN HAVING X &gt; Y, UPPER(XFN) = UPPER(YFN)</pre>
</div>
<p>This open some new possibilities. Another example:</p>
<div class="highlight-python"><pre>Person X WHERE X birthday XB HAVING YEAR(XB) = 2000</pre>
</div>
<p>That lets you use transformation functions not only in selection but for
restriction as well and to by-pass limitation of the WHERE clause, which was the
major flaw in the RQL language.</p>
<p>Notice that while we would like this to work without the HAVING clause, this
can&#8217;t be currently be done because it introduces an ambiguity in RQL&#8217;s grammar
that can&#8217;t be handled by <a class="reference external" href="http://theory.stanford.edu/~amitp/yapps/">Yapps</a>, the parser&#8217;s generator we&#8217;re using.</p>
</div>
<div class="section" id="negation">
<h3>3.2.4.3. Negation<a class="headerlink" href="#negation" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>A query such as <cite>Document X WHERE NOT X owned_by U</cite> means &#8220;the documents have
no relation <cite>owned_by</cite>&#8220;.</li>
<li>But the query <cite>Document X WHERE NOT X owned_by U, U login &#8220;syt&#8221;</cite> means &#8220;the
documents have no relation <cite>owned_by</cite> with the user syt&#8221;. They may have a
relation &#8220;owned_by&#8221; with another user.</li>
</ul>
</div>
<div class="section" id="identity">
<h3>3.2.4.4. Identity<a class="headerlink" href="#identity" title="Permalink to this headline">¶</a></h3>
<p>You can use the special relation <cite>identity</cite> in a query to
add an identity constraint between two variables. This is equivalent
to <tt class="docutils literal"><span class="pre">is</span></tt> in python:</p>
<div class="highlight-python"><pre>Any A WHERE A comments B, A identity B</pre>
</div>
<p>return all objects that comment themselves. The relation <cite>identity</cite> is
especially useful when defining the rules for securities with <cite>RQLExpressions</cite>.</p>
</div>
<div class="section" id="limit-offset">
<h3>3.2.4.5. Limit / offset<a class="headerlink" href="#limit-offset" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><pre>Any P ORDERBY N LIMIT 5 OFFSET 10 WHERE P is Person, P firstname N</pre>
</div>
</div>
<div class="section" id="exists">
<h3>3.2.4.6. Exists<a class="headerlink" href="#exists" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><pre>Any X ORDERBY PN,N
WHERE X num N, X version_of P, P name PN,
      EXISTS(X in_state S, S name IN ("dev", "ready"))
      OR EXISTS(T tags X, T name "priority")</pre>
</div>
</div>
<div class="section" id="optional-relations">
<h3>3.2.4.7. Optional relations<a class="headerlink" href="#optional-relations" title="Permalink to this headline">¶</a></h3>
<p>It is a similar concept that the <a class="reference external" href="http://en.wikipedia.org/wiki/Join_(SQL)#Left_outer_join">Left outer join</a>:</p>
<blockquote>
the result of a left outer join (or simply left join) for table A and B
always contains all records of the &#8220;left&#8221; table (A), even if the
join-condition does not find any matching record in the &#8220;right&#8221; table (B).</blockquote>
<ul>
<li><p class="first">They allow you to select entities related or not to another.</p>
</li>
<li><p class="first">You must use the <cite>?</cite> behind the variable to specify that the relation
toward it is optional:</p>
<blockquote>
<ul>
<li><p class="first">Anomalies of a project attached or not to a version</p>
<div class="highlight-python"><pre>Any X, V WHERE X concerns P, P eid 42, X corrected_in V?</pre>
</div>
</li>
<li><p class="first">All cards and the project they document if necessary</p>
<div class="highlight-python"><pre>Any C, P WHERE C is Card, P? documented_by C</pre>
</div>
</li>
</ul>
<blockquote>
<p>Any T,P,V WHERE T is Ticket, T concerns P, T done_in V?</p>
</blockquote>
</blockquote>
</li>
</ul>
</div>
<div class="section" id="subqueries">
<h3>3.2.4.8. Subqueries<a class="headerlink" href="#subqueries" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><pre>(Any X WHERE X is Person) UNION (Any X WHERE X is Company)


 DISTINCT Any W, REF
    WITH W, REF BEING
        (
          (Any W, REF WHERE W is Workcase, W ref REF,
                             W concerned_by D, D name "Logilab")
           UNION
          (Any W, REF WHERE W is Workcase, W ref REF, '
                            W split_into WP, WP name "WP1")
        )</pre>
</div>
</div>
<div class="section" id="function-calls">
<h3>3.2.4.9. Function calls<a class="headerlink" href="#function-calls" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><pre>Any UPPER(N) WHERE P firstname N
Any LOWER(N) WHERE P firstname N</pre>
</div>
<p>Functions available on string: <cite>UPPER</cite>, <cite>LOWER</cite></p>
<p>For a performance issue, you can enrich the RQL dialect by RDMS (Relational database management system) functions.</p>
</div>
</div>
<div class="section" id="examples">
<h2>3.2.5. Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first"><em>Search for the object of identifier 53</em></p>
<div class="highlight-python"><pre>Any WHERE X
X eid 53</pre>
</div>
</li>
<li><p class="first"><em>Search material such as comics, owned by syt and available</em></p>
<div class="highlight-python"><pre>Any X WHERE X is Document
X occurence_of F, F class C, C name 'Comics'
X owned_by U, U login 'syt'
X available TRUE</pre>
</div>
</li>
<li><p class="first"><em>Looking for people working for eurocopter interested in training</em></p>
<div class="highlight-python"><pre>Any P WHERE
P is Person, P work_for S, S name 'Eurocopter'
P interested_by T, T name 'training'</pre>
</div>
</li>
<li><p class="first"><em>Search note less than 10 days old written by jphc or ocy</em></p>
<div class="highlight-python"><pre>Any N WHERE
N is Note, N written_on D, D day&gt; (today -10),
N written_by P, P name 'jphc' or P name 'ocy'</pre>
</div>
</li>
<li><p class="first"><em>Looking for people interested in training or living in Paris</em></p>
<div class="highlight-python"><pre>Any P WHERE
P is Person, (P interested_by T, T name 'training') OR
(P city 'Paris')</pre>
</div>
</li>
<li><p class="first"><em>The surname and firstname of all people</em></p>
<div class="highlight-python"><pre>Any N, P WHERE
X is Person, X name N, X firstname P</pre>
</div>
<p>Note that the selection of several entities generally force
the use of &#8220;Any&#8221; because the type specification applies otherwise
to all the selected variables. We could write here</p>
<div class="highlight-python"><pre>String N, P WHERE
X is Person, X name N, X first_name P</pre>
</div>
<p>Note: You can not specify several types with * ... where X is FirstType or X is SecondType*.
To specify several types explicitly, you have to do</p>
<div class="highlight-python"><pre>Any X where X is in (FirstType, SecondType)</pre>
</div>
</li>
</ul>
</div>
<div class="section" id="insertion-query">
<h2>3.2.6. Insertion query<a class="headerlink" href="#insertion-query" title="Permalink to this headline">¶</a></h2>
<blockquote>
<cite>INSERT</cite> &lt;entity type&gt; V1 (, &lt;entity type&gt; V2) * <cite>:</cite> &lt;assignments&gt;
[ <cite>WHERE</cite> &lt;restriction&gt;]</blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">assignments:</th><td class="field-body">list of relations to assign in the form <cite>V1 relationship V2 | &lt;static value&gt;</cite></td>
</tr>
</tbody>
</table>
<p>The restriction can define variables used in assignments.</p>
<p>Caution, if a restriction is specified, the insertion is done for
<em>each line result returned by the restriction</em>.</p>
<ul>
<li><p class="first"><em>Insert a new person named &#8216;foo&#8217;</em></p>
<div class="highlight-python"><pre>INSERT Person X: X name 'foo'</pre>
</div>
</li>
<li><p class="first"><em>Insert a new person named &#8216;foo&#8217;, another called &#8216;nice&#8217; and a &#8216;friend&#8217; relation
between them</em></p>
<div class="highlight-python"><pre>INSERT Person X, Person Y: X name 'foo', Y name 'nice', X friend Y</pre>
</div>
</li>
<li><p class="first"><em>Insert a new person named &#8216;foo&#8217; and a &#8216;friend&#8217; relation with an existing
person called &#8216;nice&#8217;</em></p>
<div class="highlight-python"><pre>INSERT Person X: X name 'foo', X friend  Y WHERE name 'nice'</pre>
</div>
</li>
</ul>
</div>
<div class="section" id="update-and-relation-creation-queries">
<h2>3.2.7. Update and relation creation queries<a class="headerlink" href="#update-and-relation-creation-queries" title="Permalink to this headline">¶</a></h2>
<blockquote>
<cite>SET</cite> &lt;assignements&gt;
[ <cite>WHERE</cite> &lt;restriction&gt;]</blockquote>
<p>Caution, if a restriction is specified, the update is done <em>for
each result line returned by the restriction</em>.</p>
<ul>
<li><p class="first"><em>Renaming of the person named &#8216;foo&#8217; to &#8216;bar&#8217; with the first name changed</em></p>
<div class="highlight-python"><pre>SET X name 'bar', X firstname 'original' WHERE X is Person, X name 'foo'</pre>
</div>
</li>
<li><p class="first"><em>Insert a relation of type &#8216;know&#8217; between objects linked by
the relation of type &#8216;friend&#8217;</em></p>
<div class="highlight-python"><pre>SET X know Y  WHERE X friend Y</pre>
</div>
</li>
</ul>
</div>
<div class="section" id="deletion-query">
<h2>3.2.8. Deletion query<a class="headerlink" href="#deletion-query" title="Permalink to this headline">¶</a></h2>
<blockquote>
<cite>DELETE</cite> (&lt;entity type&gt; V) | (V1 relation v2 ),...
[ <cite>WHERE</cite> &lt;restriction&gt;]</blockquote>
<p>Caution, if a restriction is specified, the deletion is made <em>for
each line result returned by the restriction</em>.</p>
<ul>
<li><p class="first"><em>Deletion of the person named &#8216;foo&#8217;</em></p>
<div class="highlight-python"><pre>DELETE Person X WHERE X name 'foo'</pre>
</div>
</li>
<li><p class="first"><em>Removal of all relations of type &#8216;friend&#8217; from the person named &#8216;foo&#8217;</em></p>
<div class="highlight-python"><pre>DELETE X friend Y WHERE X is Person, X name 'foo'</pre>
</div>
</li>
</ul>
</div>
<div class="section" id="virtual-rql-relations">
<h2>3.2.9. Virtual RQL relations<a class="headerlink" href="#virtual-rql-relations" title="Permalink to this headline">¶</a></h2>
<p>Those relations may only be used in RQL query and are not actual
attributes of your entities.</p>
<ul class="simple">
<li><cite>has_text</cite>: relation to use to query the full text index (only for
entities having fulltextindexed attributes).</li>
<li><cite>identity</cite>: <a class="reference internal" href="#identity">Identity</a> relation to use to tell that a RQL variable should be
the same as another (but you&#8217;ve to use two different rql variables
for querying purpose)</li>
<li><cite>is</cite>: relation to enforce possible types for a variable</li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../modindex.html" title="Global Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="debugging.html" title="3.3. Debugging RQL"
             >next</a> |</li>
        <li class="right" >
          <a href="intro.html" title="3.1. Introduction"
             >previous</a> |</li>
        <li><a href="../../index.html">CubicWeb 3.10.1</a> &raquo;</li>
          <li><a href="../index.html" >Appendixes</a> &raquo;</li>
          <li><a href="index.html" >3. Relation Query Language (RQL)</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      &copy; Copyright 2001-2010, Logilab.
      Last updated on Oct 17, 2010.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.4.
    </div>
  </body>
</html>