<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>1. Installation and set-up of a CubicWeb environment &mdash; CubicWeb 3.10.7</title>
    <link rel="stylesheet" href="../_static/lglb-sphinx-doc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.10.7',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="CubicWeb 3.10.7" href="../index.html" />
    <link rel="up" title="Administration" href="index.html" />
    <link rel="next" title="2. cubicweb-ctl tool" href="cubicweb-ctl.html" />
    <link rel="prev" title="Administration" href="index.html" /> 
  </head>
  <body>
<div class="header">
 <a href="http://www.cubicweb.org">
  <img alt="cubicweb logo" src="../_static/cubicweb.png"/>
 </a>
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../modindex.html" title="Global Module Index"
             accesskey="M">modules</a> |</li>
        <li class="right" >
          <a href="cubicweb-ctl.html" title="2. cubicweb-ctl tool"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Administration"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">CubicWeb 3.10.7</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Administration</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="../index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference external" href="#">1. Installation and set-up of a <em>CubicWeb</em> environment</a><ul>
<li><a class="reference external" href="#installation-of-cubicweb-and-its-dependencies">1.1. Installation of <cite>Cubicweb</cite> and its dependencies</a><ul>
<li><a class="reference external" href="#debian-and-ubuntu-packages">1.1.1. Debian and Ubuntu packages</a></li>
<li><a class="reference external" href="#installation-with-pip">1.1.2. Installation with pip</a></li>
<li><a class="reference external" href="#installation-with-easyinstall">1.1.3. Installation with EasyInstall</a></li>
<li><a class="reference external" href="#install-from-source">1.1.4. Install from source</a></li>
<li><a class="reference external" href="#install-from-version-control-system">1.1.5. Install from version control system</a></li>
<li><a class="reference external" href="#windowsinstallation">1.1.6. Windows installation</a><ul>
<li><a class="reference external" href="#base-elements">1.1.6.1. Base elements</a></li>
<li><a class="reference external" href="#tools">1.1.6.2. Tools</a></li>
<li><a class="reference external" href="#getting-the-sources">1.1.6.3. Getting the sources</a></li>
<li><a class="reference external" href="#environment-variables">1.1.6.4. Environment variables</a></li>
<li><a class="reference external" href="#running-an-instance-as-a-service">1.1.6.5. Running an instance as a service</a></li>
</ul>
</li>
<li><a class="reference external" href="#other-dependencies">1.1.7. Other dependencies</a></li>
</ul>
</li>
<li><a class="reference external" href="#databases-configuration">1.2. Databases configuration</a><ul>
<li><a class="reference external" href="#postgresql-configuration">1.2.1. PostgreSQL configuration</a></li>
<li><a class="reference external" href="#mysql-configuration">1.2.2. MySql configuration</a></li>
<li><a class="reference external" href="#sqlserver-configuration">1.2.3. SQLServer configuration</a></li>
<li><a class="reference external" href="#sqlite-configuration">1.2.4. SQLite configuration</a></li>
</ul>
</li>
<li><a class="reference external" href="#pyro-configuration">1.3. Pyro configuration</a></li>
<li><a class="reference external" href="#cubicweb-resources-configuration">1.4. Cubicweb resources configuration</a><ul>
<li><a class="reference external" href="#resource-mode">1.4.1. Resource mode</a></li>
<li><a class="reference external" href="#environment-configuration">1.4.2. Environment configuration</a><ul>
<li><a class="reference external" href="#python">1.4.2.1. Python</a></li>
<li><a class="reference external" href="#cubicweb">1.4.2.2. CubicWeb</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="index.html"
                                  title="previous chapter">Administration</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="cubicweb-ctl.html"
                                  title="next chapter">2. <tt class="docutils literal"><span class="pre">cubicweb-ctl</span></tt> tool</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../_sources/admin/setup.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="installation-and-set-up-of-a-cubicweb-environment">
<span id="setupenv"></span><h1>1. Installation and set-up of a <em>CubicWeb</em> environment<a class="headerlink" href="#installation-and-set-up-of-a-cubicweb-environment" title="Permalink to this headline">¶</a></h1>
<div class="section" id="installation-of-cubicweb-and-its-dependencies">
<h2>1.1. Installation of <cite>Cubicweb</cite> and its dependencies<a class="headerlink" href="#installation-of-cubicweb-and-its-dependencies" title="Permalink to this headline">¶</a></h2>
<p><em>CubicWeb</em> is packaged for <a class="reference internal" href="#debianinstallation">Debian and Ubuntu</a>, is <a class="reference internal" href="#pipinstallation">pip installable</a> and
<a class="reference internal" href="#easyinstallinstallation">easy_install installable</a>. It can be installed from source using a <a class="reference internal" href="#tarballinstallation">tarball</a>
or the <a class="reference internal" href="#mercurialinstallation">Mercurial version control system</a> . Windows user may want to check the
<a class="reference internal" href="#windowsinstallation">Windows Installation</a> section.</p>
<p>Also, since version 3.9, can be safely installed, used and contained inside a
<a class="reference external" href="http://pypi.python.org/pypi/virtualenv">virtualenv</a>.</p>
<div class="section" id="debian-and-ubuntu-packages">
<span id="debianinstallation"></span><h3>1.1.1. Debian and Ubuntu packages<a class="headerlink" href="#debian-and-ubuntu-packages" title="Permalink to this headline">¶</a></h3>
<p>Depending on the distribution you are using, add the appropriate line to your
list of sources (for example by editing <tt class="docutils literal"><span class="pre">/etc/apt/sources.list</span></tt>).</p>
<p>For Debian Lenny:</p>
<div class="highlight-python"><pre>deb http://ftp.logilab.org/dists/ lenny/</pre>
</div>
<p>For Debian Sid:</p>
<div class="highlight-python"><pre>deb http://ftp.logilab.org/dists/ sid/</pre>
</div>
<p>For Ubuntu Hardy:</p>
<div class="highlight-python"><pre>deb http://ftp.logilab.org/dists/ hardy/</pre>
</div>
<p>You can now install the required packages with the following command:</p>
<div class="highlight-python"><pre>apt-get update
apt-get install cubicweb cubicweb-dev</pre>
</div>
<p><cite>cubicweb</cite> installs the framework itself, allowing you to create new instances.</p>
<p><cite>cubicweb-dev</cite> installs the development environment allowing you to develop new
cubes.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><cite>cubicweb-dev</cite> will install basic sqlite support. You can easily setup
<a class="reference internal" href="#databaseinstallation">cubicweb with other database</a> using the following virtual packages :
<cite>cubicweb-postgresql-support</cite> contains necessary dependency for using
<a class="reference internal" href="#postgresqlconfiguration">cubicweb with postgresql datatabase</a> and <cite>cubicweb-mysql-support</cite> contains
necessary dependency for using <a class="reference internal" href="#mysqlconfiguration">cubicweb with mysql database</a> .</p>
</div>
<p>There is also a wide variety of <a class="reference external" href="../tutorials/base/components.html#cubes"><em>cubes</em></a> listed on the <a class="reference external" href="http://www.cubicweb.org/project/">CubicWeb.org Forge</a>
available as debian packages and tarball.</p>
<p>The repositories are signed with <a class="reference external" href="http://ftp.logilab.org/dists/logilab-dists-key.asc">Logilab&#8217;s gnupg key</a>. To avoid warning on
&#8220;apt-get update&#8221;:</p>
<ol class="arabic simple">
<li>become root using sudo</li>
<li>download <a class="reference external" href="http://ftp.logilab.org/dists/logilab-dists-key.asc">http://ftp.logilab.org/dists/logilab-dists-key.asc</a> using e.g. wget</li>
<li>run &#8220;apt-key add logilab-dists-key.asc&#8221;</li>
<li>re-run apt-get update (manually or through the package manager, whichever you prefer)</li>
</ol>
</div>
<div class="section" id="installation-with-pip">
<span id="pipinstallation"></span><h3>1.1.2. Installation with pip<a class="headerlink" href="#installation-with-pip" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="http://pypi.python.org/pypi/pip">pip</a> is a smart python utility that lets you automatically download, build,
install, and manage python packages and their dependencies.</p>
<p><em>CubicWeb</em> and its cubes have been <a class="reference external" href="http://pypi.python.org/pypi/pip">pip</a> installable since version 3.9. Search
for them on <a class="reference external" href="http://pypi.python.org/pypi?%3Aaction=search&amp;term=cubicweb">pypi</a>:</p>
<div class="highlight-python"><pre>pip install cubicweb
pip install cubicweb-blog</pre>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Pip is the recommended way to install <em>CubicWeb</em> if there is no binary
package available on your system or you want to install it inside a
<a class="reference external" href="http://pypi.python.org/pypi/virtualenv">virtualenv</a>. However pip doesn&#8217;t install binary package and may require
several compilation steps while installing <em>CubicWeb</em> dependencies. If you
don&#8217;t have a compilation environment you should use  <a class="reference internal" href="#easyinstallinstallation">easy_install
installation</a> to install <em>CubicWeb</em>.</p>
<p class="last">Once, <em>CubicWeb</em> is installed, this limitation doesn&#8217;t apply when installing
cubes.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last"><em>CubicWeb</em> depends upon the <cite>lxml</cite> python module. This module contains <tt class="docutils literal"><span class="pre">C</span></tt>
code that must be compiled.  To successfully install <em>CubicWeb</em> with pip, you
must either have an environment ables to compile Python <tt class="docutils literal"><span class="pre">C</span></tt> extensions or
preinstall lxml from a binary package.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For better performance the setup processor will compile a <tt class="docutils literal"><span class="pre">C</span></tt> extension for
the <a class="reference external" href="../annexes/rql/language.html#rql"><em>RQL</em></a> language if you have an environment ables to compile
Python <tt class="docutils literal"><span class="pre">C</span></tt> extensions and the <a class="reference external" href="http://www.gecode.org/">gecode library</a>.  Otherwise, a pure python
alternative will be used for degraded performance.</p>
</div>
</div>
<div class="section" id="installation-with-easyinstall">
<span id="easyinstallinstallation"></span><h3>1.1.3. Installation with EasyInstall<a class="headerlink" href="#installation-with-easyinstall" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">We don&#8217;t recommend the use of <cite>easy_install</cite> and setuptools in the generic
case. However as easy_install is currently the sole pure python package
system that support binary installation. Using <cite>easy_install</cite> is currently
the easiest way to install <em>CubicWeb</em> when you don&#8217;t have a compilation
environment set-up or Debian based distribution.</p>
</div>
<p><em>CubicWeb</em> is <a class="reference external" href="http://packages.python.org/distribute/easy_install.html">easy_install</a> installable for version 3.9:</p>
<div class="highlight-python"><pre>easy_install cubicweb</pre>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Cubes are <strong>not</strong> is <a class="reference external" href="http://packages.python.org/distribute/easy_install.html">easy_install</a> installable. But they are
<a class="reference internal" href="#pipinstallation">pip installable</a></p>
</div>
</div>
<div class="section" id="install-from-source">
<span id="sourceinstallation"></span><h3>1.1.4. Install from source<a class="headerlink" href="#install-from-source" title="Permalink to this headline">¶</a></h3>
<p id="tarballinstallation">You can download the archive containing the sources from our <a class="reference external" href="http://ftp.logilab.org/pub/cubicweb/">ftp site</a> at:</p>
<div class="highlight-python"><pre>http://ftp.logilab.org/pub/cubicweb/</pre>
</div>
<p>Make sure you also have all the <a class="reference external" href="../annexes/depends.html#installdependencies"><em>Installation dependencies</em></a>.</p>
</div>
<div class="section" id="install-from-version-control-system">
<span id="mercurialinstallation"></span><h3>1.1.5. Install from version control system<a class="headerlink" href="#install-from-version-control-system" title="Permalink to this headline">¶</a></h3>
<p>You can keep up to date with on-going development by using Mercurial:</p>
<div class="highlight-python"><pre>hg clone http://hg.logilab.org/cubicweb</pre>
</div>
<p>See <a class="reference external" href="../annexes/mercurial.html#mercurialpresentation"><em>Introducing Mercurial</em></a> for more details about Mercurial.</p>
<p>A practical way to get many of CubicWeb&#8217;s dependencies and a nice set
of base cubes is to run the <cite>clone_deps.py</cite> script located in
<cite>cubicweb/bin/</cite>:</p>
<div class="highlight-python"><pre>python cubicweb/bin/clone_deps.py</pre>
</div>
<p>(Windows users should replace slashes with antislashes).</p>
<p>This script will clone a set of mercurial repositories into in the
directory containing the CubicWeb repository, and update them to the
latest published version tag (if any).</p>
<p>When cloning a repository, you might be set in a development branch
(the &#8216;default&#8217; branch). You should check that the branches of the
repositories are set to &#8216;stable&#8217; (using <cite>hg up stable</cite> for each one)
if you do not intend to develop the framework itself.</p>
<p>Even better, <cite>hg tags</cite> will display a list of tags in reverse
chronological order. One reasonnable way to get to a working version
is to pick the latest published version (as done by the <cite>clone_deps</cite>
script). These look like <cite>cubicweb-debian-version-3.9.7-1</cite>. Typing:</p>
<div class="highlight-python"><pre>hg update cubicweb-debian-version-3.9.7-1</pre>
</div>
<p>will update the repository files to this version.</p>
<p>Make sure you also have all the <a class="reference external" href="../annexes/depends.html#installdependencies"><em>Installation dependencies</em></a>.</p>
</div>
<div class="section" id="windowsinstallation">
<span id="id1"></span><h3>1.1.6. Windows installation<a class="headerlink" href="#windowsinstallation" title="Permalink to this headline">¶</a></h3>
<p>Your best option is probably the <a class="reference internal" href="#pipinstallation"><em>Installation with pip</em></a>. If it does not work or
if you want more control over the process, continue with the following
instructions.</p>
<div class="section" id="base-elements">
<h4>1.1.6.1. Base elements<a class="headerlink" href="#base-elements" title="Permalink to this headline">¶</a></h4>
<p>Setting up a windows development environment is not too complicated but requires
a series of small steps. What is proposed there is only an example of what can be
done. We assume everything goes into <cite>C:\</cite> in this document. Adjusting the
installation drive should be straightforward.</p>
<p>You should start by downloading and installing Python version &gt;= 2.5 and &lt; 3.</p>
<p>An alternative option would be installing the Python(x,y)
distribution. Python(x,y) is not a requirement, but it makes things easier for
Windows user by wrapping in a single installer python 2.5 plus numerous useful
third-party modules and applications (including Eclipse + pydev, which is an
arguably good IDE for Python under Windows). Download it from this page:</p>
<div class="highlight-python"><pre>http://code.google.com/p/pythonxy/wiki/Downloads</pre>
</div>
<p>Then you must grab Twisted. There is a windows installer directly available from
this page:</p>
<div class="highlight-python"><pre>http://twistedmatrix.com/trac/</pre>
</div>
<p>A windows installer for lxml will be found there:</p>
<div class="highlight-python"><pre>http://pypi.python.org/pypi/lxml/2.2.1</pre>
</div>
<p>Check out the lxml-2.2.1-win32-py2.5.exe file. More recent bugfix
releases should probably work, too.</p>
<p>You should find postgresql 8.4 there:</p>
<div class="highlight-python"><pre>http://www.enterprisedb.com/products/pgdownload.do#windows</pre>
</div>
<p>The python drivers for posgtresql are to be found there:</p>
<div class="highlight-python"><pre>http://www.stickpeople.com/projects/python/win-psycopg/#Version2</pre>
</div>
<p>Please be careful to select the right python (2.5) and postgres (8.4) versions.</p>
<p>A windows compiled recent version of gettext:</p>
<div class="highlight-python"><pre>http://ftp.logilab.org/pub/gettext/gettext-0.17-win32-setup.exe</pre>
</div>
<p>A pre-compiled version of rql for windows (take care of retrieving the
most recent version available there):</p>
<div class="highlight-python"><pre>http://ftp.logilab.org/pub/rql/rql-0.23.0.win32-py2.5.exe</pre>
</div>
<p>Pyro enables remote access to cubicweb repository instances. Get it there:</p>
<div class="highlight-python"><pre>http://sourceforge.net/projects/pyro/files/</pre>
</div>
<p>To access LDAP/Active directory directories, we need the python-ldap
package. Windows binaries are available from:</p>
<div class="highlight-python"><pre>http://www.osuch.org/python-ldap</pre>
</div>
<p>Check out the latest release.</p>
<p>Having graphviz will allow schema drawings, which is quite recommended (albeit
not mandatory). You should get an msi installer there:</p>
<div class="highlight-python"><pre>http://www.graphviz.org/Download_windows.php</pre>
</div>
<p>Simplejson is needed when installing with Python 2.5, but included in the
standard library for Python &gt;= 2.6. Get it from there:</p>
<div class="highlight-python"><pre>http://www.osuch.org/python-simplejson%3Awin32</pre>
</div>
<p>Make sure you also have all the <a class="reference external" href="../annexes/depends.html#installdependencies"><em>Installation dependencies</em></a> that are not specific
to Windows.</p>
</div>
<div class="section" id="tools">
<h4>1.1.6.2. Tools<a class="headerlink" href="#tools" title="Permalink to this headline">¶</a></h4>
<p>Get mercurial + its standard windows GUI (TortoiseHG) there (the latest is the
greatest):</p>
<div class="highlight-python"><pre>http://bitbucket.org/tortoisehg/stable/wiki/download</pre>
</div>
<p>If you need to peruse mercurial over ssh, it can be helpful to get an ssh client
like Putty:</p>
<div class="highlight-python"><pre>http://www.putty.org/</pre>
</div>
<p>Integration of mercurial and Eclipse is convenient enough that we want
it. Instructions are set there, in the <cite>Download &amp; Install</cite> section:</p>
<div class="highlight-python"><pre>http://www.vectrace.com/mercurialeclipse/</pre>
</div>
</div>
<div class="section" id="getting-the-sources">
<h4>1.1.6.3. Getting the sources<a class="headerlink" href="#getting-the-sources" title="Permalink to this headline">¶</a></h4>
<p>You can either download the latest release (see
<a class="reference internal" href="#sourceinstallation"><em>Install from source</em></a>) or get the development version using
Mercurial (see <a class="reference internal" href="#mercurialinstallation"><em>Install from version control system</em></a> and below), which is more
convenient.</p>
</div>
<div class="section" id="environment-variables">
<h4>1.1.6.4. Environment variables<a class="headerlink" href="#environment-variables" title="Permalink to this headline">¶</a></h4>
<p>You will need some convenience environment variables once all is set up. These
variables are settable through the GUI by getting at the &#8216;System properties&#8217;
window (by righ-clicking on &#8216;My Computer&#8217; -&gt; properties).</p>
<p>In the &#8216;advanced&#8217; tab, there is an &#8216;Environment variables&#8217; button. Click on
it. That opens a small window allowing edition of user-related and system-wide
variables.</p>
<p>We will consider only user variables. First, the PATH variable. You should ensure
it contains, separated by semi-colons, and assuming you are logged in as user
Jane:</p>
<div class="highlight-python"><pre>C:\Documents and Settings\Jane\My Documents\Python\cubicweb\cubicweb\bin
C:\Program Files\Graphviz2.24\bin</pre>
</div>
<p>The PYTHONPATH variable should also contain:</p>
<div class="highlight-python"><pre>C:\Documents and Settings\Jane\My Documents\Python\cubicweb\</pre>
</div>
<p>From now, on a fresh <cite>cmd</cite> shell, you should be able to type:</p>
<div class="highlight-python"><pre>cubicweb-ctl list</pre>
</div>
<p>... and get a meaningful output.</p>
</div>
<div class="section" id="running-an-instance-as-a-service">
<h4>1.1.6.5. Running an instance as a service<a class="headerlink" href="#running-an-instance-as-a-service" title="Permalink to this headline">¶</a></h4>
<p>This currently assumes that the instances configurations is located at
C:\etc\cubicweb.d.</p>
<p>For a cube &#8216;my_instance&#8217;, you will then find
C:\etc\cubicweb.d\my_instance\win32svc.py that has to be used as follows:</p>
<div class="highlight-python"><pre>win32svc install</pre>
</div>
<p>This should just register your instance as a windows service. A simple:</p>
<div class="highlight-python"><pre>net start cubicweb-my_instance</pre>
</div>
<p>should start the service.</p>
</div>
</div>
<div class="section" id="other-dependencies">
<h3>1.1.7. Other dependencies<a class="headerlink" href="#other-dependencies" title="Permalink to this headline">¶</a></h3>
<p>You can also install:</p>
<ul class="simple">
<li><cite>pyro</cite> if you wish the repository to be accessible through Pyro
or if the client and the server are not running on the same machine
(in which case the packages will have to be installed on both
machines)</li>
<li><cite>python-ldap</cite> if you plan to use a LDAP source on the server</li>
</ul>
</div>
</div>
<div class="section" id="databases-configuration">
<span id="databaseinstallation"></span><h2>1.2. Databases configuration<a class="headerlink" href="#databases-configuration" title="Permalink to this headline">¶</a></h2>
<p>Each instance can be configured with its own database connection information,
that will be stored in the instance&#8217;s <tt class="docutils literal"><span class="pre">sources</span></tt> file. The database to use
will be chosen when creating the instance. Currently cubicweb has been tested
using Postgresql (recommended), MySQL, SQLServer and SQLite.</p>
<p>Other possible sources of data include CubicWeb, Subversion, LDAP and Mercurial,
but at least one relational database is required for CubicWeb to work. You do
not need to install a backend that you do not intend to use for one of your
instances. SQLite is not fit for production use, but it works well for testing
and ships with Python, which saves installation time when you want to get
started quickly.</p>
<div class="section" id="postgresql-configuration">
<span id="postgresqlconfiguration"></span><h3>1.2.1. PostgreSQL configuration<a class="headerlink" href="#postgresql-configuration" title="Permalink to this headline">¶</a></h3>
<p>For installation, please refer to the <a class="reference external" href="http://www.postgresql.org/">PostgreSQL project online documentation</a>.</p>
<p>You need to install the three following packages: <cite>postgresql-8.X</cite>,
<cite>postgresql-client-8.X</cite>, and <cite>postgresql-plpython-8.X</cite>. If you run postgres
version prior to 8.3, you&#8217;ll also need the <cite>postgresql-contrib-8.X</cite> package for
full-text search extension.</p>
<p>If you run postgres on another host than the <em>CubicWeb</em> repository, you should
install the <cite>postgresql-client</cite> package on the <em>CubicWeb</em> host, and others on the
database host.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you already have an existing cluster and PostgreSQL server running, you do
not need to execute the initilization step of your PostgreSQL database unless
you want a specific cluster for <em>CubicWeb</em> databases or if your existing
cluster doesn&#8217;t use the UTF8 encoding (see note below).</p>
</div>
<ul>
<li><p class="first">First, initialize a PostgreSQL cluster with the command <tt class="docutils literal"><span class="pre">initdb</span></tt>.</p>
<div class="highlight-python"><pre>$ initdb -E UTF8 -D /path/to/pgsql</pre>
</div>
<p>Notice the encoding specification. This is necessary since <em>CubicWeb</em> usually
want UTF8 encoded database. If you use a cluster with the wrong encoding, you&#8217;ll
get error like:</p>
<div class="highlight-python"><pre>new encoding (UTF8) is incompatible with the encoding of the template database (SQL_ASCII)
HINT:  Use the same encoding as in the template database, or use template0 as template.</pre>
</div>
<p>Once initialized, start the database server PostgreSQL with the command:</p>
<div class="highlight-python"><pre>$ postgres -D /path/to/psql</pre>
</div>
<p>If you cannot execute this command due to permission issues, please make sure
that your username has write access on the database.</p>
<div class="highlight-python"><pre>$ chown username /path/to/pgsql</pre>
</div>
</li>
<li><p class="first">The database authentication can be either set to <cite>ident sameuser</cite> or <cite>md5</cite>.  If
set to <cite>md5</cite>, make sure to use an existing user of your database.  If set to
<cite>ident sameuser</cite>, make sure that your client&#8217;s operating system user name has a
matching user in the database. If not, please do as follow to create a user:</p>
<div class="highlight-python"><pre>$ su
$ su - postgres
$ createuser -s -P username</pre>
</div>
<p>The option <cite>-P</cite> (for password prompt), will encrypt the password with the
method set in the configuration file <tt class="docutils literal"><span class="pre">pg_hba.conf</span></tt>.  If you do not use this
option <cite>-P</cite>, then the default value will be null and you will need to set it
with:</p>
<div class="highlight-python"><pre>$ su postgres -c "echo ALTER USER username WITH PASSWORD 'userpasswd' | psql"</pre>
</div>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The authentication method can be configured in file:<cite>pg_hba.conf</cite>.</p>
</div>
<p>The above login/password will be requested when you will create an instance with
<cite>cubicweb-ctl create</cite> to initialize the database of your instance.</p>
<p>Notice that the <cite>cubicweb-ctl db-create</cite> does database initialization that
may requires a postgres superuser. That&#8217;s why a login/password is explicitly asked
at this step, so you can use there a superuser without using this user when running
the instance. Things that require special privileges at this step:</p>
<ul class="simple">
<li>database creation, require the &#8216;create database&#8217; permission</li>
<li>install the plpython extension language (require superuser)</li>
<li>install the tsearch extension for postgres version prior to 8.3 (require superuser)</li>
</ul>
<p>To avoid using a super user each time you create an install, a nice trick is to
install plpython (and tsearch when needed) on the special <cite>template1</cite> database,
so they will be installed automatically when cubicweb databases are created
without even with needs for special access rights. To do so, run</p>
<div class="highlight-python"><pre># Installation of plpythonu language by default ::
$ createlang -U pgadmin plpythonu template1
$ psql -U pgadmin template1
template1=# update pg_language set lanpltrusted=TRUE where lanname='plpythonu';</pre>
</div>
<p>Where <cite>pgadmin</cite> is a postgres superuser. The last command is necessary since by
default plpython is an &#8216;untrusted&#8217; language and as such can&#8217;t be used by non
superuser. This update fix that problem by making it trusted.</p>
<p>To install the tsearch plain-text index extension on postgres prior to 8.3, run:</p>
<div class="highlight-python"><pre>cat /usr/share/postgresql/8.X/contrib/tsearch2.sql | psql -U username template1</pre>
</div>
</div>
<div class="section" id="mysql-configuration">
<span id="mysqlconfiguration"></span><h3>1.2.2. MySql configuration<a class="headerlink" href="#mysql-configuration" title="Permalink to this headline">¶</a></h3>
<p>You must add the following lines in <tt class="docutils literal"><span class="pre">/etc/mysql/my.cnf</span></tt> file:</p>
<div class="highlight-python"><pre>transaction-isolation=READ-COMMITTED
default-storage-engine=INNODB
default-character-set=utf8
max_allowed_packet = 128M</pre>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It is unclear whether mysql supports indexed string of arbitrary length or
not.</p>
</div>
</div>
<div class="section" id="sqlserver-configuration">
<span id="sqlserverconfiguration"></span><h3>1.2.3. SQLServer configuration<a class="headerlink" href="#sqlserver-configuration" title="Permalink to this headline">¶</a></h3>
<p>As of this writing, support for SQLServer 2005 is functional but incomplete. You
should be able to connect, create a database and go quite far, but some of the
SQL generated from RQL queries is still currently not accepted by the
backend. Porting to SQLServer 2008 is also an item on the backlog.</p>
<p>The <cite>source</cite> configuration file may look like this (specific parts only are
shown):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="n">system</span><span class="p">]</span>
<span class="n">db</span><span class="o">-</span><span class="n">driver</span><span class="o">=</span><span class="n">sqlserver2005</span>
<span class="n">db</span><span class="o">-</span><span class="n">user</span><span class="o">=</span><span class="n">someuser</span>
<span class="c"># database password not needed</span>
<span class="c">#db-password=toto123</span>
<span class="c">#db-create/init may ask for a pwd: just say anything</span>
<span class="n">db</span><span class="o">-</span><span class="n">extra</span><span class="o">-</span><span class="n">arguments</span><span class="o">=</span><span class="n">Trusted_Connection</span>
<span class="n">db</span><span class="o">-</span><span class="n">encoding</span><span class="o">=</span><span class="n">utf8</span>
</pre></div>
</div>
</div>
<div class="section" id="sqlite-configuration">
<span id="sqliteconfiguration"></span><h3>1.2.4. SQLite configuration<a class="headerlink" href="#sqlite-configuration" title="Permalink to this headline">¶</a></h3>
<p>SQLite has the great advantage of requiring almost no configuration. Simply
use &#8216;sqlite&#8217; as db-driver, and set path to the dabase as db-name. Don&#8217;t specify
anything for db-user and db-password, they will be ignore anyway.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">SQLite is great for testing and to play with cubicweb but is not suited for
production environments.</p>
</div>
</div>
</div>
<div class="section" id="pyro-configuration">
<span id="pyroconfiguration"></span><h2>1.3. Pyro configuration<a class="headerlink" href="#pyro-configuration" title="Permalink to this headline">¶</a></h2>
<p>If you want to use Pyro to access your instance remotely, or to have multi-source
or distributed configuration, it is required to have a Pyro name server running
on your network. By default it is detected by a broadcast request, but you can
specify a location in the instance&#8217;s configuration file.</p>
<p>To do so, you need to :</p>
<ul class="simple">
<li>launch the pyro name server with <cite>pyro-nsd start</cite> before starting cubicweb</li>
<li>under debian, edit the file <tt class="docutils literal"><span class="pre">/etc/default/pyro-nsd</span></tt> so that the name
server pyro will be launched automatically when the machine fire up</li>
</ul>
</div>
<div class="section" id="cubicweb-resources-configuration">
<h2>1.4. Cubicweb resources configuration<a class="headerlink" href="#cubicweb-resources-configuration" title="Permalink to this headline">¶</a></h2>
<div class="section" id="resource-mode">
<span id="resourcemode"></span><h3>1.4.1. Resource mode<a class="headerlink" href="#resource-mode" title="Permalink to this headline">¶</a></h3>
<p>A resource <em>mode</em> is a predifined set of settings for various resources
directories, such as cubes, instances, etc. to ease development with the
framework. There are two running modes with <em>CubicWeb</em>:</p>
<ul>
<li><p class="first"><strong>system</strong>: resources are searched / created in the system directories (eg
usually requiring root access):</p>
<ul class="simple">
<li>instances are stored in <tt class="docutils literal"><span class="pre">&lt;INSTALL_PREFIX&gt;/etc/cubicweb.d</span></tt></li>
<li>temporary files (such as pid file) in <tt class="docutils literal"><span class="pre">/var/run/cubicweb</span></tt></li>
</ul>
<p>where <cite>&lt;INSTALL_PREFIX&gt;</cite> is the detected installation prefix (&#8216;/usr/local&#8217; for
instance).</p>
</li>
<li><p class="first"><strong>user</strong>: resources are searched / created in the user home directory:</p>
<ul class="simple">
<li>instances are stored in <tt class="docutils literal"><span class="pre">~/etc/cubicweb.d</span></tt></li>
<li>temporary files (such as pid file) in <tt class="docutils literal"><span class="pre">/tmp</span></tt></li>
</ul>
</li>
</ul>
<p>Notice that each resource path may be explicitly set using an environment
variable if the default doesn&#8217;t suit your needs. Here are the default resource
directories that are affected according to mode:</p>
<ul>
<li><p class="first"><strong>system</strong>:</p>
<div class="highlight-python"><pre>CW_INSTANCES_DIR = &lt;INSTALL_PREFIX&gt;/etc/cubicweb.d/
CW_INSTANCES_DATA_DIR = /var/lib/cubicweb/instances/
CW_RUNTIME_DIR = /var/run/cubicweb/</pre>
</div>
</li>
<li><p class="first"><strong>user</strong>:</p>
<div class="highlight-python"><pre>CW_INSTANCES_DIR = ~/etc/cubicweb.d/
CW_INSTANCES_DATA_DIR = ~/etc/cubicweb.d/
CW_RUNTIME_DIR = /tmp</pre>
</div>
</li>
</ul>
<p>Cubes search path is also affected, see the <a class="reference external" href="../intro/concepts.html#cube"><em>Cubes</em></a> section.</p>
<p>By default, the mode automatically set to <cite>user</cite> if a <tt class="docutils literal"><span class="pre">.hg</span></tt> directory is found
in the cubicweb package, else it&#8217;s set to <cite>system</cite>. You can force this by setting
the <span class="target" id="index-8"></span><a class="reference internal" href="#envvar-CW_MODE"><strong class="xref">CW_MODE</strong></a> environment variable to either <cite>user</cite> or <cite>system</cite> so you can
easily:</p>
<ul class="simple">
<li>use system wide installation but user specific instances and all, without root
privileges on the system (<cite>export CW_MODE=user</cite>)</li>
<li>use local checkout of cubicweb on system wide instances (requires root
privileges on the system (<cite>export CW_MODE=system</cite>)</li>
</ul>
<p>If you&#8217;ve a doubt about the mode you&#8217;re currently running, check the first line
outputed by the <strong>cubicweb-ctl list</strong> command.</p>
<p>Also, if cubicweb is a mercurial checkout located in <cite>&lt;CW_SOFTWARE_ROOT&gt;</cite>:</p>
<ul class="simple">
<li>main cubes directory is <cite>&lt;CW_SOFTWARE_ROOT&gt;/../cubes</cite>. You can specify
another one with <span class="target" id="index-9"></span><a class="reference internal" href="#envvar-CW_INSTANCES_DIR"><strong class="xref">CW_INSTANCES_DIR</strong></a> environment variable or simply
add some other directories by using <span class="target" id="index-10"></span><a class="reference internal" href="#envvar-CW_CUBES_PATH"><strong class="xref">CW_CUBES_PATH</strong></a></li>
<li>cubicweb migration files are searched in <cite>&lt;CW_SOFTWARE_ROOT&gt;/misc/migration</cite>
instead of <cite>&lt;INSTALL_PREFIX&gt;/share/cubicweb/migration/</cite>.</li>
</ul>
</div>
<div class="section" id="environment-configuration">
<span id="configurationenv"></span><h3>1.4.2. Environment configuration<a class="headerlink" href="#environment-configuration" title="Permalink to this headline">¶</a></h3>
<div class="section" id="python">
<h4>1.4.2.1. Python<a class="headerlink" href="#python" title="Permalink to this headline">¶</a></h4>
<p>If you installed <em>CubicWeb</em> by cloning the Mercurial forest or from source
distribution, then you will need to update the environment variable PYTHONPATH by
adding the path to the forest <cite>cubicweb</cite>:</p>
<p>Add the following lines to either <tt class="docutils literal"><span class="pre">.bashrc</span></tt> or <tt class="docutils literal"><span class="pre">.bash_profile</span></tt> to
configure your development environment</p>
<div class="highlight-python"><pre>export PYTHONPATH=/full/path/to/cubicweb-forest</pre>
</div>
<p>If you installed <em>CubicWeb</em> with packages, no configuration is required and your
new cubes will be placed in <cite>/usr/share/cubicweb/cubes</cite> and your instances will
be placed in <cite>/etc/cubicweb.d</cite>.</p>
</div>
<div class="section" id="cubicweb">
<h4>1.4.2.2. CubicWeb<a class="headerlink" href="#cubicweb" title="Permalink to this headline">¶</a></h4>
<p>Here are all environment variables that may be used to configure <em>CubicWeb</em>:</p>
<dl class="envvar">
<dt id="envvar-CW_MODE">
<tt class="descname">CW_MODE</tt><a class="headerlink" href="#envvar-CW_MODE" title="Permalink to this definition">¶</a></dt>
<dd>Resource mode: user or system, as explained in <a class="reference internal" href="#resourcemode"><em>Resource mode</em></a>.</dd></dl>

<dl class="envvar">
<dt id="envvar-CW_CUBES_PATH">
<tt class="descname">CW_CUBES_PATH</tt><a class="headerlink" href="#envvar-CW_CUBES_PATH" title="Permalink to this definition">¶</a></dt>
<dd>Augments the default search path for cubes. You may specify several
directories using &#8216;:&#8217; as separator (&#8216;;&#8217; under windows environment).</dd></dl>

<dl class="envvar">
<dt id="envvar-CW_INSTANCES_DIR">
<tt class="descname">CW_INSTANCES_DIR</tt><a class="headerlink" href="#envvar-CW_INSTANCES_DIR" title="Permalink to this definition">¶</a></dt>
<dd>Directory where cubicweb instances will be found.</dd></dl>

<dl class="envvar">
<dt id="envvar-CW_INSTANCES_DATA_DIR">
<tt class="descname">CW_INSTANCES_DATA_DIR</tt><a class="headerlink" href="#envvar-CW_INSTANCES_DATA_DIR" title="Permalink to this definition">¶</a></dt>
<dd>Directory where cubicweb instances data will be written (backup file...)</dd></dl>

<dl class="envvar">
<dt id="envvar-CW_RUNTIME_DIR">
<tt class="descname">CW_RUNTIME_DIR</tt><a class="headerlink" href="#envvar-CW_RUNTIME_DIR" title="Permalink to this definition">¶</a></dt>
<dd>Directory where pid files will be written</dd></dl>

</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../modindex.html" title="Global Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="cubicweb-ctl.html" title="2. cubicweb-ctl tool"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Administration"
             >previous</a> |</li>
        <li><a href="../index.html">CubicWeb 3.10.7</a> &raquo;</li>
          <li><a href="index.html" >Administration</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      &copy; Copyright 2001-2010, Logilab.
      Last updated on Jan 17, 2011.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.4.
    </div>
  </body>
</html>