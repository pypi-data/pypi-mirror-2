<table class="listing">
    <tr>
        <th>Product title [Package]<br />
        total:<tal:total replace="python:len(view.productsList)"></tal:total>
        </th>
        <th class="vertical" valign="bottom" tal:repeat="this_site view/sitesList">
            <em tal:repeat="letter python:this_site[0]"
                tal:content="letter">
                letter
            </em>
        </th>
    </tr>
    <tal:products repeat="product view/productsList">
        <tr tal:define="oddrow repeat/product/odd;
                        isProduct python:product['id'].find('.') == -1 and 'Products.' or ''"
            tal:attributes="class python:oddrow is True and 'even' or 'odd'">
            <td>
                <span tal:content="product/title">product name</span>
                <br />
                <span tal:content="string: ${isProduct}${product/id}"
                        class="discreet">product id</span>
                <a style="float:right" tal:attributes="href string: ${here/absolute_url}/@@msp_products_details#${product/id}">
                    <img src="/misc_/CMFPlone/info_icon.gif" alt="">
                </a>
            </td>
            <td tal:repeat="siteTuple view/sitesList">
                <tal:ver define="siteName python:siteTuple[0];
                                siteApp python:siteTuple[1];
                                instVersion python:view.multisite_productInstalledVersion(siteApp,product['id']);
                                latest python:instVersion and instVersion == product['version']">
                        <img tal:condition="latest" src="/misc_/CMFPlone/confirm_icon.gif" alt="latest-version" title="Versione aggiornata">
                        <img tal:condition="python: instVersion and not latest" 
                            tal:attributes="title string:Aggiornamento disponbile. Versione installata: ${instVersion};
                                            src string:${view/portal/absolute_url}/error_icon.gif"
                            alt=""/>
                </tal:ver>
            </td>
        </tr>
    </tal:products>
</table>