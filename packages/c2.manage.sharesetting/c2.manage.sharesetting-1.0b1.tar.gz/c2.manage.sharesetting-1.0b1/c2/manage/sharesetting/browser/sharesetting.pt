<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
     lang="en"
     metal:use-macro="here/prefs_main_template/macros/master"
     i18n:domain="plone">
<body>
<div metal:fill-slot="prefs_configlet_content">
<style type="text/css"><!--	
.shareSetting {font-size: 80%}

.shareSetting {
	margin: 5px 0;
	border: 1px solid #000000;
}

.shareSetting th,
.shareSetting td {
	border: 1px solid #000000;
}

.shareSetting th {
	background-color: #808080;
	color: #ffffff;
}

.shareSetting th,
.shareSetting td {
	padding: 5px;
}
.sharechecking {
	text-align: center;
}

.share-setting-select,
.share-setting-save {
	padding: 1px;
}
/*.shareSettingPathLen1 {padding-left: 0}*/
.shareSettingPathLen2 a{padding-left: 10px}
.shareSettingPathLen3 a{padding-left: 20px}
.shareSettingPathLen4 a{padding-left: 30px}
.shareSettingPathLen5 a{padding-left: 40px}
.shareSettingPathLen6 a{padding-left: 50px}

--></style>
  <h1 class="documentFirstHeading">Share Setting</h1>

  <div class="viewSelect">
	<form action="" method="get">
		<select name="reviewstate">
			<option value="all">ALL</option>
			<option value=""
				tal:repeat="state view/get_all_review_state"
				tal:content="python:state[0]"
				tal:attributes="value python:state[1];
				                selected python:view.request.form.get('reviewstate') == state[1] and 'selected' or None" 
				/>
		</select>
		<select name="filter_role">
			<option value=""
				tal:repeat="role view/get_all_local_role"
				tal:content="role"
				tal:attributes="value role;
				                selected python:view.request.form.get('filter_role', 'Reader') == role and 'selected' or None" 
				/>
		</select>
		<input class="share-setting-select" type="submit" name="submit" value="Select" />
	</form>
  </div>
  <form action="" method="post">
   <table class="shareSetting" border="0" tal:define="groups view/get_groups">
	<tr>
		<th rowspan="2">Item</th>
		<th rowspan="2">State</th>
		<th rowspan="2">Type</th>
		<th colspan="#" tal:attributes="colspan python: len(groups)">Group(s)</th>

	</tr>

	<tr>
		<th tal:repeat="group groups" tal:content="group">Group</th>

	</tr>

	<tr tal:repeat="item view/get_items">
	  <tal:obj define="obj item/item/getObject">
		<td tal:attributes="class python:view.get_path_len(obj)">
			<a tal:content="item/title" 
				tal:attributes="href string:${item/url}/@@sharing;
								class string:state-${item/state}"></a>
			<input type="hidden" name="entries.uid:records" value="uid"
				tal:attributes="value obj/UID" />
			<input type="hidden" name="entries.role:records" value="role"
				tal:attributes="value item/filter_role" />
		</td>
		<td tal:content="item/state" tal:attributes="class string:state-${item/state}"></td>
		<td class="contenttype" tal:content="item/p_type"></td>
		<td class="sharechecking" tal:repeat="chk python:view.get_item_share(obj)">
			<input type="checkbox" name="" 
					tal:condition="python:chk['chk'] != '2'"
					tal:attributes="name string:entries.group_${chk/group}:records;
									checked python:chk['chk'] and 'checked' or None;"/>
			<img tal:condition="python:chk['chk'] == '2'" 
					tal:replace="structure context/confirm_icon.gif" />
		</td>
	  </tal:obj>
	</tr>
   </table>
     <input type="hidden" name="form.localRoleSubmited" value="1" />
     <input class="share-setting-save" type="submit" name="localRoleSubmit" value="Save" />
  </form>
</div>
</body>
</html>
