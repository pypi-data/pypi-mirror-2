<html xmlns="http://www.w3.org/1999/xhtml"
      xml:lang="en"
      lang="en"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="plone">

<body>

<div metal:fill-slot="main">

    <tal:main-macro metal:define-macro="main"
           tal:define="size python:here.getObjSize(here);
                       content_type here/content_type">

        <h1 tal:content="here/title_or_id" class="documentFirstHeading">
            Title or id
        </h1>

        <div metal:use-macro="here/document_actions/macros/document_actions">
            Document actions (print, sendto etc)
        </div>

        <div class="documentDescription"
             tal:content="here/Description">
            description
        </div>

        <small class="discreet">
            <span i18n:translate="label_size">
                Size
            </span>

            <span tal:condition="here/get_size"
                  tal:content="size">
                257 KB
            </span>

            <span tal:condition="not:here/get_size"
                  i18n:translate="no_file_uploaded">
                (No file has been uploaded yet)
            </span>
            -
            <span i18n:translate="label_file_type">
                File type
            </span>

            <span tal:content="here/content_type">
                Content type
            </span>
        </small>

        <form method="post"
              tal:condition="isAnon"
              tal:define="errors options/state/getErrors"
              tal:attributes="action string:${here/absolute_url}/${template/id}">

            <fieldset>

                <legend>Download Form</legend>

                <div class="field"
                     tal:define="error errors/emailaddress | nothing;
                                 emailaddress request/emailaddress | nothing;"
                     tal:attributes="class python:test(error, 'field error', 'field')">

                    <label>E-mail address</label>

                    <span class="fieldRequired"
                          title="Required"
                          i18n:attributes="title"
                          i18n:translate="label_required">(Required)</span>

                    <div class="formHelp">
                        To download this file, you need to provide your email
                        address in the field below. An email with instructions
                        for downloading will be sent to the address provided.
                    </div>

                    <div tal:content="error">Validation error output</div>

                    <input name="emailaddress"
                           type="text"
                           value=""
                           tabindex=""
                           tal:attributes="value request/emailaddress | nothing;
                                           tabindex tabindex/next"
                           />
                </div>

                <div class="formControls">

                    <input type="hidden"
                           name="form.submitted"
                           value="1"
                           />

                    <input type="submit"
                           class="context"
                           name="form.button.submit"
                           value="Get the file"
                           />
                </div>

            </fieldset>

        </form>


        <tal:authenticated condition="not:isAnon">

            <p>
                <a href=""
                   tal:attributes="href string:$here_url/download">
                    <img src="" tal:attributes="src string:${portal_url}/file_icon.gif" alt="" />
                    <tal:block i18n:translate="label_click_to_get_file">
                        Click here to get the file
                    </tal:block>
                </a>
            </p>

            <div class="row"
                 tal:condition="python:content_type.find('text') > -1">

                <h2 i18n:translate="heading_file_contents">File contents</h2>

                <pre tal:content="here/get_data|here/data|nothing">
                    File content
                </pre>

            </div>

        </tal:authenticated>

        <div metal:use-macro="here/document_byline/macros/byline">
            Get the byline - contains details about author and modification date.
        </div>

    </tal:main-macro>

</div>

</body>

</html>
