<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="plone"
      tal:define="x python:request.set('documentEditable', True)">

<div metal:fill-slot="javascript_head_slot" tal:omit-tag="">
</div>

<body>
<div metal:fill-slot="main">

          <metal:block tal:repeat="object python:context.get_megamanic_editable_objects(context)">
    	    <metal:block tal:define="path python:'/'.join(object.getPhysicalPath());">
	    <a tal:attributes="href path"><h2 tal:content="object/Title"></h2></a>
<br />
	      <metal:block tal:repeat="fieldName object/getMegamanicEditableFields">
	      <metal:block tal:define="field python:object.getField(fieldName); accessor python:field.getAccessor(object);
				       widget python:field.widget">
		  <tal:if_visible define="mode string:view;
					  visState python:field.widget.isVisible(here, mode);
					  visCondition python:field.widget.testCondition(context.aq_inner.aq_parent, portal, context);"
				  condition="python:visState == 'visible' and visCondition">
<label class="formQuestion"><span i18n:translate="" tal:content="python:widget.Label(here)">Field</span>:</label>
<br />
<span metal:use-macro="python:object.widget(fieldName)" />
<br />
		  </tal:if_visible>
	      </metal:block>
	      </metal:block>
	    </metal:block>
	    <metal:block tal:condition="python:(not repeat['object'].start) and object.contentValues()">
	      <metal:block tal:define="folderContents python:object.getFolderContents;
				       y python:request.set('limit_display', 100)">
		<metal:macro metal:use-macro="context/folder_listing/macros/listing" />
	    </metal:block>
	    </metal:block>
          </metal:block>

</div>
</body>
</html>
