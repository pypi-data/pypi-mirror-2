<tal:block 
    tal:define="value string:;isBinary python: False;
                portal_url python:here.portal_url.getPortalObject().absolute_url();
                noParagraphs python:int(here.REQUEST.get('noParagraphs'))+1;
                here python:context.portal_factory._getTempFolder('MultiParagraphPage')['tempobj'];
                field python:here.Schema()['text'];
                widget nocall:field/widget;
                inputvalue string:;
                inputname here/REQUEST/inputname;
                fieldName inputname;
                hashedId string:newparagraph_$inputname;
                editorid string:kupu-editor-${inputname};
                ">
              <h3><tal:block i18n:translate="multiparagraphpage_paragraph_no" i18n:domain="valentine.multiparagraphpage">Paragraph no</tal:block> <tal:block tal:content="noParagraphs"/></h3>
              <input type="hidden" 
                     tal:attributes="name  python:'__order__%s'%(fieldName);
                                     value noParagraphs"/>
              <tal:area_format>
                  <metal:block use-macro="here/widgets/visual/macros/area_format" />
              </tal:area_format>
              <metal:use use-macro="here/widgets/epoz/macros/edit_area">
                <metal:fill fill-slot="text_format"/>
              </metal:use>
              <hr/>
  <div tal:attributes="id hashedId" tal:define="inputname field/getHashedName">
    <input type="button" tal:attributes="onclick string:jq('#${hashedId}').load('${portal_url}/@@newparagraph', {'noParagraphs':'$noParagraphs', 'inputname':'$inputname'}, function() { setTimeout(function() { initPloneKupu('kupu-editor-${inputname}')}, 300) })" value="Add paragraph"/>
  </div>  
</tal:block>
