<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html dir="ltr" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en"><head>
		<title>pyspread FAQ</title>
</head>

<body>

<h1 id="firstHeading" class="firstHeading">FAQ</h1>
<p><i>&copy; Martin Manns 2009</i>
</p>
<p><b>Q:</b> What kind of expressions can a cell contain?<br>
<b>A:</b> A cell can contain any normal Python expression such as a list comprehension or a generator expression. 
However, it cannot contain statements such as
</p>
<pre>for i in xrange(10): pass</pre>
<p><br>
If you want to program more complex algorithms, use the Macro Editor.<br>
There, you <i>can define one (!) function</i> at a time that uses arbitrary Python code and is callable from any cell.
</p><p><b>Example:</b><br>
Type in the macro editor:
</p>
<pre>def factorize(number):
    """Silly factorizing algorithm for demonstration purposes only"""
    counter = 1
    result = []
    while counter &lt;= number:
        if number&nbsp;% counter == 0:
            result.append(counter)
        counter += 1
    return result</pre>
<p>And in the cell:
</p>
<pre> factorize(25)</pre>
<p>Result is:
</p>
<pre> [1 5 25]</pre>
<p><b>Q:</b> Is using the variable <b>S</b> the only way for reading values of a cell(s)?<br>
<b>A:</b> The variable <b>S</b> is the very grid object. It can be used
in various ways, such as using its attributes and methods. One example
is the spread method.
</p><p>The object S has the attributes <i><b>sgrid</b></i> (string grid), <i><b>macros</b></i> (Macro dict) and <i><b>resultcache</b></i> and <i><b>unredo</b></i>
(do not use the last two). There are several methods to access and
manipulate the data. Since the attribute sgrid is a numpy object grid,
all numpy methods can be used directly. When accessing (and slicing) S,
you actually call a method that evaluates S.fgrid. When you set an item
in S, the sgrid item is set but it is not automatically updated. Have
fun poking around in the S object.
</p><p><b>Q:</b> Is <b>S.spread</b> the only way to write to a cell using its absolute/relative address?<br>
<b>A:</b> No. However, it is the preferred way.<br>
Try this out:
</p>
<pre>S[1,0,0] = '2'</pre>
<p>Only after selecting the cell (1,0,0), the string 2 will appear and it will be updated.<br>
Note the error message.
</p><p><b>Q:</b> How can I write to cells from within a macro?<br>
<b>A:</b> S.spread is your friend<br>
Macro:
</p>
<pre>def test(a):
    S.spread(a, (1, 0, 0))</pre>
<p>Grid:
</p>
<pre>test(3)</pre>
<p><b>Q:</b> What are the boundaries for the number of rows/columns/sheets?<br>
<b>A:</b> On a 64 bit system, these are limited by your memory (and
maybe your stack restriction if any). However, for 32bit systems, the
number of cells is limited to 2^28 because the memory consumption for
2^28 cells is at about 1.7 GB. Pyspread warns you about memory
consumption if the grid gets larger. If you own a 64bit system and
proceed, you should be able to create really large grids (especially
with much RAM).<br>
For really large and mostly empty grids, pyspread would have to use
sparse grids. Since there are performance issues, sparse grids are
currently not scheduled for implementation.
</p><p><b>Q:</b> I'd like to exact data from a saved .pys file it
without using the GUI, e.g. I'd like to open one in a script and read
things from it.<br>
<b>A:</b> The .pys format is a bzip2-ed pickle dump of the numpy object array that contains the strings that are entered in the cells.<br>
Example:
</p>
<pre>&gt;&gt;&gt; import bz2
&gt;&gt;&gt; infile=bz2.BZ2File('test.pys','r')
&gt;&gt;&gt; import cPickle as pickle
&gt;&gt;&gt; import numpy
&gt;&gt;&gt; data = pickle.load(infile)
&gt;&gt;&gt; data
array([[[rpy = __import__("rpy"), 1, ],
[, 3, ],
[, -4, ],
...,
[, , ],
[, , ],
[, , ]],

[[__import__("math"), 2, ],
[, 4, ],
[, 5, ],
...,
[, , ],
[, , ],
[, , ]],

[[a = numpy.arange(-1,1,.001), 3, ],
[, 35, ],
[, 2, ],
...,
[, , ],
[, , ],
[, , ]],

...,
[[, , ],
[, , ],
[, , ],
...,
[, , ],
[, , ],
[, , ]],

[[, , ],
[, , ],
[, , ],
...,
[, , ],
[, , ],
[, , ]],

[[, , ],
[, , ],
[, , ],
...,
[, , ],
[, , ],
[, , ]]], dtype=object)
&gt;&gt;&gt; infile.close()</pre>
</body></html>
