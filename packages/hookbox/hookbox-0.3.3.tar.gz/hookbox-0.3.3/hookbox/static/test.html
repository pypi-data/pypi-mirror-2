<!doctype html>

<head>
<style>
html { overflow-y: scroll; }
body, html { margin: 0px; padding: 0px; }
body, input { font: 11px Helvetica, Arial, sans-serif; }
body { background: #0C7BA5;}
input { margin-right: 5px; }

#url { width: 200px; font-weight: bold; }

.tabs { height: 26px; margin-top: 10px; font-weight: bold; font-size: 12px; }
.views { border: 2px solid #222; background: #FFF; max-width: 700px; }
.tab { border: 2px solid #222; float: left; padding: 7px 10px 5px 10px; cursor: pointer; margin-right:-2px; height: 12px; }
.tab { -moz-border-radius: 10px 10px 0px 0px; -webkit-border-top-left-radius: 10px; -webkit-border-top-right-radius: 10px; }

.round { -moz-border-radius: 3px; -webkit-border-radius: 3px; }
.roundTops { -moz-border-radius: 5px 5px 0px 0px; -webkit-border-top-left-radius: 5px; -webkit-border-top-right-radius: 5px; }
.roundBottoms { -moz-border-radius: 0px 0px 5px 5px; -webkit-border-bottom-left-radius: 5px; -webkit-border-bottom-right-radius: 5px; }
.roundTopRight { -moz-border-radius-topright: 5px; -webkit-border-top-right-radius: 5px; }
.logView { padding: 10px 0px 10px 10px; overflow: auto; max-height: 400px; }

.connectionLogger { height: 80px; width: 350px; float: right; background: #FFF; border: 2px solid #444; margin: 10px; overflow: auto; }
.connectionTabs .tab {
	background: -moz-linear-gradient(90deg, #FFF, #DDD);
	background: -webkit-gradient(linear, 0% 100%, 0% 0%, from(#FFF), to(#EEE));
	color: #777;
}

.tabSelected, .tabSelected:hover {
	border-bottom-style: none;
	cursor: default;
	padding-bottom: 7px;
}

.connectionTabs .tabSelected:hover,
.connectionTabs .tabSelected {
	background: -moz-linear-gradient(90deg, #787876, #998);
	background: -webkit-gradient(linear, 0% 100%, 0% 0%, from(#787876), to(#998));
	color: #FFF;
}

.channelControls { padding: 10px 0px 0px 10px; padding-top: 70px; clear: left; }
.channelTabs { margin: 10px 10px 0px 10px; clear: both; }
.channelTabs .tab {
	background: -moz-linear-gradient(90deg, #99A, #CCE);
	background: -webkit-gradient(linear, 0% 100%, 0% 0%, from(#99A), to(#CCE));
	color: #444;
}

.channelTabs .tabSelected,
.channelTabs .tabSelected:hover {
	background: #88a;
	background: -moz-linear-gradient(90deg, #522B66, #623B76);
	background: -webkit-gradient(linear, 0% 100%, 0% 0%, from(#522B66), to(#623B76));
	color: #FFF;
}

.tab:hover { color: #555;}
.channelTabs .tabs:hover { color: #EEE };


.channelLogger { height: auto; max-height: 400px; }

.channelHeader { padding: 5px 10px; color: #FFF; }
.channelHeader h3 { font-weight: bold; font-size: 11px; display: inline; margin: 0px; }
.channelInfo {
	background: -moz-linear-gradient(90deg, #320B36, #522B66);
	background: -webkit-gradient(linear, 0% 100%, 0% 0%, from(#320B36), to(#522B66));
}
.channelState {
	background: -moz-linear-gradient(90deg, #4A7C39, #8A9C69);
	background: -webkit-gradient(linear, 0% 100%, 0% 0%, from(#4A7C39), to(#8A9C69));
}
.channelState pre { margin: 0px; }
.channelPresence {
	color: #000;
	background: -moz-linear-gradient(90deg, #FFFFAA, #FFFFCC);
	background: -webkit-gradient(linear, 0% 100%, 0% 0%, from(#FFFFAA), to(#FFFFCC));
}
.channelPublisher { padding-top: 15px;}
.channelPublish { width: 400px;}

#wrapper {
	margin: 20px auto; max-width: 700px; padding: 0px; -moz-border-radius: 5px; -webkit-border-radius: 5px; background: #ACACAA; border: 2px solid #222;
	background: -moz-linear-gradient(90deg, #9C9C9A, #ACACAA);
	background: -webkit-gradient(linear, 0% 100%, 0% 0%, from(#9C9C9A), to(#ACACAA));
}
#content { padding: 10px; }
.connectionView {
	background: #787876; color: #FFF; padding-bottom: 10px;
	background: -moz-linear-gradient(90deg, #686866, #787876);
	background: -webkit-gradient(linear, 0% 100%, 0% 0%, from(#686866), to(#787876));
}
.channelView { background: #392827; color: #FFF; }

h1 {
	margin: 0px 0px 5px 0px; font-size: 20px; 
	padding: 8px 10px 4px;
	color: #FFF;
	background: -moz-linear-gradient(90deg, #320B36, #522B66);
	background: -webkit-gradient(linear, 0% 100%, 0% 0%, from(#320B36), to(#522B66));
	-webkit-border-top-left-radius: 3px; -webkit-border-top-right-radius: 3px;
}

h2 { margin: 0px 0px 5px; }

.logMsg { }
.logInfo { color: #888; }
.logWarn { color: blue; }
.logError { color: red; font-weight: bold; }

</style>
</head>

<body>
<script src="hookbox.js"></script>


<div id="wrapper">
	<h1>Hookbox Test</h1>
	<div id="content">
		<div><b>url: </b><input type="text" id="url"><button id="connect">connect</button></div>
	</div>
</div>

<script>
hookbox.logging.get('hookbox').setLevel(0)
jsio.setCachedSrc("util.browser", "jsio/util/browser.js","jsio(\"external .sizzle import Sizzle\");var singleId=/^#([\\w-]+)$/,$=exports.$=function(a,b){if(singleId.test(a))return $.id(a.substring(1),b);return Sizzle.apply(GLOBAL,arguments)};$.id=function(a,b){return typeof a==\"string\"?(b||window).document.getElementById(a):a};\n$.create=function(a){var b=(a.win||window).document;a||(a=\"div\");if(typeof a==\"string\")return b.createElement(a);b=b.createElement(a.tag||\"div\");a.style&&$.style(b,a.style);if(a.attrs)for(attr in a.attrs)b.setAttribute(attr,a.attrs[attr]);if(a[\"class\"]||a.className)b.className=a[\"class\"]||a.className;a.parent&&a.parent.appendChild(b);if(a.html)b.innerHTML=a.html;a.text&&$.setText(b,a.text);return b};$.show=function(a,b){$.id(a).style.display=b||\"block\"};$.hide=function(a){$.id(a).style.display=\"none\"};\n$.addClass=function(a,b){a=$.id(a);if(typeof b==\"string\")b=b.split(\" \");for(var c=\" \"+a.className+\" \",d=0,f=b.length,e;(e=b[d])||d<f;++d)if(c.indexOf(\" \"+e+\" \")==-1)c+=e+\" \";a.className=c;return $};$.removeClass=function(a,b){a=$.id(a);a.className=(\" \"+a.className+\" \").replace(\" \",\"  \").replace(RegExp(\"( \"+b.replace(\"s+\",\" | \").replace(\"-\",\"-\")+\" )\",\"g\"),\"\").replace(/\\s+/,\" \").replace(/^\\s+|\\s+%/,\"\")};\nfunction ieGetAlpha(a){try{return a.filters.item(\"alpha\")}catch(b){}try{return a.filters.item(\"progid:DXImageTransform.Microsoft.Alpha\")}catch(c){}return null}\n$.style=function(a,b){if(a instanceof Array)for(var c=0,d;d=a[c];++c)$.style(d,b);else{a=$.id(a);for(prop in b)switch(prop){case \"float\":a.style.styleFloat=a.style.cssFloat=b[prop];break;case \"opacity\":a.style.opacity=b[prop];if(a.filters)try{c=ieGetAlpha();d=b[prop]==1?99.99:b[prop]*100;if(c)c.Opacity=d;else a.style.filter=\"alpha(opacity=\"+d+\")\"}catch(f){}break;default:a.style[prop]=b[prop];break}}};\n$.onEvent=function(a,b,c){if(typeof c!=\"function\")c=bind.apply(GLOBAL,Array.prototype.slice.call(arguments,2));a=$.id(a);a.addEventListener?a.addEventListener(b,c,false):a.attachEvent(\"on\"+b,function(d){c(d||window.event)})};$.stopEvent=function(a){a.cancelBubble=true;a.stopPropagation&&a.stopPropagation();a.preventDefault&&a.preventDefault()};\n$.setText=function(a,b){a=$.id(a);b=String(b);if(\"textContent\"in a)a.textContent=b;else if(\"innerText\"in a)a.innerText=b.replace(/\\n/g,\" \");else{a.innerHTML=\"\";a.appendChild(document.createTextNode(b))}};$.remove=function(a){(a=$.id(a))&&a.parentNode&&a.parentNode.removeChild(a)};\n$.cursorPos=function(a,b){var c=$.pos(b);c.top=a.clientY-c.top+(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop);c.left=a.clientX-c.left+(window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft);return c};$.pos=function(a){a=a;for(var b={top:0,left:0};a&&a!=document.body;){b.left+=a.offsetLeft;for(b.top+=a.offsetTop;a.offsetParent!=a.parentNode;){b.top-=a.scrollTop;b.left-=a.scrollLeft;a=a.parentNode}a=a.offsetParent}return b};");
jsio.setCachedSrc("util.sizzle", "jsio/util/sizzle.js","Sizzle=function(){function x(a,b,c,d,f,e){f=a==\"previousSibling\"&&!e;for(var h=0,j=d.length;h<j;h++){var g=d[h];if(g){if(f&&g.nodeType===1){g.sizcache=c;g.sizset=h}g=g[a];for(var l=false;g;){if(g.sizcache===c){l=d[g.sizset];break}if(g.nodeType===1&&!e){g.sizcache=c;g.sizset=h}if(g.nodeName===b){l=g;break}g=g[a]}d[h]=l}}}function y(a,b,c,d,f,e){f=a==\"previousSibling\"&&!e;for(var h=0,j=d.length;h<j;h++){var g=d[h];if(g){if(f&&g.nodeType===1){g.sizcache=c;g.sizset=h}g=g[a];for(var l=false;g;){if(g.sizcache===\nc){l=d[g.sizset];break}if(g.nodeType===1){if(!e){g.sizcache=c;g.sizset=h}if(typeof b!==\"string\"){if(g===b){l=true;break}}else if(k.filter(b,[g]).length>0){l=g;break}}g=g[a]}d[h]=l}}}var v=/((?:\\((?:\\([^()]+\\)|[^()]+)+\\)|\\[(?:\\[[^[\\]]*\\]|['\"][^'\"]*['\"]|[^[\\]'\"]+)+\\]|\\\\.|[^ >+~,(\\[\\\\]+)+|[>+~])(\\s*,\\s*)?/g,w=0,z=Object.prototype.toString,p=false,k=function(a,b,c,d){c=c||[];var f=b=b||document;if(b.nodeType!==1&&b.nodeType!==9)return[];if(!a||typeof a!==\"string\")return c;var e=[],h,j,g,l,n=true,o=s(b);\nfor(v.lastIndex=0;(h=v.exec(a))!==null;){e.push(h[1]);if(h[2]){l=RegExp.rightContext;break}}if(e.length>1&&D.exec(a))if(e.length===2&&i.relative[e[0]])j=A(e[0]+e[1],b);else for(j=i.relative[e[0]]?[b]:k(e.shift(),b);e.length;){a=e.shift();if(i.relative[a])a+=e.shift();j=A(a,j)}else{if(!d&&e.length>1&&b.nodeType===9&&!o&&i.match.ID.test(e[0])&&!i.match.ID.test(e[e.length-1])){h=k.find(e.shift(),b,o);b=h.expr?k.filter(h.expr,h.set)[0]:h.set[0]}if(b){h=d?{expr:e.pop(),set:q(d)}:k.find(e.pop(),e.length===\n1&&(e[0]===\"~\"||e[0]===\"+\")&&b.parentNode?b.parentNode:b,o);j=h.expr?k.filter(h.expr,h.set):h.set;if(e.length>0)g=q(j);else n=false;for(;e.length;){var m=e.pop();h=m;if(i.relative[m])h=e.pop();else m=\"\";if(h==null)h=b;i.relative[m](g,h,o)}}else g=[]}g||(g=j);if(!g)throw\"Syntax error, unrecognized expression: \"+(m||a);if(z.call(g)===\"[object Array]\")if(n)if(b&&b.nodeType===1)for(a=0;g[a]!=null;a++){if(g[a]&&(g[a]===true||g[a].nodeType===1&&E(b,g[a])))c.push(j[a])}else for(a=0;g[a]!=null;a++)g[a]&&\ng[a].nodeType===1&&c.push(j[a]);else c.push.apply(c,g);else q(g,c);if(l){k(l,f,c,d);k.uniqueSort(c)}return c};k.uniqueSort=function(a){if(r){p=false;a.sort(r);if(p)for(var b=1;b<a.length;b++)a[b]===a[b-1]&&a.splice(b--,1)}};k.matches=function(a,b){return k(a,null,null,b)};k.find=function(a,b,c){var d,f;if(!a)return[];for(var e=0,h=i.order.length;e<h;e++){var j=i.order[e];if(f=i.match[j].exec(a)){var g=RegExp.leftContext;if(g.substr(g.length-1)!==\"\\\\\"){f[1]=(f[1]||\"\").replace(/\\\\/g,\"\");d=i.find[j](f,\nb,c);if(d!=null){a=a.replace(i.match[j],\"\");break}}}}d||(d=b.getElementsByTagName(\"*\"));return{set:d,expr:a}};k.filter=function(a,b,c,d){for(var f=a,e=[],h=b,j,g,l=b&&b[0]&&s(b[0]);a&&b.length;){for(var n in i.filter)if((j=i.match[n].exec(a))!=null){var o=i.filter[n],m,t;g=false;if(h==e)e=[];if(i.preFilter[n])if(j=i.preFilter[n](j,h,c,e,d,l)){if(j===true)continue}else g=m=true;if(j)for(var u=0;(t=h[u])!=null;u++)if(t){m=o(t,j,u,h);var B=d^!!m;if(c&&m!=null)if(B)g=true;else h[u]=false;else if(B){e.push(t);\ng=true}}if(m!==undefined){c||(h=e);a=a.replace(i.match[n],\"\");if(!g)return[];break}}if(a==f)if(g==null)throw\"Syntax error, unrecognized expression: \"+a;else break;f=a}return h};var i=k.selectors={order:[\"ID\",\"NAME\",\"TAG\"],match:{ID:/#((?:[\\w\\u00c0-\\uFFFF_-]|\\\\.)+)/,CLASS:/\\.((?:[\\w\\u00c0-\\uFFFF_-]|\\\\.)+)/,NAME:/\\[name=['\"]*((?:[\\w\\u00c0-\\uFFFF_-]|\\\\.)+)['\"]*\\]/,ATTR:/\\[\\s*((?:[\\w\\u00c0-\\uFFFF_-]|\\\\.)+)\\s*(?:(\\S?=)\\s*(['\"]*)(.*?)\\3|)\\s*\\]/,TAG:/^((?:[\\w\\u00c0-\\uFFFF\\*_-]|\\\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\\((even|odd|[\\dn+-]*)\\))?/,\nPOS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\\((\\d*)\\))?(?=[^-]|$)/,PSEUDO:/:((?:[\\w\\u00c0-\\uFFFF_-]|\\\\.)+)(?:\\((['\"]*)((?:\\([^\\)]+\\)|[^\\2\\(\\)]*)+)\\2\\))?/},attrMap:{\"class\":\"className\",\"for\":\"htmlFor\"},attrHandle:{href:function(a){return a.getAttribute(\"href\")}},relative:{\"+\":function(a,b,c){var d=typeof b===\"string\",f=d&&!/\\W/.test(b);d=d&&!f;if(f&&!c)b=b.toUpperCase();c=0;f=a.length;for(var e;c<f;c++)if(e=a[c]){for(;(e=e.previousSibling)&&e.nodeType!==1;);a[c]=d||e&&e.nodeName===b?e||false:e===b}d&&\nk.filter(b,a,true)},\">\":function(a,b,c){var d=typeof b===\"string\";if(d&&!/\\W/.test(b)){b=c?b:b.toUpperCase();c=0;for(var f=a.length;c<f;c++){var e=a[c];if(e){d=e.parentNode;a[c]=d.nodeName===b?d:false}}}else{c=0;for(f=a.length;c<f;c++)if(e=a[c])a[c]=d?e.parentNode:e.parentNode===b;d&&k.filter(b,a,true)}},\"\":function(a,b,c){var d=w++,f=y;if(!/\\W/.test(b)){var e=b=c?b:b.toUpperCase();f=x}f(\"parentNode\",b,d,a,e,c)},\"~\":function(a,b,c){var d=w++,f=y;if(typeof b===\"string\"&&!/\\W/.test(b)){var e=b=c?b:\nb.toUpperCase();f=x}f(\"previousSibling\",b,d,a,e,c)}},find:{ID:function(a,b,c){if(typeof b.getElementById!==\"undefined\"&&!c)return(a=b.getElementById(a[1]))?[a]:[]},NAME:function(a,b){if(typeof b.getElementsByName!==\"undefined\"){for(var c=[],d=b.getElementsByName(a[1]),f=0,e=d.length;f<e;f++)d[f].getAttribute(\"name\")===a[1]&&c.push(d[f]);return c.length===0?null:c}},TAG:function(a,b){return b.getElementsByTagName(a[1])}},preFilter:{CLASS:function(a,b,c,d,f,e){a=\" \"+a[1].replace(/\\\\/g,\"\")+\" \";if(e)return a;\ne=0;for(var h;(h=b[e])!=null;e++)if(h)if(f^(h.className&&(\" \"+h.className+\" \").indexOf(a)>=0))c||d.push(h);else if(c)b[e]=false;return false},ID:function(a){return a[1].replace(/\\\\/g,\"\")},TAG:function(a,b){for(var c=0;b[c]===false;c++);return b[c]&&s(b[c])?a[1]:a[1].toUpperCase()},CHILD:function(a){if(a[1]==\"nth\"){var b=/(-?)(\\d*)n((?:\\+|-)?\\d*)/.exec(a[2]==\"even\"&&\"2n\"||a[2]==\"odd\"&&\"2n+1\"||!/\\D/.test(a[2])&&\"0n+\"+a[2]||a[2]);a[2]=b[1]+(b[2]||1)-0;a[3]=b[3]-0}a[0]=w++;return a},ATTR:function(a,b,\nc,d,f,e){b=a[1].replace(/\\\\/g,\"\");if(!e&&i.attrMap[b])a[1]=i.attrMap[b];if(a[2]===\"~=\")a[4]=\" \"+a[4]+\" \";return a},PSEUDO:function(a,b,c,d,f){if(a[1]===\"not\")if(v.exec(a[3]).length>1||/^\\w/.test(a[3]))a[3]=k(a[3],null,null,b);else{a=k.filter(a[3],b,c,true^f);c||d.push.apply(d,a);return false}else if(i.match.POS.test(a[0])||i.match.CHILD.test(a[0]))return true;return a},POS:function(a){a.unshift(true);return a}},filters:{enabled:function(a){return a.disabled===false&&a.type!==\"hidden\"},disabled:function(a){return a.disabled===\ntrue},checked:function(a){return a.checked===true},selected:function(a){return a.selected===true},parent:function(a){return!!a.firstChild},empty:function(a){return!a.firstChild},has:function(a,b,c){return!!k(c[3],a).length},header:function(a){return/h\\d/i.test(a.nodeName)},text:function(a){return\"text\"===a.type},radio:function(a){return\"radio\"===a.type},checkbox:function(a){return\"checkbox\"===a.type},file:function(a){return\"file\"===a.type},password:function(a){return\"password\"===a.type},submit:function(a){return\"submit\"===\na.type},image:function(a){return\"image\"===a.type},reset:function(a){return\"reset\"===a.type},button:function(a){return\"button\"===a.type||a.nodeName.toUpperCase()===\"BUTTON\"},input:function(a){return/input|select|textarea|button/i.test(a.nodeName)}},setFilters:{first:function(a,b){return b===0},last:function(a,b,c,d){return b===d.length-1},even:function(a,b){return b%2===0},odd:function(a,b){return b%2===1},lt:function(a,b,c){return b<c[3]-0},gt:function(a,b,c){return b>c[3]-0},nth:function(a,b,c){return c[3]-\n0==b},eq:function(a,b,c){return c[3]-0==b}},filter:{PSEUDO:function(a,b,c,d){var f=b[1],e=i.filters[f];if(e)return e(a,c,b,d);else if(f===\"contains\")return(a.textContent||a.innerText||\"\").indexOf(b[3])>=0;else if(f===\"not\"){b=b[3];c=0;for(d=b.length;c<d;c++)if(b[c]===a)return false;return true}},CHILD:function(a,b){var c=b[1],d=a;switch(c){case \"only\":case \"first\":for(;d=d.previousSibling;)if(d.nodeType===1)return false;if(c==\"first\")return true;d=a;case \"last\":for(;d=d.nextSibling;)if(d.nodeType===\n1)return false;return true;case \"nth\":c=b[2];var f=b[3];if(c==1&&f==0)return true;var e=b[0],h=a.parentNode;if(h&&(h.sizcache!==e||!a.nodeIndex)){var j=0;for(d=h.firstChild;d;d=d.nextSibling)if(d.nodeType===1)d.nodeIndex=++j;h.sizcache=e}d=a.nodeIndex-f;return c==0?d==0:d%c==0&&d/c>=0}},ID:function(a,b){return a.nodeType===1&&a.getAttribute(\"id\")===b},TAG:function(a,b){return b===\"*\"&&a.nodeType===1||a.nodeName===b},CLASS:function(a,b){return(\" \"+(a.className||a.getAttribute(\"class\"))+\" \").indexOf(b)>\n-1},ATTR:function(a,b){var c=b[1];c=i.attrHandle[c]?i.attrHandle[c](a):a[c]!=null?a[c]:a.getAttribute(c);var d=c+\"\",f=b[2],e=b[4];return c==null?f===\"!=\":f===\"=\"?d===e:f===\"*=\"?d.indexOf(e)>=0:f===\"~=\"?(\" \"+d+\" \").indexOf(e)>=0:!e?d&&c!==false:f===\"!=\"?d!=e:f===\"^=\"?d.indexOf(e)===0:f===\"$=\"?d.substr(d.length-e.length)===e:f===\"|=\"?d===e||d.substr(0,e.length+1)===e+\"-\":false},POS:function(a,b,c,d){var f=i.setFilters[b[2]];if(f)return f(a,c,b,d)}}},D=i.match.POS;for(var C in i.match)i.match[C]=RegExp(i.match[C].source+\n/(?![^\\[]*\\])(?![^\\(]*\\))/.source);var q=function(a,b){a=Array.prototype.slice.call(a,0);if(b){b.push.apply(b,a);return b}return a};try{Array.prototype.slice.call(document.documentElement.childNodes,0)}catch(F){q=function(a,b){var c=b||[];if(z.call(a)===\"[object Array]\")Array.prototype.push.apply(c,a);else if(typeof a.length===\"number\")for(var d=0,f=a.length;d<f;d++)c.push(a[d]);else for(d=0;a[d];d++)c.push(a[d]);return c}}var r;if(document.documentElement.compareDocumentPosition)r=function(a,b){var c=\na.compareDocumentPosition(b)&4?-1:a===b?0:1;if(c===0)p=true;return c};else if(\"sourceIndex\"in document.documentElement)r=function(a,b){var c=a.sourceIndex-b.sourceIndex;if(c===0)p=true;return c};else if(document.createRange)r=function(a,b){var c=a.ownerDocument.createRange(),d=b.ownerDocument.createRange();c.selectNode(a);c.collapse(true);d.selectNode(b);d.collapse(true);c=c.compareBoundaryPoints(Range.START_TO_END,d);if(c===0)p=true;return c};(function(){var a=document.createElement(\"div\"),b=\"script\"+\n(new Date).getTime();a.innerHTML=\"<a name='\"+b+\"'/>\";var c=document.documentElement;c.insertBefore(a,c.firstChild);if(document.getElementById(b)){i.find.ID=function(d,f,e){if(typeof f.getElementById!==\"undefined\"&&!e)return(f=f.getElementById(d[1]))?f.id===d[1]||typeof f.getAttributeNode!==\"undefined\"&&f.getAttributeNode(\"id\").nodeValue===d[1]?[f]:undefined:[]};i.filter.ID=function(d,f){var e=typeof d.getAttributeNode!==\"undefined\"&&d.getAttributeNode(\"id\");return d.nodeType===1&&e&&e.nodeValue===\nf}}c.removeChild(a);c=a=null})();(function(){var a=document.createElement(\"div\");a.appendChild(document.createComment(\"\"));if(a.getElementsByTagName(\"*\").length>0)i.find.TAG=function(b,c){var d=c.getElementsByTagName(b[1]);if(b[1]===\"*\"){for(var f=[],e=0;d[e];e++)d[e].nodeType===1&&f.push(d[e]);d=f}return d};a.innerHTML=\"<a href='#'></a>\";if(a.firstChild&&typeof a.firstChild.getAttribute!==\"undefined\"&&a.firstChild.getAttribute(\"href\")!==\"#\")i.attrHandle.href=function(b){return b.getAttribute(\"href\",\n2)};a=null})();document.querySelectorAll&&function(){var a=k,b=document.createElement(\"div\");b.innerHTML=\"<p class='TEST'></p>\";if(!(b.querySelectorAll&&b.querySelectorAll(\".TEST\").length===0)){k=function(d,f,e,h){f=f||document;if(!h&&f.nodeType===9&&!s(f))try{return q(f.querySelectorAll(d),e)}catch(j){}return a(d,f,e,h)};for(var c in a)k[c]=a[c];b=null}}();document.getElementsByClassName&&document.documentElement.getElementsByClassName&&function(){var a=document.createElement(\"div\");a.innerHTML=\n\"<div class='test e'></div><div class='test'></div>\";if(a.getElementsByClassName(\"e\").length!==0){a.lastChild.className=\"e\";if(a.getElementsByClassName(\"e\").length!==1){i.order.splice(1,0,\"CLASS\");i.find.CLASS=function(b,c,d){if(typeof c.getElementsByClassName!==\"undefined\"&&!d)return c.getElementsByClassName(b[1])};a=null}}}();var E=document.compareDocumentPosition?function(a,b){return a.compareDocumentPosition(b)&16}:function(a,b){return a!==b&&(a.contains?a.contains(b):true)},s=function(a){return a.nodeType===\n9&&a.documentElement.nodeName!==\"HTML\"||!!a.ownerDocument&&a.ownerDocument.documentElement.nodeName!==\"HTML\"},A=function(a,b){for(var c=[],d=\"\",f,e=b.nodeType?[b]:b;f=i.match.PSEUDO.exec(a);){d+=f[0];a=a.replace(i.match.PSEUDO,\"\")}a=i.relative[a]?a+\"*\":a;f=0;for(var h=e.length;f<h;f++)k(a,e[f],c);return k.filter(d,c)};return k}();");
jsio.setCachedSrc(".test", "test.js","jsio(\"from util.browser import $\");\nvar View=Class(function(){this.appendTo=function(a){a&&this.el&&a.appendChild(this.el);return this};this.show=function(){this.parent&&this.appendTo(this.parent)};this.hide=function(){this.el&&this.el.parentNode&&this.el.parentNode.removeChild(this.el)}}),Tab=Class(View,function(){this.init=function(a,b){this.el=$.create({className:\"tab\",text:a});$.onEvent(this.el,\"click\",b)}}),TabView=Class(View,function(){this.init=function(a){this.el=$.create({className:\"tabView\"});this.tabs=$.create({className:\"tabs\",\nparent:this.el,style:{display:\"none\"}});this.views=$.create({className:\"views roundBottoms roundTopRight\",parent:this.el,style:{display:\"none\"}});this.list={};a&&$.addClass(this.el,a)};this.addView=function(a,b){if(!(b in this.list)){this.list[b]={view:a,tab:(new Tab(b,bind(this,\"showView\",b))).appendTo(this.tabs)};this.showView(b);this.tabs.style.display=\"block\";this.views.style.display=\"block\"}};this.showView=function(a){var b=this.list[a],c=this.list[this.current];if(c){$.remove(c.view.el);$.removeClass(c.tab.el,\n\"tabSelected\")}this.current=a;$.addClass(b.tab.el,\"tabSelected\");b.view.appendTo(this.views)}}),ConnectionView=Class(View,function(){this.init=function(a){this.conn=a;a.onSubscribed=bind(this,\"onSubscribed\");a.onOpen=bind(this,\"onOpen\");a.onClose=bind(this,\"onClose\");a.onError=bind(this,\"onError\");this.el=$.create({className:\"connectionView\"});this.logger=new LogView(this.el);$.addClass(this.logger.el,\"connectionLogger round\");this.controls=$.create({className:\"channelControls\",parent:this.el});this.controls.innerHTML=\n\"<h2>Channels</h2><b>name:</b> \";this.channelInput=$.create({className:\"channelInput\",tag:\"input\",parent:this.controls});this.channelSubmit=$.create({className:\"channelSubmit\",tag:\"button\",text:\"subscribe\",parent:this.controls});$.onEvent(this.channelInput,\"keypress\",this,function(b){b.keyCode==13&&this.submitChannel()});$.onEvent(this.channelSubmit,\"click\",this,\"submitChannel\");this.tabView=(new TabView(\"channelTabs\")).appendTo(this.el);this.logger.info(\"connecting to\",a.url)};this.submitChannel=\nfunction(){var a=this.channelInput.value;this.conn.subscribe(a);this.channelInput.value=\"\";this.logger.info(\"subscribing to\",a)};this.onOpen=function(){this.logger.info(\"connected\")};this.onClose=function(){this.logger.info(\"disconnected\")};this.onError=function(a){this.logger.error(JSON.stringify(a))};this.onSubscribed=function(a,b){this.tabView.addView(new ChannelView(this.conn,b,this.views),a);this.logger.info(\"subscribed to\",a)}}),ChannelView=Class(View,function(){this.init=function(a,b,c){this.conn=\na;this.sub=b;this.parent=c;this.el=$.create({className:\"channelView\"});this.info=$.create({className:\"channelHeader channelInfo\",parent:this.el});c=$.create({className:\"channelHeader channelState\",parent:this.el});c.innerHTML=\"<h3>state:</h3> <pre></pre>\";this.state=c.lastChild;this.presence=$.create({className:\"channelHeader channelPresence\",parent:this.el});c=$.create({className:\"channelHeader channelPublisher\",parent:this.el});this.publishInput=$.create({className:\"channelPublish\",tag:\"input\",\nparent:c});this.publishBtn=$.create({className:\"channelPublishBtn\",tag:\"button\",text:\"publish\",parent:c});$.onEvent(this.publishBtn,\"click\",this,\"publish\");$.onEvent(this.publishInput,\"keypress\",this,function(d){d.keyCode==13&&this.publish()});this.logger=new LogView(this.el);$.addClass(this.logger.el,\"channelLogger\");b.onSubscribe=bind(this,\"onSubscribe\");b.onPublish=bind(this,\"onPublish\");b.onUnsubscribe=bind(this,\"onUnsubscribe\");b.onState=bind(this,\"renderState\");this.renderHistory();this.logger.info(\"-- end of channel history -- \");\nthis.onSubscribe({user:a.username});this.renderState()};this.publish=function(){var a;try{a=eval(\"(\"+this.publishInput.value+\")\")}catch(b){a=this.publishInput.value}this.conn.publish(this.sub.channelName,a)};this.onSubscribe=function(a,b){this.logger.info(a.user,\"subscribed\");b||this.renderPresence()};this.onUnsubscribe=function(a,b){this.logger.info(a.user,\"unsubscribed\");b||this.renderPresence()};this.onPublish=function(a){this.logger.msg(a.user+\":\",a.payload)};this.renderHistory=function(){for(var a=\nthis.sub.history,b=0,c=a.length;b<c;++b)if(a[b]){var d=a[b][1];switch(a[b][0]){case \"PUBLISH\":this.onPublish(d);break;case \"UNSUBSCRIBE\":this.onUnsubscribe(d,true);break;case \"SUBSCRIBE\":this.onSubscribe(d,true);break}}};this.renderState=function(){this.info.innerHTML=\"<h3>historySize:</h3> \"+this.sub.historySize;$.setText(this.state,JSON.stringify(this.sub.state,null,\"\\t\"))};this.renderPresence=function(){if(this.sub.presence){this.presence.innerHTML=\"<h3>Presence:</h3>\";for(var a=0,b=this.sub.presence.length;a<\nb;++a)$.create({className:\"presenceRow\",text:this.sub.presence[a],parent:this.presence})}else $.setText(this.presence,\"This channel does not have presence.\")}}),LogView=Class(View,function(){function a(b){return function(){var c=$.create({className:\"logRow \"+b,text:this.getText(arguments)});this.el.firstChild?this.el.insertBefore(c,this.el.firstChild):this.el.appendChild(c)}}this.init=function(b){this.el=$.create({className:\"logView\",parent:b})};this.getText=function(b){var c=new Date;c=[c.getHours(),\nc.getMinutes(),c.getSeconds()];for(var d=0;d<3;++d)if(c[d]<10)c[d]=\"0\"+c[d];return c.join(\":\")+\": \"+Array.prototype.slice.call(b).join(\" \")};this.msg=a(\"logMsg\");this.info=a(\"logInfo\");this.warn=a(\"logWarn\");this.error=a(\"logError\")}),conns=GLOBAL.conns=[],numConns=0;function connect(){var a=$.id(\"url\").value,b=hookbox.connect(a),c=new ConnectionView(b);main.addView(c,numConns+\":\"+a);++numConns;b={conn:b,view:c};conns[a]=b;conns.push(b)}main=new TabView(\"connectionTabs\");$.id(\"content\").appendChild(main.el);\nvar url=$.id(\"url\");if(!url.value)url.value=location.protocol+\"//\"+location.host;$.onEvent(\"connect\",\"click\",connect);$.onEvent(\"url\",\"keypress\",function(a){a.keyCode==13&&connect()});");

jsio('from base import *');
jsio('from util.browser import $');
jsio('import .test');
</script>
</body>
