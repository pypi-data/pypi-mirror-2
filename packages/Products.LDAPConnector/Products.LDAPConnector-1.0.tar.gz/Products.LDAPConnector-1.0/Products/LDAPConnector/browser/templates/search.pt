<h1 tal:replace="structure context/manage_page_header">HEADER</h1>

<h1 tal:define="management_view string:Test"
    tal:replace="structure context/manage_tabs">TABS</h1>

<p class="form-help">
  Test the connection by performing a LDAP search.
</p>

<form action="manage_search" method="post">

  <table cellspacing="0" cellpadding="2" width="98%">


    <tr>
      <td align="left" valign="top" class="form-label">
        Search base
      </td>
      <td align="left" valign="top" colspan="3">
        <input type="text" name="searchbase" size="40" value=""
               tal:attributes="value request/searchbase|string:"/>
      </td>
    </tr>

    <tr>
      <td align="left" valign="top" class="form-label">
        Search scope
      </td>
      <td align="left" valign="top">
        <select name="scope:int"
                tal:define="chosen request/scope|string:2">
          <option value="0"
                  tal:attributes="selected python: int(chosen) == 0">
            Base (only search the search base record)
          </option>
          <option value="1"
                  tal:attributes="selected python: int(chosen) == 1">
            Onelevel (search only the level under the search base)
          </option>
          <option value="2"
                  tal:attributes="selected python: int(chosen) == 2">
            Subtree (search everything underneath and including the search base)
          </option>
        </select>
      </td>
    </tr>
    <tr>
      <td align="left" valign="top" class="form-label">
        LDAP filter expression
      </td>
      <td align="left" valign="top">
        <input type="text" name="fltr" size="40" value=""
               tal:attributes="value request/fltr|string:(objectClass=*)"/>
      </td>
    </tr>
      
    <tr>
      <td colspan="2"> 
        <input type="submit" name="start_search" value=" Search "> 
      </td>
    </tr>

  </table>

</form>

<script type="text/javascript">
<!--
    function toggle_visibility(id) {
       var e = document.getElementById(id);
       var plus = document.getElementById(id + '_plus');
       var minus = document.getElementById(id + '_minus');
       if(e.style.display == '') {
          e.style.display = 'none';
          plus.style.display = '';
          minus.style.display = 'none';
       }
       else {
          e.style.display = '';
          plus.style.display = 'none';
          minus.style.display = '';
       }
    }
//-->
</script>

<table width="98%"
       tal:condition="request/start_search|nothing">

  <tr class="list-header">
    <td class="form-label" colspan="2"> Search results </td>
  </tr>

  <tr tal:condition="view/status">
    <td class="form-text" colspan="2"
        tal:content="view/status"> Error message </td>
  </tr>

  <tr tal:repeat="rec view/results">
    <td width="16" valign="top" style="white-space: nowrap">
      <a href="#" id="" onClick=""
        tal:attributes="onClick string:toggle_visibility('${rec/dn}');; return false;;"
         ><img src="/p_/pl" alt="+" border="0" id=""
               tal:attributes="id string:${rec/dn}_plus" 
               /><img src="/p_/mi" alt="-" border="0" style="display: none;" id=""
                     tal:attributes="id string:${rec/dn}_minus"/></a>
    </td>
    <td class="form-text">
      <strong>
      <a href="#" onClick=""
         tal:attributes="onClick string:toggle_visibility('${rec/dn}');; return false;;"
         tal:content="rec/dn"> cn=foo, dc=localhost </a>
      </strong>
      <div id="" style="{display: none;}"
           tal:attributes="id rec/dn">
        <tal:block repeat="key rec/attributes">
          <span tal:replace="string:${key}: ${rec/?key}"/><br/>
        </tal:block>
      </div>
    </td>
  </tr>
  
</table>


<h1 tal:replace="structure context/manage_page_footer">FOOTER</h1>

