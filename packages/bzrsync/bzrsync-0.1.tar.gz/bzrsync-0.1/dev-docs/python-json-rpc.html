<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">

  
  


  

  
    <title>
      python-json-rpc â€“
      JSON-RPC
    </title>
        <link rel="search" href="http://json-rpc.org/search">
        <link rel="help" href="http://json-rpc.org/wiki/TracGuide">
        <link rel="alternate" href="http://json-rpc.org/wiki/python-json-rpc?format=txt" type="text/x-trac-wiki" title="Plain Text">
        <link rel="up" href="http://json-rpc.org/wiki/python-json-rpc" title="View Latest Version">
        <link rel="start" href="http://json-rpc.org/wiki">
        <link rel="stylesheet" href="python-json-rpc_files/trac.css" type="text/css"><link rel="stylesheet" href="python-json-rpc_files/wiki.css" type="text/css">
        <link rel="shortcut icon" href="http://json-rpc.org/chrome/common/no%20icon%20yet">
        <link rel="icon" href="http://json-rpc.org/chrome/common/no%20icon%20yet">
      <link type="application/opensearchdescription+xml" rel="search" href="http://json-rpc.org/search/opensearch" title="Search JSON-RPC">
    <script type="text/javascript" src="python-json-rpc_files/jquery.js"></script><script type="text/javascript" src="python-json-rpc_files/trac.js"></script><script type="text/javascript" src="python-json-rpc_files/search.js"></script>
    <!--[if lt IE 7]>
    <script type="text/javascript" src="/chrome/common/js/ie_pre7_hacks.js"></script>
    <![endif]-->
    <script type="text/javascript">
      jQuery(document).ready(function($) {
        $("#content").find("h1,h2,h3,h4,h5,h6").addAnchor("Link to this section");
      });
    </script>
  </head><body>
    <div id="banner">
      <div id="header">
        <h1><a href="http://json-rpc.org/">JSON-RPC</a></h1>
      </div>
      <form id="search" action="/search" method="get">
        <div>
          <label for="proj-search">Search:</label>
          <input id="proj-search" name="q" size="18" type="text">
          <input value="Search" type="submit">
        </div>
      </form>
      <div id="metanav" class="nav">
    <ul>
      <li class="first"><a href="http://json-rpc.org/login">Login</a></li><li><a href="http://json-rpc.org/wiki/TracGuide">Help/Guide</a></li><li><a href="http://json-rpc.org/about">About Trac</a></li><li class="last"><a href="http://json-rpc.org/prefs">Preferences</a></li>
    </ul>
  </div>
    </div>
    <div id="mainnav" class="nav">
    <ul>
      <li class="first active"><a href="http://json-rpc.org/wiki">Wiki</a></li><li><a href="http://json-rpc.org/timeline">Timeline</a></li><li><a href="http://json-rpc.org/roadmap">Roadmap</a></li><li><a href="http://json-rpc.org/browser">Browse Source</a></li><li><a href="http://json-rpc.org/report">View Tickets</a></li><li class="last"><a href="http://json-rpc.org/search">Search</a></li>
    </ul>
  </div>
    <div id="main">
      <div id="ctxtnav" class="nav">
        <h2>Context Navigation</h2>
          <ul>
            <li class="first "><a href="http://json-rpc.org/wiki/WikiStart">Start Page</a></li><li><a href="http://json-rpc.org/wiki/TitleIndex">Index</a></li><li><a href="http://json-rpc.org/wiki/python-json-rpc?action=history">History</a></li><li class="last"><a href="http://json-rpc.org/wiki/python-json-rpc?action=diff&amp;version=12">Last Change</a></li>
          </ul>
        <hr>
      </div>
    <div id="content" class="wiki">
      <div class="wikipage searchable">
        
          <h1 id="JSON-RPCforpython">JSON-RPC for python</h1>
<p>
There are two implementations hosted on json-rpc.org:
The <a class="wiki" href="http://json-rpc.org/wiki/python-json-rpc-old">old one</a> which has support for JSON-RPC over TCP and HTTP.
And there is the rewrite of JSON-RPC for python, it is described in this document.
    
You can <a href="http://json-rpc.org/browser/trunk/python-jsonrpc/">browse</a> the code or check it out 
using subversion from the <a class="ext-link" href="http://svn.json-rpc.org/trunk/python-jsonrpc/"><span class="icon">svn repository</span></a>.
</p>
<p>
The current implementation provides functionality for making JSON-RPC services available through CGI
and through a mod-python handler.
It also provides an easy to use proxy class for calling JSON-RPC services from python.
</p>
<h2 id="Installation">Installation</h2>
<p>
Download the source using subversion.
</p>
<pre class="wiki">$ svn checkout http://svn.json-rpc.org/trunk/python-jsonrpc
</pre><p>
As root/administrator install the package running the provided setup script.
</p>
<pre class="wiki">$ cd python-jsonrpc
$ python setup.py install
</pre><p>
If you do not wish to install the package you can simply copy the <tt>jsonrpc</tt>
 folder
to where python can find it when it searches for modules to be imported.
 E.g. this can be the same place where you python script resides in.
</p>
<h2 id="UsingtheServiceProxyclass">Using the <tt>ServiceProxy</tt> class</h2>
<p>
If everything worked you should now be able to call JSON-RPC services.
Start your favourite python shell and enter the code below:
</p>
<div class="code"><pre><span class="o">&gt;&gt;&gt;</span> <span class="k">from</span> <span class="nn">jsonrpc</span> <span class="k">import</span> ServiceProxy
<span class="o">&gt;&gt;&gt;</span> s <span class="o">=</span> ServiceProxy<span class="p">(</span><span class="s">"http://jsolait.net/services/test.jsonrpc"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span> s<span class="o">.</span>echo<span class="p">(</span><span class="s">"foobar"</span><span class="p">)</span>
</pre></div><p>
The example above creates a proxy object for a service hosted on jsolait.net
It calls the service's <tt>echo</tt> method and prints out the result of the call.
</p>
<h2 id="CreatingCGIbasedservices">Creating CGI based services</h2>
<p>
To provide your own service you can create a python CGI-Script and use <tt>jsonrpc</tt>'s <tt>handleCGI</tt> method for handling requests.
</p>
<div class="code"><pre><span class="c">#!/usr/bin/env python</span>

<span class="k">from</span> <span class="nn">jsonrpc</span> <span class="k">import</span> handleCGI<span class="p">,</span> ServiceMethod

<span class="nd">@ServiceMethod</span>
<span class="k">def</span> <span class="nf">echo</span><span class="p">(</span>msg<span class="p">):</span>
    <span class="k">return</span> msg


<span class="k">if</span> __name__ <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    handleCGI<span class="p">()</span>
</pre></div><p>
This is the simplest way to create a service using as CGI script.
All methods in the script decorated using the <tt>ServiceMethod</tt> decorator are available to remote callers.
all other methods are inaccessible to the "outside world".   
</p>
<p>
<tt>handleCGI()</tt> gives you some flexibility to define what to use as the service.
By default, as seen above it uses the <tt>__main__</tt> module as a service.
You can though, specify a particular service to be used by passing it to <tt>handleCGI(service)</tt> as first parameter:
</p>
<div class="code"><pre><span class="c">#!/usr/bin/env python</span>

<span class="k">from</span> <span class="nn">jsonrpc</span> <span class="k">import</span> handleCGI<span class="p">,</span> ServiceMethod

<span class="k">class</span> <span class="nc">MyService</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="nd">@ServiceMethod</span>
    <span class="k">def</span> <span class="nf">echo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> msg<span class="p">):</span>
        <span class="k">return</span> msg


<span class="k">if</span> __name__ <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    service <span class="o">=</span> MyService<span class="p">()</span>
    handleCGI<span class="p">(</span>service<span class="p">)</span>
</pre></div><h2 id="Creatingmod-pythonbasedservices">Creating mod-python based services</h2>
<p>
Similar to the way the CGI handling works, you can use <tt>jsonrpc</tt>'s mod-python handler.
First you need to install and setup mod-python to handle service URLs using <tt>jsonrpc</tt>'s mod-python handler.
 
E.g. in your <tt>.htaccess</tt> file in any folder that is being served by apache add: 
</p>
<pre class="wiki">AddHandler mod_python .py
PythonHandler jsonrpc 
</pre><p>
Make sure apache is setup to allow you to add the <tt>AddType</tt> Directive in <tt>.htaccess</tt> files.
Alternatively you can create an apache config file which gets loaded by apache upon startup.
In a <tt>Location</tt> or <tt>Directory</tt> section you should add the python handler:
</p>
<pre class="wiki">Alias /services/ /var/www/json-rpc-services/
&lt;Location /services/&gt;
  AddHandler mod_python .py
  PythonHandler jsonrpc
&lt;/Location&gt;
</pre><p>
If you have not installed <tt>jsonrpc</tt> using it's setup script, you will need to add it's location
to python's <tt>sys</tt>-path so that mod-python can find it.
In your apache config or <tt>.htaccess</tt> file add:
</p>
<pre class="wiki">  ...
  PythonHandler jsonrpc
  PythonPath "sys.path+["/path/to/where/jsorpc/package/is/located/"]
</pre><p>
Now you need to create a python script that will be used as a service.
Place it in a sub folder that is covered by the Directives above.
E.g. in the folder of where <tt>.htaccess</tt> is located or a subfolder thereof
or in any sub-folder of <tt>/var/www/json-rpc-services/</tt> for the second config example.
</p>
<p>
Similar to the CGI based service you can create a script with methods decorated using the <tt>ServiceMethod</tt> decorator:
</p>
<div class="code"><pre><span class="k">from</span> <span class="nn">jsonrpc</span> <span class="k">import</span> handleCGI<span class="p">,</span> ServiceMethod

<span class="nd">@ServiceMethod</span>
<span class="k">def</span> <span class="nf">echo</span><span class="p">(</span>msg<span class="p">):</span>
    <span class="k">return</span> msg
</pre></div><p>
Again, this is probably the simplest way to create a service.
</p>
<p>
You can also create a script which exposes a <tt>service</tt> , which will then be used as 
the service.
</p>
<div class="code"><pre><span class="k">from</span> <span class="nn">jsonrpc</span> <span class="k">import</span> ServiceMethod

<span class="k">class</span> <span class="nc">MyService</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="nd">@ServiceMethod</span>
    <span class="k">def</span> <span class="nf">echo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> msg<span class="p">):</span>
        <span class="k">return</span> msg

service <span class="o">=</span> MyService<span class="p">()</span>
</pre></div><p>
or you create a script which exposes a <tt>Service</tt> class. A service object will be created using this class
and used as a service.
</p>
<div class="code"><pre><span class="k">from</span> <span class="nn">jsonrpc</span> <span class="k">import</span> ServiceMethod

<span class="k">class</span> <span class="nc">Service</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="nd">@ServiceMethod</span>
    <span class="k">def</span> <span class="nf">echo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> msg<span class="p">):</span>
        <span class="k">return</span> msg
</pre></div><h2 id="Testingyourservices">Testing your services</h2>
<p>
Lets assume you created a mod-python based or a CGI based service using a script called <tt>test.py</tt>
and that that script can be found under the URL <tt>http://localhost/services/test.py</tt> (check your web server configuration).
</p>
<p>
Now you should be able to use your services with any JSON-RPC client that supports json-rpc over HTTP.
The simplest way to try it out, is to start your python shell an use <tt>jsonrpc</tt>'s <tt>ServiceProxy</tt> class.
</p>
<div class="code"><pre><span class="o">&gt;&gt;&gt;</span> <span class="k">from</span> <span class="nn">jsonrpc</span> <span class="k">import</span> ServiceProxy
<span class="o">&gt;&gt;&gt;</span> s <span class="o">=</span> ServiceProxy<span class="p">(</span><span class="s">"http://localhost/services/test.py"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span> s<span class="o">.</span>echo<span class="p">(</span><span class="s">"foobar"</span><span class="p">)</span>
</pre></div><h2 id="Errorhandling">Error handling</h2>
<p>
Any error that the <tt>ServiceProxy</tt> received through the JSON-RPC protocoll will be raised as a <tt>JSONRPCException</tt> before the called method returns. 
The exception raised will contain a service specific error object, which can be accessed using the exception's <tt>error</tt> property.
</p>
<div class="code"><pre><span class="k">try</span><span class="p">:</span>
  <span class="k">print</span> s<span class="o">.</span>echo<span class="p">(</span><span class="s">"foobar"</span><span class="p">)</span>
<span class="k">except</span> JSONRPCException<span class="p">,</span> e<span class="p">:</span>
  <span class="k">print</span> <span class="nb">repr</span><span class="p">(</span>e<span class="o">.</span>error<span class="p">)</span>
</pre></div><p>
Any exception raised in a Service's method during invokation will be 
converted into an error object and transmitted back to the caller by <tt>jsonrpc</tt>. The error object will use the exception's class name as
a name property and it's message property as the message property of the error object being returned.
</p>

        
        
      </div>
    </div>
    <script type="text/javascript">
        jQuery.loadStyleSheet("/pygments/trac.css", "text/css");
    </script>
    <div id="altlinks">
      <h3>Download in other formats:</h3>
      <ul>
        <li class="last first">
          <a rel="nofollow" href="http://json-rpc.org/wiki/python-json-rpc?format=txt">Plain Text</a>
        </li>
      </ul>
    </div>
    </div>
    <div id="footer" xml:lang="en" lang="en"><hr>
      <a id="tracpowered" href="http://trac.edgewall.org/"><img src="python-json-rpc_files/trac_logo_mini.png" alt="Trac Powered" width="107" height="30"></a>
      <p class="left">
        Powered by <a href="http://json-rpc.org/about"><strong>Trac 0.11.1</strong></a><br>
        By <a href="http://www.edgewall.org/">Edgewall Software</a>.
      </p>
      <p class="right">Visit the Trac open source project at<br><a href="http://trac.edgewall.com/">http://trac.edgewall.com/</a></p>
    </div>
  </body></html>