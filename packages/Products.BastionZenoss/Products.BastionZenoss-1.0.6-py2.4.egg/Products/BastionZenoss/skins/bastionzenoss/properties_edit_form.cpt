<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="rpmdistro">

    <div metal:fill-slot="main"
         tal:define="errors options/state/getErrors;
                     lockable python:hasattr(here, 'wl_isLocked');
                     isLocked python:lockable and here.wl_isLocked();
                     capwords python: modules['string'].capwords">

        <h1><img src="" alt="" tal:define="icon python: context.getIcon(1)"
                 tal:attributes="src string:${utool}/${icon}; alt context/meta_type">&nbsp;
            <span tal:content="context/title_or_id" class="documentFirstHeading"/>
        </h1>

        <a href=""
           class="link-parent"
           tal:define="parent_url python:context.navigationParent(context, template.getId())"
           tal:condition="parent_url"
           tal:attributes="href parent_url"
           i18n:translate="go_to_parent_url">
        Up one level
        </a>

        <form name="edit_form"  action="."  method="post" 
              tal:attributes="action python: 'portal_factory' in context.absolute_url() and '%s/%s' % (context.getId(), template.getId()) or template.getId()" >

          <tal:block tal:repeat="prop context/propertyMap">
            <tal:block tal:define="type prop/type;
                                   name python: '%s:%s' % (prop['id'], type);
                                   value python: context.getProperty(prop['id'])">

               <div class="field">

	         <label tal:define="id python: prop['id'].replace('_', ' ');
                                    id python: id.replace('-', ' ');
                                    id python: capwords(id);" 
                        tal:attributes="for prop/id"
                        tal:content="id"/>
                 
                 <div class="formHelp" tal:content="type"/>

                 <input type="text" size="50" 
                        tal:condition="python: type in ('string', 'int', 'date', 'float', 'ustring', 'currency')"
                        tal:attributes="name name;
                                        value value"/>
                 <select tal:condition="python: type in ('selection',)"
                         tal:attributes="name name">
                    <option tal:define="function python: getattr(context, prop['select_variable'])"
                            tal:repeat="option python: function()"
                            tal:content="option" tal:on-error="string:"
                            tal:attributes="selected python: test(value==option, 1, 0)"/>
                    <option tal:define="function python: getattr(context, prop['select_variable'])"
                            tal:repeat="option function"
                            tal:content="option" tal:on-error="string:"
                            tal:attributes="selected python: test(value==option, 1, 0)"/>
                 </select>
                 <select multiple size="3"
                         tal:condition="python: type in ('multiple selection',)"
                         tal:attributes="name name">
                    <option tal:define="function python: getattr(context, prop['select_variable'])"
                            tal:repeat="option python: function()"
                            tal:content="option"  tal:on-error="string:"
                            tal:attributes="selected python: test(option in value, 1, 0)"/>
                    <option tal:define="function python: getattr(context, prop['select_variable'])"
                            tal:repeat="option function"
                            tal:content="option"  tal:on-error="string:"
                            tal:attributes="selected python: test(option in value, 1, 0)"/>
                 </select>
                 <textarea rows="3" cols="50"
                           tal:condition="python: type in ('lines',)"
                           tal:attributes="name name;"
                           tal:content="python: '\n'.join(value)"/>
                 <textarea rows="5" cols="50"
                           tal:condition="python:type in ('text', 'utext')"                     
                           tal:attributes="name name;"
                           tal:content="value"/>
                 <input type="text" size="50"
                        tal:condition="python: type in ('tokens',)"
                        tal:attributes="name name;
                                        value python: ' '.join(value)"/>
                 <input type="checkbox"  value="1"
                        tal:condition="python: type in ('boolean',)"
                        tal:attributes="name name;
                                        checked  value"/>
               </div>
             </tal:block>
          </tal:block>

          <input class="context"
                 tabindex=""
                 type="submit"
                 name="form.button.Edit"
                 value="Edit"
                 i18n:attributes="value"
                 tal:attributes="tabindex tabindex/next;
                                 disabled python:test(isLocked, 'disabled', None);" />

          <input class="standalone"
                 tabindex=""
                 type="submit"
                 name="form.button.Cancel"
                 value="Cancel"
                 i18n:attributes="value"
                 tal:attributes="tabindex tabindex/next;" />

          <input type="hidden" name="form.submitted" value="1" />

      </form>

   </div>

</html>
