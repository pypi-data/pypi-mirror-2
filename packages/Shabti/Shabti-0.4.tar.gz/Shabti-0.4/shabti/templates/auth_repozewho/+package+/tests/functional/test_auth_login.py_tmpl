# auth_repozewho/tests/functional/test_auth_login
from pylons import url
from {{package}}.tests import *

class TestAuthLoginController(TestController):

    # def setUp(self):
    #     TestModel.setUp(self)
    # 
    # 
    # def tearDown(self):
    #     TestModel.tearDown(self)
    #     Session.close()
    # 
    # 
    def test_admin_signin(self):
        """Login (repozewho): Ensure that signin is successful"""
        response = self.app.post(url('/login_handler'),
                                     params={'username':u'admin',
                                             'password':"admin"})
        assert response.status_int == 302
        assert response.location == 'http://localhost/login/welcome_back?__logins=0'
    
    
    def test_admin_signout(self):
        """Login (repozewho): Ensure that signout is successful."""
        response = self.app.get(url('/logout_handler'))
        
        assert response.status_int == 302
        
        assert response.location == 'http://localhost/login/see_you_later?came_from=%2F'
    
    
    def test_unauthorised_model_access_is_prohibited(self):
        """Login (repozewho): unauthorised GET access is prohibited."""
        response = self.app.get(url('/demo/privindex'))
        
        assert response.status_int == 302
        
        assert response.location == 'http://localhost/login/index?came_from=http%3A%2F%2Flocalhost%2Fdemo%2Fprivindex'
    


# --- Added by Shabt auth_repozewho template

