"""Custom validators"""
import formencode
from {{package}}.model import User
from {{package}}.model import meta

class UniqueDisplayname(formencode.FancyValidator):
    def _to_python(self, value, state):
        if meta.Session.query(User).filter_by(displayname=value).all():
            raise formencode.Invalid('Display name already exists',
                                     value, state)
        else:
            return value


