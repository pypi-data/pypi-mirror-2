# authplus/tests/functional/test_auth_login
from pylons import url
from {{package}}.tests import *

class TestAuthLoginController(TestController):

    def test_admin_signin(self):
        """TestAuthLogin (authplus): signin is successful"""
        response = self.app.post(url(controller='login', action='signin'),
                                     params={'username':u'admin',
                                             'password':"admin"})
        
        assert response.status_int == 302
        
        assert response.location == 'http://localhost/demo/privindex'
    

    def test_admin_signout(self):
        """TestAuthLogin (authplus): signout is successful."""
        response = self.app.get(url(controller='login', action='signout'))
        
        assert response.status_int == 302
        
        assert response.location == 'http://localhost/login/index'
    

    def test_unauthorised_model_access_is_prohibited(self):
        """TestAuthLogin (authplus): unauthorised GET access is prohibited."""
        response = self.app.get(url(controller='demo', action='privindex'))
        
        assert response.status_int == 302
        print(response)
        assert response.location == 'http://localhost/accounts/login'
    

# --- Added by Shabti authplus template
