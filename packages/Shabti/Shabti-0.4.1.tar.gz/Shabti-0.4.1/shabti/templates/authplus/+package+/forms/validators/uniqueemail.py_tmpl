"""Custom validators"""
import formencode
from {{package}}.model import User
from {{package}}.model import meta

class UniqueEmail(formencode.FancyValidator):
    def _to_python(self, value, state):
        if meta.Session.query(User).filter_by(email=value).all():
            raise formencode.Invalid('Email address already exists', value,
                                     state)
        else:
            return value


