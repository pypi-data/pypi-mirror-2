<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="here/prefs_main_template/macros/master"
      i18n:domain="plone">

<head></head>

<body>
    <div id="content" metal:fill-slot="prefs_configlet_main">

        <span tal:condition="req/reindex | nothing"
              tal:define="req context/REQUEST"
              tal:content="view/reinit"/>

        <h1>Index PDF documents using OCR - Status page</h1>
        <ul>
            <li>
                <a href="#"
                   tal:attributes="href string:${context/portal_url}/@@do_pdf_ocr_index"
                   >Indexes PDF documents in queue</a>
            </li>
            <li>
                <a href="#"
                   tal:attributes="href string:${context/portal_url}/@@do_pdf_ocr_reindex"
                   >Reindex all PDF documents in the Plone site (WARNING... may take a long time!)</a>
            </li>
        </ul>

            <h2>Queue</h2>
            <tal:queue tal:repeat="doc view/queueStatus">
                <div tal:condition="doc">
                    <a href="#"
                       tal:content="string: ${doc/id} - ${doc/Title}"
                       tal:attributes="href string:${doc/url}/view;
                       title doc/Description">
                        [filename] - [title]
                    </a>
                </div>
                <p tal:condition="not:doc">No documents found</p>

            </tal:queue>
            <h2>History (last 10 documents)</h2>
            <tal:history tal:repeat="doc view/historyStatus">
                <div tal:condition="doc">
                    <a href="#"
                       tal:content="string: ${doc/id} - ${doc/Title}"
                       tal:attributes="href string:${doc/url}/view;
                       title doc/Description">
                        [filename] - [title]
                    </a>
                    -
                    <a href="#"
                       tal:attributes="href string:${doc/url}/@@text-from-ocr">
                        (text from ocr)
                    </a>
                </div>
                <p tal:condition="not:doc">No documents found</p>
            </tal:history>

        </div>
</body>

</html>


