<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US"
      lang="en-US"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="ATPhoto"
      >
<body>


<div metal:fill-slot="main"
     tal:define="auth python:here.getFlickrIdAndUrl(request)">
 <form method="post" action="" tal:attributes="action string:${request/URL1}/exportImage">
<fieldset>
<legend><span i18n:translate="">Export photo</span></legend>
<div class="field">
   <label i18n:translate="export_format">Export format</label>
   <div class="formHelp" i18n:translate="export_format_description">Choose here the format to export</div>
   <select name="format">
     <option value="PNG">PNG</option>
     <option value="JPEG" selected="selected">JPG</option>
     <option value="GIF">GIF</option>
     <option value="BMP">BMP</option>
     <option value="PCX">PCX</option>
     <option value="PPM">PPM</option>
     <option value="TIFF">TIFF</option>
   </select>
</div>
<div class="field">
   <label i18n:translate="width">Width</label>
   <div class="formHelp" i18n:translate="export_width_description">Set to 0 if you want to keep their original width.</div>
   <input tal:attributes="value here/width|string:0" type="text" name="newwidth:int" size="5" />
</div>
<div class="field">
   <label i18n:translate="height">Height</label>
   <div class="formHelp" i18n:translate="export_height_description">Set to 0 if you want to keep their original height.</div>
   <input tal:attributes="value here/height|string:0" type="text" name="newheight:int" size="5" />
</div>
<div class="field">
  <label i18n:translate="">Zip the file?</label>
  <div class="formHelp" i18n:translate="">Should we send you the photo compressed in a zip file?</div>
  <input type="checkbox" value="1" name="zip" />
</div>
<div class="formControls">
   <input i18n:attributes="value" class="context" type="submit" value="Export" />
</div>
</fieldset>
</form>

<fieldset 
   tal:define="authenticated python:here.isFlickrAuth(auth[0],REQUEST=request)">
  <legend i18n:translate="flickr_export">Flickr Export</legend>
  <fieldset tal:condition="python:not authenticated or request.get('forceNewAuth',0)">
   <legend i18n:translate="flickr_not_authenticated">Not Authenticated!</legend>
    <div>
      To authenticate go first to <a href="" tal:attributes="href python:auth[1]"><span tal:replace="python:auth[1]"/></a>
    </div>
    <div class="formControls">
     <form action="" tal:attributes="action request/URL0">
     <input class="context" type="submit" value="Check Authentication"  onClick="checkAuth()" />
     </form>
     <form action="" tal:attributes="action request/URL0">
        <input type="hidden" name="forceNewAuth" value="1" />
     <input class="context" type="submit" value="New Authentication" />
     </form>
  </div>

  </fieldset>
  <tal:block tal:condition="python:authenticated and not request.get('forceNewAuth',0)">
  <fieldset>
   <legend i18n:translate="flickr_authenticated">Authenticated!</legend>

  <form method="post" action="" tal:attributes="action string:${request/URL1}/exportFlickr">
    <div class="field">
      <label i18n:translate="label_title">Title</label>
      <div class="formHelp" i18n:translate="export_title_description">Title of the photo you want in your flick account.</div>
        <input type="text" name="title" size="40" />
    </div>
    <div class="field">
      <label i18n:translate="tags">Tags</label>
      <div class="formHelp" i18n:translate="tags_description">Tags of the photo you want in your Flick account.</div>
        <input type="text" name="tags" size="40" />
    </div>

    <div class="field">
      <label i18n:translate="description">Description</label>
      <div class="formHelp" i18n:translate="export_description_description">Description of the photo you want in your Flick account.</div>
        <textarea tal:attributes="value here/Description|string:0" type="text" name="description" size="20">
        </textarea>
    </div>

<div class="formControls">
   <input type="hidden" name="frob" value="" tal:attributes="value python:auth[0]" />
   <input i18n:attributes="value" class="context" type="submit" value="Export" />
</div>
</form>
<div class="formControls">
     <form action="" tal:attributes="action request/URL0">
        <input type="hidden" name="forceNewAuth" value="1" />
     <input class="context" type="submit" value="New Authentication" />
     </form>

</div>

  </fieldset>
  </tal:block>
</fieldset>
</div>

</body>
</html>
