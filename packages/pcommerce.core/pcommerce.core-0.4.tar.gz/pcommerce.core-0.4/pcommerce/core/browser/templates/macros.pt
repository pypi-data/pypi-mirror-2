<span class="priceInfo" i18n:domain="pcommerce" metal:define-macro="priceinfo">
  <tal:offer condition="price/offer" i18n:translate="price_offer">
    <span i18n:name="offer" tal:replace="price/price">CHF 150.00</span>
    instead of
    <span i18n:name="price" tal:replace="price/base_price/valueToString">CHF 200.00</span>
  </tal:offer>
  <tal:price condition="not: price/offer" content="price/price">
    CHF 200.00
  </tal:price>
</span>

<span class="productInfo" metal:define-macro="productInfo">
  <a class="productImage" tal:condition="product/object/getImage"
     tal:attributes="href product/url;
                     title product/description">
    <img src="" tal:attributes="src string:${product/url}/image_icon" />
  </a>
  <a href="" tal:attributes="href product/url;
                             title product/description"
             tal:content="product/title">
    Title
  </a>
  <strong class="no" tal:content="product/no">
    No
  </strong>
  <dl tal:condition="product/variations">
  <tal:variation tal:repeat="variation product/variations">
    <dt><span tal:replace="variation/type">Type</span>:</dt>
    <dd tal:content="variation/name">Name</dd>
  </tal:variation>
  </dl>
</span>

<dl class="portlet portletProduct" metal:define-macro="productPortlet"
    tal:attributes="class string:portlet portletProduct ${product/class|nothing}">
  <dd class="portletItem">
    <a href="#" title="" class="image"
       tal:condition="product/image"
       tal:attributes="href product/url;
                       title product/image/caption;">
        <img tal:attributes="src product/image/thumb;
                             alt product/image/caption;" alt="" src="" />
    </a>
    <a class="title" href="" 
       tal:attributes="href product/url"
       tal:content="product/title">
      Title
    </a>
    <span class="description"
          tal:condition="product/description"
          tal:content="product/description">
      Description
    </span>
  </dd>
  <dd class="portletFooter"
      tal:define="price product">
    <span class="priceInfo" metal:use-macro="context/@@pcommerce_macros/priceinfo" />
  </dd>
</dl>

<div id="cart" i18n:domain="pcommerce" metal:define-macro="cartInfo">
  <table>
    <thead>
      <tr>
        <th class="info" i18n:translate="">Product</th>
        <th i18n:translate="">Amount</th>
        <th class="discreet" i18n:translate="">Price</th>
        <th i18n:translate="">Price total</th>
      </tr>
    </thead>
  
    <tbody>
    <tal:items tal:repeat="product view/products">
      <tr tal:define="odd repeat/product/odd;"
          tal:attributes="class python:odd and 'odd' or 'even';" >
        <td class="info">
          <span metal:use-macro="context/@@pcommerce_macros/productInfo" />
        </td>
        <td class="amount" tal:content="product/amount">
          10
        </td>
        <td class="price discreet" tal:content="product/price/valueToString">
          50.00
        </td>
        <td class="price" tal:content="product/price_total/valueToString">
          500.00
        </td>
      </tr>
    </tal:items>
    </tbody>
    <tfoot>
      <tr>
        <th class="price" i18n:translate="">
          Total
        </th>
        <td>
          &nbsp;
        </td>
        <td colspan="2" class="price">
          <strong tal:content="view/price">
            500.00
          </strong>
        </td>
      </tr>
      <tr class="discreet" tal:condition="view/tax">
        <th class="price" i18n:translate="">
          VAT
        </th>
        <td>
          <tal:tax content="view/tax" /> %
        </td>
        <td colspan="2" class="price">
          <strong tal:content="view/price_tax">
            500.00
          </strong>
        </td>
      </tr>
      <tr class="total" tal:condition="view/tax">
        <th class="price" i18n:translate="">
          Total incl. VAT
        </th>
        <td>
          &nbsp;
        </td>
        <td colspan="2" class="price">
          <strong tal:content="view/total">
            500.00
          </strong>
        </td>
      </tr>
    </tfoot>
  </table>
</div>

<div metal:define-macro="paymentInfo"
     class="paymentInfo">
  <img src="" alt="" class="image-right" tal:condition="payment/logo" 
       tal:attributes="src payment/logo;
                       alt payment/title;" />
  <h4 tal:content="payment/title">
    Title
  </h4>
  <p tal:condition="payment/description" tal:content="payment/description">
    Description
  </p>
</div>

<div metal:define-macro="addressInfo"
     class="addressInfo">
  <address>
    <span tal:replace="address/name|nothing" /><br tal:condition="address/name|nothing" />
    <span tal:replace="address/address1|nothing" /><br tal:condition="address/address1|nothing" />
    <span tal:replace="address/address2|nothing" /><br tal:condition="address/address2|nothing" />
    <span tal:replace="address/zip|nothing" /> <span tal:replace="address/city|nothing" /><br tal:condition="address/zip|address/city|nothing" />
    <span tal:replace="address/country|nothing" /><br tal:condition="address/country|nothing" />
  </address>
  <span class="email" tal:condition="address/email|nothing" tal:content="address/email|nothing" /><br tal:condition="python:address.email and address.phone" />
  <span class="phone" tal:condition="address/phone|nothing" tal:content="address/phone|nothing" />
</div>

<metal:address define-macro="addressForm"
               i18n:domain="pcommerce">
<div class="address">
  <div class="field"
       tal:attributes="class python:'field'+(errors.has_key('name') and ' error' or '')">

      <label i18n:translate=""
             for="name">
          Name / Firm
      </label>

      <span class="fieldRequired"
            title="Required"
            i18n:domain="plone"
            i18n:attributes="title title_required;"
            i18n:translate="label_required">
          (Required)
      </span>

      <div tal:condition="python:errors.has_key('name')"
           tal:content="errors/name|nothing">
          The Error
      </div>

      <div class="widget">
          <input id="name" name="name" value="" type="text"
                 tal:attributes="value request/form/name|address/name|memberInfo/fullname|nothing" />
      </div>
  </div>
  
  <div class="field"
       tal:attributes="class python:'field'+(errors.has_key('address1') and ' error' or '')">

      <label i18n:translate=""
             for="address1">
          Address 1
      </label>

      <span class="fieldRequired"
            title="Required"
            i18n:domain="plone"
            i18n:attributes="title title_required;"
            i18n:translate="label_required">
          (Required)
      </span>

      <div tal:condition="python:errors.has_key('address1')"
           tal:content="errors/address1|nothing">
          The Error
      </div>

      <div class="widget">
          <input id="address1" name="address1" value="" type="text"
                 tal:attributes="value request/form/address1|address/address1|nothing" />
      </div>
  </div>
  
  <div class="field"
       tal:attributes="class python:'field'+(errors.has_key('address2') and ' error' or '')">

      <label i18n:translate=""
             for="address2">
          Address 2
      </label>

      <div tal:condition="python:errors.has_key('address2')"
           tal:content="errors/address2|nothing">
          The Error
      </div>

      <div class="widget">
          <input id="address2" name="address2" value="" type="text"
                 tal:attributes="value request/form/address2|address/address2|nothing" />
      </div>
  </div>
  
  <div class="field"
       tal:attributes="class python:'field'+((errors.has_key('zip') or errors.has_key('city')) and ' error' or '')">

      <label i18n:translate=""
             for="zip">
          ZIP / City
      </label>

      <span class="fieldRequired"
            title="Required"
            i18n:domain="plone"
            i18n:attributes="title title_required;"
            i18n:translate="label_required">
          (Required)
      </span>

      <div tal:condition="python:errors.has_key('zip')"
           tal:content="errors/zip|nothing">
          The Error
      </div>

      <div tal:condition="python:errors.has_key('city')"
           tal:content="errors/city|nothing">
          The Error
      </div>

      <div class="widget">
          <input id="zip" name="zip" value="" type="text" size="6"
                 tal:attributes="value request/form/zip|address/zip|nothing" />
                 
          <input id="city" name="city" value="" type="text"
                 tal:attributes="value request/form/city|address/city|nothing" />
      </div>
  </div>
  
  <div class="field"
       tal:attributes="class python:'field'+(errors.has_key('country') and ' error' or '')">

      <label i18n:translate=""
             for="country">
          Country
      </label>

      <span class="fieldRequired"
            title="Required"
            i18n:domain="plone"
            i18n:attributes="title title_required;"
            i18n:translate="label_required">
          (Required)
      </span>

      <div tal:condition="python:errors.has_key('country')"
           tal:content="errors/country|nothing">
          The Error
      </div>

      <div class="widget">
          <input id="country" name="country" value="" type="text"
                 tal:attributes="value request/form/country|address/country|nothing" />
      </div>
  </div>
  
  <div class="field"
       tal:condition="python: len(view.zones) > 1"
       tal:attributes="class python:'field'+(errors.has_key('zone') and ' error' or '')">

      <label i18n:translate=""
             for="zone">
          Zone
      </label>

      <span class="fieldRequired"
            title="Required"
            i18n:domain="plone"
            i18n:attributes="title title_required;"
            i18n:translate="label_required">
          (Required)
      </span>

      <div tal:condition="python:errors.has_key('zone')"
           tal:content="errors/zone|nothing">
          The Error
      </div>

      <div class="widget">
        <select id="zone" name="zone" size="1"
                tal:define="current request/form/zone|address/zone|nothing">
          <option value=""
                  tal:repeat="zone view/zones" tal:attributes="value zone/name;
                                                               selected python:current == zone['name'] and 'selected' or ''" tal:content="zone/name">
            Zone
          </option>
        </select>
      </div>
  </div>
  
  <input type="hidden" name="zone" value=""
         tal:condition="python: len(view.zones) == 1"
         tal:attributes="value python:view.zones[0]['name']" />
  
  <div class="field"
       tal:attributes="class python:'field'+(errors.has_key('email') and ' error' or '')">

      <label i18n:translate=""
             for="email">
          Email
      </label>

      <div tal:condition="python:errors.has_key('email')"
           tal:content="errors/email|nothing">
          The Error
      </div>

      <div class="widget">
          <input id="email" name="email" value="" type="text"
                 tal:attributes="value request/form/email|address/email|nothing" />
      </div>
  </div>
  
  <div class="field"
       tal:attributes="class python:'field'+(errors.has_key('phone') and ' error' or '')">

      <label i18n:translate=""
             for="phone">
          Phone
      </label>

      <div tal:condition="python:errors.has_key('phone')"
           tal:content="errors/phone|nothing">
          The Error
      </div>

      <div class="widget">
          <input id="phone" name="phone" value="" type="text"
                 tal:attributes="value request/form/phone|address/phone|nothing" />
      </div>
  </div>
</div>
</metal:address>
