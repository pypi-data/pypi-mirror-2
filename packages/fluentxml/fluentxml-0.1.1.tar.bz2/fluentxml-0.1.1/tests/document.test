>>> import fluentxml
>>> from fluentxml import Document, Parser

>>> data = '<?xml version="1.0"?>\n<?quux bar foo?>\n<?qux xyzzy="baz" foobar="waldo"?>\n<foo xmlns="foobar" xmlns:a="toto"><a:bar>data</a:bar><baz>re</baz><stream:stream xmlns="jabber:client" xmlns:stream="http://etherx.jabber.org/streams" id="c2s&amp;123"><a>&quot;&amp;&lt;&gt;</a></stream:stream></foo>\n'

>>> fluentxml.open = File(data)
>>> d = Document.load('/dev/null')
>>> d.instructions
[('quux', 'bar foo'), ('qux', 'xyzzy="baz" foobar="waldo"')]

>>> fluentxml.open = File()
>>> d.save()
>>> fluentxml.open.content == data
True

>>> fluentxml.open = File(data)
>>> Parser.pi_data_to_dict = True
>>> d = Document.load('/dev/null')
>>> d.instructions
[('quux', 'bar foo'), ('qux', {'foobar': 'waldo', 'xyzzy': 'baz'})]

>>> fluentxml.open = File()
>>> d.save()
>>> fluentxml.open.content
'<?xml version="1.0"?>\n<?quux bar foo?>\n<?qux foobar="waldo" xyzzy="baz"?>\n<foo xmlns="foobar" xmlns:a="toto"><a:bar>data</a:bar><baz>re</baz><stream:stream xmlns="jabber:client" xmlns:stream="http://etherx.jabber.org/streams" id="c2s&amp;123"><a>&quot;&amp;&lt;&gt;</a></stream:stream></foo>\n'

>>> data = '<?xml version="1.0"?>\n<?quux bar foo?>\n<?qux xyzzy="baz" foobar="waldo"?>\n<foo xmlns="foobar" xmlns:a="toto">\n  <a:bar>data</a:bar>\n  <baz>re</baz>\n  <stream:stream xmlns="jabber:client" xmlns:stream="http://etherx.jabber.org/streams" id="c2s&amp;123">\n    <a>&quot;&amp;&lt;&gt;</a>\n  </stream:stream>\n</foo>\n'

>>> fluentxml.open = File(data)
>>> Parser.pi_data_to_dict = False
>>> d = Document.load('/dev/null')
>>> d.instructions
[('quux', 'bar foo'), ('qux', 'xyzzy="baz" foobar="waldo"')]
>>> fluentxml.open.content = ''
>>> d.save()
>>> fluentxml.open.content
'<?xml version="1.0"?>\n<?quux bar foo?>\n<?qux xyzzy="baz" foobar="waldo"?>\n<foo xmlns="foobar" xmlns:a="toto">\n  <a:bar>data</a:bar>\n  <baz>re</baz>\n  <stream:stream xmlns="jabber:client" xmlns:stream="http://etherx.jabber.org/streams" id="c2s&amp;123">\n    <a>&quot;&amp;&lt;&gt;</a>\n  </stream:stream>\n</foo>\n'

>>> f1 = File(data)
>>> d = Document.load(f1)
>>> d.instructions
[('quux', 'bar foo'), ('qux', 'xyzzy="baz" foobar="waldo"')]
>>> f2 = File()
>>> d.save(f2)
>>> f2.read()
'<?xml version="1.0"?>\n<?quux bar foo?>\n<?qux xyzzy="baz" foobar="waldo"?>\n<foo xmlns="foobar" xmlns:a="toto">\n  <a:bar>data</a:bar>\n  <baz>re</baz>\n  <stream:stream xmlns="jabber:client" xmlns:stream="http://etherx.jabber.org/streams" id="c2s&amp;123">\n    <a>&quot;&amp;&lt;&gt;</a>\n  </stream:stream>\n</foo>\n'
