<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>django-olwidget documentation &mdash; olwidget v0.4 documentation</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.4',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="olwidget v0.4 documentation" href="index.html" />
    <link rel="next" title="olwidget.js documentation" href="olwidget.js.html" />
    <link rel="prev" title="Welcome to olwidget’s documentation!" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="olwidget.js.html" title="olwidget.js documentation"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="index.html" title="Welcome to olwidget’s documentation!"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">olwidget v0.4 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="django-olwidget-documentation">
<span id="django-olwidget"></span><h1>django-olwidget documentation<a class="headerlink" href="#django-olwidget-documentation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p><tt class="docutils literal"><span class="pre">django-olwidget</span></tt> is a portable Django application that uses
<a class="reference external" href="olwidget.js.html#olwidget-js"><em>olwidget.js</em></a> to easily create editable and informational
maps using GeoDjango, inside and outside of Django&#8217;s admin.</p>
<p>A quick guide to the <tt class="docutils literal"><span class="pre">olwidget</span></tt> module contents:</p>
<dl class="docutils">
<dt>Widgets: for display outside forms, single-layer maps in forms, or custom fields:</dt>
<dd><dl class="first last docutils">
<dt>Single layer:</dt>
<dd><a class="reference internal" href="#editablemap">EditableMap</a>, <a class="reference internal" href="#infomap">InfoMap</a></dd>
<dt>Multi layer:</dt>
<dd><a class="reference internal" href="#map-editablelayer-and-infolayer">Map, EditableLayer, and InfoLayer</a></dd>
</dl>
</dd>
<dt>Forms: for ModelForm convenience with multi- or single-layer maps:</dt>
<dd><a class="reference internal" href="#mapmodelform">MapModelForm</a></dd>
<dt>Fields: for multi-layer map editing in forms:</dt>
<dd><a class="reference internal" href="#mapfield-editablelayerfield-and-infolayerfield">MapField, EditableLayerField, and InfoLayerField</a></dd>
<dt>olwidget looks great in admin:</dt>
<dd><a class="reference internal" href="#geomodeladmin">GeoModelAdmin</a></dd>
</dl>
<p>And of course, customization of all types: <a class="reference internal" href="#options">options</a></p>
</div>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>Installation of the <tt class="docutils literal"><span class="pre">olwidget</span></tt> requires a couple of steps &#8211; these should be
familiar to users of other reusable Django apps:</p>
<ol class="arabic">
<li><p class="first">Install <tt class="docutils literal"><span class="pre">django-olwidget</span></tt> using your preferred method for python modules.
The folder <tt class="docutils literal"><span class="pre">olwidget</span></tt> in the <tt class="docutils literal"><span class="pre">django-olwidget</span></tt> directory must end up in
your python path.  You could do this by copying or symlinking it into your
path, or with:</p>
<div class="highlight-python"><pre>python setup.py install</pre>
</div>
<p>The preferred method is to install from using <a class="reference external" href="http://pip.openplans.org/">pip</a> with <a class="reference external" href="http://pypi.python.org/pypi/virtualenv">virtualenv</a>.  The <a class="reference external" href="http://pip.openplans.org/#requirements-files">requirements file</a> entry for the stable
version:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">django</span><span class="o">-</span><span class="n">olwidget</span>
</pre></div>
</div>
<p>To use the development version, the requirements is:</p>
<div class="highlight-python"><pre>-e git://github.com/yourcelf/olwidget.git#egg=django-olwidget</pre>
</div>
</li>
<li><p class="first">Copy or link the <tt class="docutils literal"><span class="pre">media/olwidget</span></tt> directory into to your project&#8217;s
<tt class="docutils literal"><span class="pre">MEDIA_ROOT</span></tt>.  If you wish to name the directory something other than
<tt class="docutils literal"><span class="pre">olwidget</span></tt>, define <tt class="docutils literal"><span class="pre">OLWIDGET_MEDIA_URL</span></tt> with the URL for the media
files in your settings file.</p>
</li>
<li><p class="first">Include <tt class="docutils literal"><span class="pre">'olwidget'</span></tt> in your project&#8217;s settings <tt class="docutils literal"><span class="pre">INSTALLED_APPS</span></tt> list.</p>
</li>
<li><p class="first">(Optional) If you want to use Google, Yahoo or CloudMade map layers, you
must include <tt class="docutils literal"><span class="pre">GOOGLE_API_KEY</span></tt>, <tt class="docutils literal"><span class="pre">YAHOO_APP_ID</span></tt> or <tt class="docutils literal"><span class="pre">CLOUDMADE_API_KEY</span></tt>
in your settings file.  <tt class="docutils literal"><span class="pre">olwidget</span></tt> uses an OpenStreetMaps layer by
default, which requires no key.</p>
</li>
</ol>
<p><tt class="docutils literal"><span class="pre">olwidget</span></tt> includes a test project demonstrating some of the <tt class="docutils literal"><span class="pre">olwidget</span></tt> app&#8217;s
functionality; this can be found in the <tt class="docutils literal"><span class="pre">django-olwidget/test_project</span></tt>
directory.  To use it, modify the <tt class="docutils literal"><span class="pre">settings.py</span></tt> directory to reflect your
database settings.  For convenience, a shell script, <tt class="docutils literal"><span class="pre">reset_testolwidget.sh</span></tt>,
is included to set up the database using <tt class="docutils literal"><span class="pre">postgres</span></tt>, <tt class="docutils literal"><span class="pre">template_postgis</span></tt>,and the database user and password specified in the script.</p>
</div>
<div class="section" id="widgets">
<h2>Widgets<a class="headerlink" href="#widgets" title="Permalink to this headline">¶</a></h2>
<p><tt class="docutils literal"><span class="pre">olwidget</span></tt> defines several widget types.  If all you need is a single-layer
map, or if you want to display maps outside of the context of a form, this is
what you want.  <a class="reference internal" href="#editablemap">EditableMap</a> and <a class="reference internal" href="#infomap">InfoMap</a> are single-layer widgets for
editing or displaying map data.  <a class="reference internal" href="#map-editablelayer-and-infolayer">Map, EditableLayer, and InfoLayer</a>
are the widget counterparts to the fields above which make display of
multi-layer maps outside of forms possible.</p>
<div class="section" id="editablemap">
<h3>EditableMap<a class="headerlink" href="#editablemap" title="Permalink to this headline">¶</a></h3>
<p><tt class="docutils literal"><span class="pre">EditableMap</span></tt> is a widget type for editing single layers.  Constructor:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">olwidget</span><span class="o">.</span><span class="n">widgets</span><span class="o">.</span><span class="n">EditableMap</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">template</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">options</span></tt></dt>
<dd>A dict of <a class="reference internal" href="#options">options</a> for map display.</dd>
<dt><tt class="docutils literal"><span class="pre">template</span></tt></dt>
<dd>A template to use for rendering the map.</dd>
</dl>
<p>An example form definition that uses an editable map:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django</span> <span class="kn">import</span> <span class="n">forms</span>
<span class="kn">from</span> <span class="nn">olwidget.widgets</span> <span class="kn">import</span> <span class="n">EditableMap</span>

<span class="k">class</span> <span class="nc">MyForm</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">Form</span><span class="p">):</span>
    <span class="n">location</span> <span class="o">=</span> <span class="n">forms</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">widget</span><span class="o">=</span><span class="n">EditableMap</span><span class="p">())</span>
</pre></div>
</div>
<p>In a template:</p>
<div class="highlight-django"><div class="highlight"><pre><span class="x">&lt;head&gt; </span><span class="cp">{{</span> <span class="nv">form.media</span> <span class="cp">}}</span><span class="x"> &lt;/head&gt;</span>
<span class="x">&lt;body&gt;... </span><span class="cp">{{</span> <span class="nv">form</span> <span class="cp">}}</span><span class="x"> ...&lt;/body&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="infomap">
<h3>InfoMap<a class="headerlink" href="#infomap" title="Permalink to this headline">¶</a></h3>
<p><tt class="docutils literal"><span class="pre">InfoMap</span></tt> is used for displaying read-only single-layer maps with clickable
information popups over geometries.  Unlike the other types, you probably want
to use this widget without a Form.  Constructor:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">olwidget</span><span class="o">.</span><span class="n">widgets</span><span class="o">.</span><span class="n">InfoMap</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">template</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">info</span></tt></dt>
<dd>A list of <tt class="docutils literal"><span class="pre">[geometry,</span> <span class="pre">attr]</span></tt> pairs.  <tt class="docutils literal"><span class="pre">attr</span></tt> can be either a string
containing html, or a dict containing <tt class="docutils literal"><span class="pre">html</span></tt> and <tt class="docutils literal"><span class="pre">style</span></tt> keys.  The
html is displayed when the geometry is clicked.</dd>
<dt><tt class="docutils literal"><span class="pre">options</span></tt></dt>
<dd>A dict of <a class="reference internal" href="#options">options</a> for map display.</dd>
<dt><tt class="docutils literal"><span class="pre">template</span></tt></dt>
<dd>A template to use for rendering the map.</dd>
</dl>
<p>An example info map:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">olwidget.widgets</span> <span class="kn">import</span> <span class="n">InfoMap</span>

<span class="nb">map</span> <span class="o">=</span> <span class="n">InfoMap</span><span class="p">([</span>
    <span class="p">[</span><span class="n">mymodel</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="s">&quot;&lt;p&gt;This is where I had my first kiss.&lt;/p&gt;&quot;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">othermodel</span><span class="o">.</span><span class="n">polygon</span><span class="p">,</span> <span class="s">&quot;&lt;p&gt;This is my home town.&lt;/p&gt;&quot;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">othermodel</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="p">{</span>
        <span class="s">&#39;html&#39;</span><span class="p">:</span> <span class="s">&quot;&lt;p&gt;Special style for this point.&lt;/p&gt;&quot;</span><span class="p">,</span>
        <span class="s">&#39;style&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s">&#39;fill_color&#39;</span><span class="p">:</span> <span class="s">&#39;#00FF00&#39;</span><span class="p">},</span>
    <span class="p">}],</span>
    <span class="o">...</span>
<span class="p">])</span>
</pre></div>
</div>
<p>In a template:</p>
<div class="highlight-django"><div class="highlight"><pre><span class="x">&lt;head&gt; </span><span class="cp">{{</span> <span class="nv">map.media</span> <span class="cp">}}</span><span class="x"> &lt;/head&gt;</span>
<span class="x">&lt;body&gt;... </span><span class="cp">{{</span> <span class="nv">map</span> <span class="cp">}}</span><span class="x"> ...&lt;/body&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="map-editablelayer-and-infolayer">
<span id="multiwidget"></span><h3>Map, EditableLayer, and InfoLayer<a class="headerlink" href="#map-editablelayer-and-infolayer" title="Permalink to this headline">¶</a></h3>
<p>Use these widgets together to display multi-layer maps outside of forms.</p>
<p><strong>Map</strong> constructor:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">olwidget</span><span class="o">.</span><span class="n">widgets</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">vector_layers</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">template</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">layer_names</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">vector_layers</span></tt></dt>
<dd>A list or tuple of layer instances (<tt class="docutils literal"><span class="pre">EditableLayer</span></tt> or <tt class="docutils literal"><span class="pre">InfoLayer</span></tt>) to
display on the map.</dd>
<dt><tt class="docutils literal"><span class="pre">options</span></tt></dt>
<dd>Optional global <a class="reference internal" href="#options">options</a> for the map.</dd>
<dt><tt class="docutils literal"><span class="pre">template</span></tt></dt>
<dd>An optional template to use to render the map.</dd>
<dt><tt class="docutils literal"><span class="pre">layer_names</span></tt></dt>
<dd>An optional list of names to use for the layers&#8217; POST data.</dd>
</dl>
<p><strong>EditableLayer</strong> constructor:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">olwidget</span><span class="o">.</span><span class="n">widgets</span><span class="o">.</span><span class="n">EditableLayer</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">template</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">options</span></tt></dt>
<dd>Optional <a class="reference internal" href="#options">options</a> for the layer.</dd>
<dt><tt class="docutils literal"><span class="pre">template</span></tt></dt>
<dd>An optional template to use to render this layer&#8217;s javascript.</dd>
</dl>
<p id="infolayer"><strong>InfoLayer</strong> constructor:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">olwidget</span><span class="o">.</span><span class="n">widgets</span><span class="o">.</span><span class="n">InfoLayer</span><span class="p">(</span><span class="n">info</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">template</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">info</span></tt></dt>
<dd>A list of [<tt class="docutils literal"><span class="pre">geometry</span></tt>, <tt class="docutils literal"><span class="pre">html</span></tt>] pairs which specify geometries and the
html contents of popups when those geometries are clicked.  <tt class="docutils literal"><span class="pre">html</span></tt> can
also be a dict such as <tt class="docutils literal"><span class="pre">{</span> <span class="pre">html:</span> <span class="pre">&quot;...&quot;,</span> <span class="pre">style:</span> <span class="pre">{}}</span></tt>.  The <tt class="docutils literal"><span class="pre">style</span></tt>
parameter is used for individual styling of the geometry within the layer.</dd>
<dt><tt class="docutils literal"><span class="pre">options</span></tt></dt>
<dd>Optional <a class="reference internal" href="#options">options</a> for the layer</dd>
</dl>
<div class="section" id="examples">
<h4>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h4>
<p>An example of a widget with two info layers:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">mymap</span> <span class="o">=</span> <span class="n">Map</span><span class="p">([</span>
        <span class="n">InfoLayer</span><span class="p">([[</span><span class="s">&quot;POINT (0 0)&quot;</span><span class="p">,</span> <span class="s">&quot;the origin&quot;</span><span class="p">]],</span> <span class="p">{</span><span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="s">&#39;origin&#39;</span><span class="p">}),</span>
        <span class="n">InfoLayer</span><span class="p">([[</span><span class="s">&quot;POINT (1 0)&quot;</span><span class="p">,</span> <span class="s">&quot;one degree off&quot;</span><span class="p">]],</span> <span class="p">{</span><span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="s">&#39;a bit off&#39;</span><span class="p">}),</span>
    <span class="p">],</span> <span class="p">{</span> <span class="n">overlay_style</span><span class="p">:</span> <span class="p">{</span><span class="s">&#39;fill_color&#39;</span><span class="p">:</span> <span class="s">&#39;#ffffff&#39;</span><span class="p">}</span> <span class="p">})</span>
</pre></div>
</div>
<p>In a template:</p>
<div class="highlight-django"><div class="highlight"><pre><span class="x">&lt;head&gt; ... </span><span class="cp">{{</span> <span class="nv">mymap.media</span> <span class="cp">}}</span><span class="x"> ... &lt;/head&gt;</span>
<span class="x">&lt;body&gt; ...    </span><span class="cp">{{</span> <span class="nv">mymap</span> <span class="cp">}}</span><span class="x">    ... &lt;/body&gt;</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="modelforms">
<span id="mapmodelform"></span><h2>ModelForms<a class="headerlink" href="#modelforms" title="Permalink to this headline">¶</a></h2>
<p><tt class="docutils literal"><span class="pre">MapModelForm</span></tt> is an extension of the built-in <a class="reference external" href="http://docs.djangoproject.com/en/dev/topics/forms/modelforms/">ModelForm</a> type which
adds
support for maps.  <tt class="docutils literal"><span class="pre">MapModelForm</span></tt> subclasses can possess two extra parameters
in their inner <tt class="docutils literal"><span class="pre">Meta</span></tt> class &#8211; an optional <tt class="docutils literal"><span class="pre">maps</span></tt> parameter which specifies
which fields to use with which maps, and an <tt class="docutils literal"><span class="pre">options</span></tt> parameter that specifies
global map <a class="reference internal" href="#options">options</a>.</p>
<p>The following is a simple example using a separate map for each field, and the
same appearance for all maps:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># models.py</span>
<span class="k">class</span> <span class="nc">MyModel</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">geom1</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">PointField</span><span class="p">()</span>
    <span class="n">geom2</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">LineStringField</span><span class="p">()</span>
    <span class="n">geom3</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">GeometryCollectionField</span><span class="p">()</span>


<span class="c"># forms.py</span>
<span class="kn">from</span> <span class="nn">olwidget.forms</span> <span class="kn">import</span> <span class="n">MapModelForm</span>
<span class="kn">from</span> <span class="nn">models</span> <span class="kn">import</span> <span class="n">MyModel</span>

<span class="k">class</span> <span class="nc">MyForm</span><span class="p">(</span><span class="n">MapModelForm</span><span class="p">):</span>
    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">MyModel</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&#39;layers&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;google.streets&#39;</span><span class="p">]</span> <span class="p">}</span>
</pre></div>
</div>
<p>To edit multiple fields in a single map, specify the <tt class="docutils literal"><span class="pre">maps</span></tt> parameter.  The
following will construct a form with 2 maps, the first editing <tt class="docutils literal"><span class="pre">geom1</span></tt> and
<tt class="docutils literal"><span class="pre">geom2</span></tt> fields and using Google Streets as a base layer, and the second
editing <tt class="docutils literal"><span class="pre">geom3</span></tt> and using default options:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">MyForm</span><span class="p">(</span><span class="n">MapModelForm</span><span class="p">):</span>
    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">MyModel</span>
        <span class="n">maps</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">((</span><span class="s">&#39;geom1&#39;</span><span class="p">,</span> <span class="s">&#39;geom2&#39;</span><span class="p">),</span> <span class="p">{</span> <span class="s">&#39;layers&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;google.streets&#39;</span><span class="p">]</span> <span class="p">}),</span>
            <span class="p">((</span><span class="s">&#39;geom3&#39;</span><span class="p">,</span> <span class="p">),</span> <span class="bp">None</span><span class="p">),</span>
        <span class="p">)</span>
</pre></div>
</div>
<p>To define options for particular fields, override the field definition.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">olwidget.forms</span> <span class="kn">import</span> <span class="n">MapModelForm</span>
<span class="kn">from</span> <span class="nn">olwidget.fields</span> <span class="kn">import</span> <span class="n">EditableLayerField</span>

<span class="k">class</span> <span class="nc">MyForm</span><span class="p">(</span><span class="n">MapModelForm</span><span class="p">):</span>
    <span class="n">geom1</span> <span class="o">=</span> <span class="n">EditableLayerField</span><span class="p">({</span><span class="s">&#39;overlay_style&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s">&#39;fill_color&#39;</span><span class="p">:</span> <span class="s">&quot;#ff0000&quot;</span> <span class="p">}})</span>
    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">MyModel</span>
</pre></div>
</div>
<p>Using the form in a template is the same as before.</p>
<div class="highlight-django"><div class="highlight"><pre><span class="x">&lt;head&gt; </span><span class="cp">{{</span> <span class="nv">form.media</span> <span class="cp">}}</span><span class="x"> &lt;/head&gt;</span>
<span class="x">&lt;body&gt;     </span><span class="cp">{{</span> <span class="nv">form</span> <span class="cp">}}</span><span class="x">   &lt;/body&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="fields">
<h2>Fields<a class="headerlink" href="#fields" title="Permalink to this headline">¶</a></h2>
<div class="section" id="mapfield-editablelayerfield-and-infolayerfield">
<h3>MapField, EditableLayerField, and InfoLayerField<a class="headerlink" href="#mapfield-editablelayerfield-and-infolayerfield" title="Permalink to this headline">¶</a></h3>
<p>Multi-layer maps are possible in forms using the <tt class="docutils literal"><span class="pre">MapField</span></tt> type, which is a
container field for any number of layer fields.  The layer fields are
<tt class="docutils literal"><span class="pre">EditableLayerField</span></tt> or <tt class="docutils literal"><span class="pre">InfoLayerField</span></tt> types, which allow editing or
display of vector data on the map.</p>
<p id="mapfield"><strong>MapField</strong> constructor:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">olwidget</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">MapField</span><span class="p">(</span><span class="n">fields</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">layer_names</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">template</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">fields</span></tt></dt>
<dd>An array of layer fields (either <tt class="docutils literal"><span class="pre">EditableLayerField</span></tt> or
<tt class="docutils literal"><span class="pre">InfoLayerField</span></tt>) which should appear on the map.</dd>
<dt><tt class="docutils literal"><span class="pre">options</span></tt></dt>
<dd>A dict of <a class="reference internal" href="#options">options</a> for the map.</dd>
<dt><tt class="docutils literal"><span class="pre">layer_names</span></tt></dt>
<dd>If provided, these will be used as the names for textareas in editable
fields and raw POST data.  However, <tt class="docutils literal"><span class="pre">form.cleaned_data</span></tt> will not use
these names, and will instead contain a list of the values in each layer
using the MapField&#8217;s declared name.</dd>
<dt><tt class="docutils literal"><span class="pre">template</span></tt></dt>
<dd><p class="first">The name of a custom template to render the map.  It will receive the context:</p>
<div class="last highlight-python"><pre>{'id': html id for the map,
 'layer_js': an array of javascript invocations from each layer,
 'layer_html': an array of html data from each layer,
 'map_opts': a JSON string of options for the map.
}</pre>
</div>
</dd>
</dl>
<p id="editablelayerfield"><strong>EditableLayerField</strong> constructor:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">olwidget</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">EditableLayerField</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">options</span></tt></dt>
<dd>A dict of <a class="reference internal" href="#options">options</a> for this layer, which override the containing <tt class="docutils literal"><span class="pre">Map</span></tt> defaults.</dd>
</dl>
<p id="infolayerfield"><strong>InfoLayerField</strong> constructor:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">olwidget</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">InfoLayerField</span><span class="p">(</span><span class="n">info</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">info</span></tt></dt>
<dd>A list of <tt class="docutils literal"><span class="pre">[geometry,</span> <span class="pre">html]</span></tt> pairs for clickable popups.  See <a class="reference internal" href="#infolayer">InfoLayer</a>
for more.</dd>
<dt><tt class="docutils literal"><span class="pre">options</span></tt></dt>
<dd>A dict of <a class="reference internal" href="#options">options</a> for this layer, which override the containing <tt class="docutils literal"><span class="pre">Map</span></tt>
defaults.</dd>
</dl>
<div class="section" id="example">
<h4>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h4>
<p>The following is an example that constructs a map widget with 3 fields, two of
them editable.  It uses both layer-specific options and global map options:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django</span> <span class="kn">import</span> <span class="n">forms</span>
<span class="kn">from</span> <span class="nn">olwidget.fields</span> <span class="kn">import</span> <span class="n">MapField</span><span class="p">,</span> <span class="n">EditableLayerField</span><span class="p">,</span> <span class="n">InfoLayerField</span>

<span class="k">class</span> <span class="nc">MyForm</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">Form</span><span class="p">):</span>
    <span class="n">country</span> <span class="o">=</span> <span class="n">MapField</span><span class="p">([</span>
            <span class="n">EditableLayerField</span><span class="p">({</span><span class="s">&#39;geometry&#39;</span><span class="p">:</span> <span class="s">&#39;polygon&#39;</span><span class="p">,</span> <span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="s">&#39;boundary&#39;</span><span class="p">}),</span>
            <span class="n">EditableLayerField</span><span class="p">({</span><span class="s">&#39;geometry&#39;</span><span class="p">:</span> <span class="s">&#39;point&#39;</span><span class="p">,</span> <span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="s">&#39;capital&#39;</span><span class="p">}),</span>
            <span class="n">InfoLayerField</span><span class="p">([[</span><span class="s">&quot;Point (0 0)&quot;</span><span class="p">,</span> <span class="s">&quot;Of interest&quot;</span><span class="p">]],</span> <span class="p">{</span><span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="s">&quot;Points of interest&quot;</span><span class="p">}),</span>
        <span class="p">],</span> <span class="p">{</span>
            <span class="s">&#39;overlay_style&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s">&#39;fill_color&#39;</span><span class="p">:</span> <span class="s">&#39;#00ff00&#39;</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">})</span>
</pre></div>
</div>
<p>In a template:</p>
<div class="highlight-django"><div class="highlight"><pre><span class="x">&lt;head&gt;... </span><span class="cp">{{</span> <span class="nv">form.media</span> <span class="cp">}}</span><span class="x"> ...&lt;/head&gt;</span>
<span class="x">&lt;body&gt;...    </span><span class="cp">{{</span> <span class="nv">form</span> <span class="cp">}}</span><span class="x">    ...&lt;/body&gt;</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="inside-admin">
<span id="geomodeladmin"></span><h2>Inside Admin<a class="headerlink" href="#inside-admin" title="Permalink to this headline">¶</a></h2>
<p><tt class="docutils literal"><span class="pre">olwidget</span></tt> has several advantages over the built-in geodjango admin map
implementation, including greater map customization, support for more geometry
types, the ability to edit multiple fields using one map, and the option to
include a map in admin changelist pages, on top of basic usability like
undo/redo and the ability to delete individual vertices.</p>
<p>To use <tt class="docutils literal"><span class="pre">olwidget</span></tt> for admin, simply use <tt class="docutils literal"><span class="pre">olwidget.admin.GeoModelAdmin</span></tt> or a
subclass of it as the ModelAdmin type for your model.</p>
<p>Example using <tt class="docutils literal"><span class="pre">olwidget</span></tt> in admin:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># admin.py</span>

<span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>
<span class="kn">from</span> <span class="nn">olwidget.admin</span> <span class="kn">import</span> <span class="n">GeoModelAdmin</span>
<span class="kn">from</span> <span class="nn">myapp</span> <span class="kn">import</span> <span class="n">Restaurant</span><span class="p">,</span> <span class="n">Owner</span>

<span class="c"># Use the default map</span>
<span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">Restaurant</span><span class="p">,</span> <span class="n">GeoModelAdmin</span><span class="p">)</span>

<span class="c"># Customize the map</span>
<span class="k">class</span> <span class="nc">MyGeoAdmin</span><span class="p">(</span><span class="n">GeoModelAdmin</span><span class="p">):</span>
    <span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">&#39;layers&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;google.streets&#39;</span><span class="p">],</span>
        <span class="s">&#39;default_lat&#39;</span><span class="p">:</span> <span class="mi">44</span><span class="p">,</span>
        <span class="s">&#39;default_lon&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">72</span><span class="p">,</span>
    <span class="p">}</span>

<span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">Owner</span><span class="p">,</span> <span class="n">MyGeoAdmin</span><span class="p">)</span>
</pre></div>
</div>
<p>To edit multiple fields using a single map, specify a <tt class="docutils literal"><span class="pre">maps</span></tt> parameter (with
the same syntax as that used in <a class="reference internal" href="#mapmodelform">MapModelForm</a>) with a list of all geometry
fields and which maps they should use and the options those maps should use,
like so:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># model:</span>
<span class="k">class</span> <span class="nc">Country</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">capital</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">PointField</span><span class="p">()</span>
    <span class="n">perimiter</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">PolygonField</span><span class="p">()</span>
    <span class="n">biggest_river</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">LineStringField</span><span class="p">()</span>

<span class="c"># admin.py</span>
<span class="k">class</span> <span class="nc">CountryAdmin</span><span class="p">(</span><span class="n">GeoModelAdmin</span><span class="p">):</span>
    <span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">default_lat</span><span class="p">:</span> <span class="o">-</span><span class="mi">72</span><span class="p">,</span>
        <span class="n">default_lon</span><span class="p">:</span> <span class="mi">43</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">maps</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">((</span><span class="s">&#39;capital&#39;</span><span class="p">,</span> <span class="s">&#39;perimiter&#39;</span><span class="p">),</span> <span class="p">{</span> <span class="s">&#39;layers&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;google.streets&#39;</span><span class="p">]</span> <span class="p">}),</span>
        <span class="p">((</span><span class="s">&#39;biggest_river&#39;</span><span class="p">,),</span> <span class="p">{</span><span class="s">&#39;overlay_style&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s">&#39;stroke_color&#39;</span><span class="p">:</span> <span class="s">&quot;#0000ff&quot;</span><span class="p">}}),</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>This will tell GeoModelAdmin to construct 2 maps, the first editing <tt class="docutils literal"><span class="pre">capital</span></tt>
and <tt class="docutils literal"><span class="pre">perimiter</span></tt> fields, and the second editing <tt class="docutils literal"><span class="pre">biggest_river</span></tt>, with
specific options for each map.  Both maps will share the global <tt class="docutils literal"><span class="pre">options</span></tt>
parameter, but can override it by specifying options.</p>
<div class="section" id="changelist-maps">
<h3>Changelist maps<a class="headerlink" href="#changelist-maps" title="Permalink to this headline">¶</a></h3>
<p>To show a clickable map on the admin changelist page, use the <tt class="docutils literal"><span class="pre">list_map</span></tt>
property to specify which fields to display in the changelist map:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># an example model:</span>

<span class="k">class</span> <span class="nc">Tree</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">location</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">PointField</span><span class="p">()</span>
    <span class="n">root_spread</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">PolygonField</span><span class="p">()</span>

<span class="c"># admin.py</span>

<span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>
<span class="kn">from</span> <span class="nn">olwidget.admin</span> <span class="kn">import</span> <span class="n">GeoModelAdmin</span>
<span class="kn">from</span> <span class="nn">myapp</span> <span class="kn">import</span> <span class="n">Tree</span>

<span class="k">class</span> <span class="nc">TreeGeoAdmin</span><span class="p">(</span><span class="n">GeoModelAdmin</span><span class="p">):</span>
    <span class="n">list_map</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;location&#39;</span><span class="p">]</span>

<span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">Tree</span><span class="p">,</span> <span class="n">TreeGeoAdmin</span><span class="p">)</span>
</pre></div>
</div>
<p>Options can be set for the changelist map using the <tt class="docutils literal"><span class="pre">list_map_options</span></tt>
property:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">TreeGeoAdmin</span><span class="p">(</span><span class="n">GeoModelAdmin</span><span class="p">):</span>
    <span class="n">list_map</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;location&#39;</span><span class="p">]</span>
    <span class="n">list_map_options</span> <span class="o">=</span> <span class="p">{</span>
        <span class="c"># group nearby points into clusters</span>
        <span class="s">&#39;cluster&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
        <span class="s">&#39;cluster_display&#39;</span><span class="p">:</span> <span class="s">&#39;list&#39;</span><span class="p">,</span>
    <span class="p">}</span>
</pre></div>
</div>
<p>This results in a map like this:</p>
<img alt="_images/changelist_map.png" src="_images/changelist_map.png" />
</div>
</div>
<div class="section" id="options">
<span id="id1"></span><h2>Options<a class="headerlink" href="#options" title="Permalink to this headline">¶</a></h2>
<p>Maps are both important user interface elements, and powerful persuasive data
displays.  Consequently, it is necessary to support a high degree of
customization around the appearance of a map.  <tt class="docutils literal"><span class="pre">olwidget</span></tt> does this primarily
through the use of OpenLayers&#8217; style framework.  All of <tt class="docutils literal"><span class="pre">olwidget</span></tt>&#8216;s types accept
an optional <tt class="docutils literal"><span class="pre">options</span></tt> dict which controls the appearance of the map and
layers.</p>
<p>Layers inherit their styles from both their default parameters, and from those
specified for a map:</p>
<div class="highlight-python"><pre>default layer options &lt; map options &lt; layer options</pre>
</div>
<p>By contrast, maps only inherit from their default options, and not from
layers:</p>
<div class="highlight-python"><pre>default map options &lt; map options</pre>
</div>
<p>This allows the map to hold defaults for all layers, but let the layers
override them.  The following is a list of all available options.  Some are
specific to map display, and others specific to layer display.</p>
<div class="section" id="general-map-display">
<h3>General map display<a class="headerlink" href="#general-map-display" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">layers</span></tt> (list; default <tt class="docutils literal"><span class="pre">['osm.mapnik']</span></tt>)</dt>
<dd><p class="first">A list of map base layers to include.  Choices include:</p>
<dl class="docutils">
<dt>Open Street Maps</dt>
<dd><tt class="docutils literal"><span class="pre">'osm.mapnik'</span></tt>, <tt class="docutils literal"><span class="pre">'osm.osmarender'</span></tt></dd>
<dt>Google</dt>
<dd><tt class="docutils literal"><span class="pre">'google.streets'</span></tt>, <tt class="docutils literal"><span class="pre">'google.physical'</span></tt>, <tt class="docutils literal"><span class="pre">'google.satellite'</span></tt>, <tt class="docutils literal"><span class="pre">'google.hybrid'</span></tt>,</dd>
<dt>Microsoft VirtualEarth</dt>
<dd><tt class="docutils literal"><span class="pre">'ve.road'</span></tt>, <tt class="docutils literal"><span class="pre">'ve.shaded'</span></tt>, <tt class="docutils literal"><span class="pre">'ve.aerial'</span></tt>, <tt class="docutils literal"><span class="pre">'ve.hybrid'</span></tt>,</dd>
<dt>WMS</dt>
<dd><tt class="docutils literal"><span class="pre">'wms.map'</span></tt>, <tt class="docutils literal"><span class="pre">'wms.nasa'</span></tt>, <tt class="docutils literal"><span class="pre">'wms.blank'</span></tt> (blank map)</dd>
<dt>Yahoo</dt>
<dd><tt class="docutils literal"><span class="pre">'yahoo.map'</span></tt></dd>
<dt>CloudMade</dt>
<dd><tt class="docutils literal"><span class="pre">'cloudmade.&lt;num&gt;'</span></tt> (where <tt class="docutils literal"><span class="pre">&lt;num&gt;</span></tt> is the number for a cloudmade
style).</dd>
</dl>
<p class="last">Remember to include <tt class="docutils literal"><span class="pre">GOOGLE_API_KEY</span></tt>, <tt class="docutils literal"><span class="pre">YAHOO_APP_ID</span></tt>, or
<tt class="docutils literal"><span class="pre">CLOUDMADE_API_KEY</span></tt> in your <tt class="docutils literal"><span class="pre">settings.py</span></tt> if you use any of those
layers.</p>
</dd>
<dt><tt class="docutils literal"><span class="pre">default_lat</span></tt> (float; default 0)</dt>
<dd>Latitude for the center point of the map.</dd>
<dt><tt class="docutils literal"><span class="pre">default_lon</span></tt> (float; default 0)</dt>
<dd>Longitude for the center point of the map.</dd>
<dt><tt class="docutils literal"><span class="pre">default_zoom</span></tt> (int; default <tt class="docutils literal"><span class="pre">4</span></tt>)</dt>
<dd>The starting zoom level to use on the map.</dd>
<dt><tt class="docutils literal"><span class="pre">zoom_to_data_extent</span></tt> (<tt class="xref docutils literal"><span class="pre">True</span></tt>/<tt class="xref docutils literal"><span class="pre">False</span></tt>; default <tt class="xref docutils literal"><span class="pre">True</span></tt>)</dt>
<dd>If <tt class="xref docutils literal"><span class="pre">True</span></tt>, the map will zoom to the extent of its vector data instead of
<tt class="docutils literal"><span class="pre">default_zoom</span></tt>, <tt class="docutils literal"><span class="pre">default_lat</span></tt>, and <tt class="docutils literal"><span class="pre">default_lon</span></tt>.  If no vector data
is present, the map will use the defaults.</dd>
<dt><tt class="docutils literal"><span class="pre">map_div_class</span></tt> (string; default <tt class="docutils literal"><span class="pre">''</span></tt>)</dt>
<dd>A CSS class name to add to the div which is created to contain the map.</dd>
<dt><tt class="docutils literal"><span class="pre">map_div_style</span></tt> (dict, default <tt class="docutils literal"><span class="pre">{width:</span> <span class="pre">'600px',</span> <span class="pre">height:</span> <span class="pre">'400px'}</span></tt>)</dt>
<dd>A set of CSS style definitions to apply to the div which is created to
contain the map.</dd>
<dt><tt class="docutils literal"><span class="pre">map_options</span></tt> (dict)</dt>
<dd><p class="first">A dict containing options for the OpenLayers Map constructor.
Properties may include:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">units</span></tt>: (string) default <tt class="docutils literal"><span class="pre">'m'</span></tt> (meters)</li>
<li><tt class="docutils literal"><span class="pre">projection</span></tt>: (string) default <tt class="docutils literal"><span class="pre">&quot;EPSG:900913&quot;</span></tt> (the projection used
by Google, OSM, Yahoo, and VirtualEarth).</li>
<li><tt class="docutils literal"><span class="pre">display_projection</span></tt>: (string) default <tt class="docutils literal"><span class="pre">&quot;EPSG:4326&quot;</span></tt> (the latitude
and longitude we&#8217;re all familiar with).</li>
<li><tt class="docutils literal"><span class="pre">max_resolution</span></tt>: (float) default <tt class="docutils literal"><span class="pre">156543.0339</span></tt>.  Value should be
expressed in the projection specified in <tt class="docutils literal"><span class="pre">projection</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">max_extent</span></tt>: default <tt class="docutils literal"><span class="pre">[-20037508.34,</span> <span class="pre">-20037508.34,</span> <span class="pre">20037508.34,</span>
<span class="pre">20037508.34]</span></tt>.  Values should be expressed in the projection specified
in <tt class="docutils literal"><span class="pre">projection</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">controls</span></tt>: (array of strings) default <tt class="docutils literal"><span class="pre">['LayerSwitcher',</span>
<span class="pre">'Navigation',</span> <span class="pre">'PanZoom',</span> <span class="pre">'Attribution']</span></tt>
The strings should be <a class="reference external" href="http://dev.openlayers.org/releases/OpenLayers-2.8/doc/apidocs/files/OpenLayers/Control-js.html">class names for map controls</a>,
which will be instantiated without arguments.</li>
</ul>
<p class="last">Any additional parameters available to the <a class="reference external" href="http://dev.openlayers.org/docs/files/OpenLayers/Map-js.html#OpenLayers.Map.Constructor">OpenLayers.Map.Constructor</a>
may be included, and will be passed directly.</p>
</dd>
<dt><tt class="docutils literal"><span class="pre">popups_outside</span></tt> (boolean; default <tt class="docutils literal"><span class="pre">false</span></tt>)</dt>
<dd>If false, popups are contained within the map&#8217;s viewport.  If true, popups
may expand outside the map&#8217;s viewport.</dd>
<dt><tt class="docutils literal"><span class="pre">popup_direction</span></tt> (string; default <tt class="docutils literal"><span class="pre">auto</span></tt>)</dt>
<dd><p class="first">The direction from the clicked geometry that a popup will extend.  This may
be one of:</p>
<ul class="last simple">
<li><tt class="docutils literal"><span class="pre">tr</span></tt> &#8211; top right</li>
<li><tt class="docutils literal"><span class="pre">tl</span></tt> &#8211; top left</li>
<li><tt class="docutils literal"><span class="pre">br</span></tt> &#8211; bottom right</li>
<li><tt class="docutils literal"><span class="pre">bl</span></tt> &#8211; bottom left</li>
<li><tt class="docutils literal"><span class="pre">auto</span></tt> &#8211; automatically choose direction.</li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="layer-options">
<h3>Layer options<a class="headerlink" href="#layer-options" title="Permalink to this headline">¶</a></h3>
<p>Layer options can also be specified at the map level.  Any options passed to a
layer override the corresponding options from the map.</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">name</span></tt> (string; defaults to <tt class="docutils literal"><span class="pre">&quot;data&quot;</span></tt>)</dt>
<dd>The name of the overlay layer for the map (shown in the layer switcher).</dd>
<dt><tt class="docutils literal"><span class="pre">overlay_style</span></tt> (dict)</dt>
<dd><p class="first">A dict of style definitions for the geometry overlays.  For more on overlay
styling, consult the OpenLayers <a class="reference external" href="http://docs.openlayers.org/library/feature_styling.html">styling documentation</a>.  Options
include:</p>
<ul class="last simple">
<li><tt class="docutils literal"><span class="pre">fill_color</span></tt>: (string) HTML color value</li>
<li><tt class="docutils literal"><span class="pre">fill_opacity</span></tt>: (float) opacity of overlays from 0 to 1</li>
<li><tt class="docutils literal"><span class="pre">stroke_color</span></tt>: (string) HTML color value</li>
<li><tt class="docutils literal"><span class="pre">stroke_opacity</span></tt>: (float) opacity of strokes from 0 to 1</li>
<li><tt class="docutils literal"><span class="pre">stroke_width</span></tt>: (int) width in pixels of lines and borders</li>
<li><tt class="docutils literal"><span class="pre">stroke_linecap</span></tt>: (string) Default is <tt class="docutils literal"><span class="pre">round</span></tt>. Options are <tt class="docutils literal"><span class="pre">butt</span></tt>,
<tt class="docutils literal"><span class="pre">round</span></tt>, <tt class="docutils literal"><span class="pre">square</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">stroke_dash_style</span></tt>: (string) Default is <tt class="docutils literal"><span class="pre">solid</span></tt>. Options are
<tt class="docutils literal"><span class="pre">dot</span></tt>, <tt class="docutils literal"><span class="pre">dash</span></tt>, <tt class="docutils literal"><span class="pre">dashdot</span></tt>, <tt class="docutils literal"><span class="pre">longdash</span></tt>, <tt class="docutils literal"><span class="pre">longdashdot</span></tt>, <tt class="docutils literal"><span class="pre">solid</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">cursor</span></tt>: (string) Cursor to be used when mouse is over a feature.
Default is an empty string.</li>
<li><tt class="docutils literal"><span class="pre">point_radius</span></tt>: (integer) radius of points in pixels</li>
<li><tt class="docutils literal"><span class="pre">external_graphic</span></tt>: (string) URL of external graphic to use in place of
vector overlays</li>
<li><tt class="docutils literal"><span class="pre">graphic_height</span></tt>: (int) height in pixels of external graphic</li>
<li><tt class="docutils literal"><span class="pre">graphic_width</span></tt>: (int) width in pixels of external graphic</li>
<li><tt class="docutils literal"><span class="pre">graphic_x_offset</span></tt>: (int) x offset in pixels of external graphic</li>
<li><tt class="docutils literal"><span class="pre">graphic_y_offset</span></tt>: (int) y offset in pixels of external graphic</li>
<li><tt class="docutils literal"><span class="pre">graphic_opacity</span></tt>: (float) opacity of external graphic from 0 to 1.</li>
<li><tt class="docutils literal"><span class="pre">graphic_name</span></tt>: (string) Name of symbol to be used for a point mark.</li>
<li><tt class="docutils literal"><span class="pre">display</span></tt>: (string) Can be set to <tt class="docutils literal"><span class="pre">none</span></tt> to hide features from
rendering.</li>
</ul>
</dd>
<dt><tt class="docutils literal"><span class="pre">overlay_style_context</span></tt> (dict)</dt>
<dd>A dict containing javascript functions which expand symbolizers in
<tt class="docutils literal"><span class="pre">overlay_style</span></tt>.  See
<a class="reference external" href="examples/info_cluster_per_point_style.html">this example</a> for a
javascript usage example.  Note that javascript functions can&#8217;t be
specified directly from python in an <tt class="docutils literal"><span class="pre">options</span></tt> dict, as the serializer
will interpret them as strings.  Instead, they must be specified manually
in a template.</dd>
</dl>
<div class="section" id="options-for-editable-layers">
<h4>Options for editable layers<a class="headerlink" href="#options-for-editable-layers" title="Permalink to this headline">¶</a></h4>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">geometry</span></tt> (Array or string; default <tt class="docutils literal"><span class="pre">'point'</span></tt>)</dt>
<dd>The geometry to use while editing this layer.  Choices are <tt class="docutils literal"><span class="pre">'point'</span></tt>,
<tt class="docutils literal"><span class="pre">'linestring'</span></tt>, and <tt class="docutils literal"><span class="pre">'polygon'</span></tt>.  To allow multiple geometries, use an
array such as <tt class="docutils literal"><span class="pre">['point',</span> <span class="pre">'linestring',</span> <span class="pre">'polygon']</span></tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">isCollection</span></tt> (boolean, default <tt class="docutils literal"><span class="pre">false</span></tt>)</dt>
<dd>If true, allows multiple points/lines/polygons.</dd>
<dt><tt class="docutils literal"><span class="pre">hide_textarea</span></tt> (boolean; default <tt class="docutils literal"><span class="pre">true</span></tt>)</dt>
<dd>Hides the textarea if true.  Ignored if the layer does not have an
associated textarea.</dd>
<dt><tt class="docutils literal"><span class="pre">editable</span></tt> (boolean, default <tt class="docutils literal"><span class="pre">true</span></tt>)</dt>
<dd>If true, allows editing of geometries.  Ignored by <tt class="docutils literal"><span class="pre">InfoLayer</span></tt> types.</dd>
</dl>
</div>
<div class="section" id="options-for-info-layers">
<h4>Options for info layers<a class="headerlink" href="#options-for-info-layers" title="Permalink to this headline">¶</a></h4>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">cluster</span></tt> (boolean; default <tt class="docutils literal"><span class="pre">false</span></tt>)</dt>
<dd>If true, points will be clustered using the
<a class="reference external" href="http://dev.openlayers.org/releases/OpenLayers-2.7/doc/apidocs/files/OpenLayers/Strategy/Cluster-js.html">OpenLayers.Strategy.ClusterStrategy</a>.
(see <a class="reference external" href="examples/info_cluster.html">this cluster example</a>).</dd>
<dt><tt class="docutils literal"><span class="pre">cluster_display</span></tt> (string; default <tt class="docutils literal"><span class="pre">'paginate'</span></tt>)</dt>
<dd><p class="first">The way HTML from clustered points is handled.</p>
<ul class="last simple">
<li><tt class="docutils literal"><span class="pre">'list'</span></tt> &#8211; constructs an unordered list of contents</li>
<li><tt class="docutils literal"><span class="pre">'paginate'</span></tt> &#8211; adds a pagination control to the popup to click through
the different points&#8217; HTML.</li>
</ul>
</dd>
</dl>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference external" href="#">django-olwidget documentation</a><ul>
<li><a class="reference external" href="#introduction">Introduction</a></li>
<li><a class="reference external" href="#installation">Installation</a></li>
<li><a class="reference external" href="#widgets">Widgets</a><ul>
<li><a class="reference external" href="#editablemap">EditableMap</a></li>
<li><a class="reference external" href="#infomap">InfoMap</a></li>
<li><a class="reference external" href="#map-editablelayer-and-infolayer">Map, EditableLayer, and InfoLayer</a><ul>
<li><a class="reference external" href="#examples">Examples</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference external" href="#modelforms">ModelForms</a></li>
<li><a class="reference external" href="#fields">Fields</a><ul>
<li><a class="reference external" href="#mapfield-editablelayerfield-and-infolayerfield">MapField, EditableLayerField, and InfoLayerField</a><ul>
<li><a class="reference external" href="#example">Example</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference external" href="#inside-admin">Inside Admin</a><ul>
<li><a class="reference external" href="#changelist-maps">Changelist maps</a></li>
</ul>
</li>
<li><a class="reference external" href="#options">Options</a><ul>
<li><a class="reference external" href="#general-map-display">General map display</a></li>
<li><a class="reference external" href="#layer-options">Layer options</a><ul>
<li><a class="reference external" href="#options-for-editable-layers">Options for editable layers</a></li>
<li><a class="reference external" href="#options-for-info-layers">Options for info layers</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="index.html"
                                  title="previous chapter">Welcome to olwidget&#8217;s documentation!</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="olwidget.js.html"
                                  title="next chapter">olwidget.js documentation</a></p>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="olwidget.js.html" title="olwidget.js documentation"
             >next</a></li>
        <li class="right" >
          <a href="index.html" title="Welcome to olwidget’s documentation!"
             >previous</a> |</li>
        <li><a href="index.html">olwidget v0.4 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      &copy; Copyright 2010, Charlie DeTar.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.6.
    </div>
  </body>
</html>