<h1 tal:replace="structure here/manage_page_header">Header</h1>

<h2 tal:define="form_title string:ZODB Groups"
    tal:replace="structure here/manage_tabs"> TABS </h2>

<tal:block tal:define="adding request/adding | nothing;
                       updating request/service_id | nothing;
                       browsing python:not adding and not updating;">

<div tal:condition="browsing">
	<h3> Current Services <a href="?adding=1">(Add a service)</a></h3>
	
	<form action="manage_removeServices" method="POST">
	<table tal:define="services here/getAllServices">
		<tr>
			<th></th>
			<th>ID</th>
			<th>Name</th>
			<th>Description</th>
			<th>Enabled</th>
			<th>SSO Enabled</th>
			<th>Anonymous Access</th>
			<th>Allowed To Proxy</th>
		</tr>
		
		<tal:services repeat="service services">
		<tr tal:define="id service/id;
						name service/name;
						desc service/description;
						enabled service/enabled;
						ssoEnabled service/ssoEnabled;
						anonymousAccess service/anonymousAccess;
						allowedToProxy service/allowedToProxy;"
			tal:attributes="class python:repeat['service'].odd() and 'odd' or 'even'">
			<td>
				<input type="checkbox" name="service_ids:list" tal:attributes="value id" />
			</td>
			<td class="form-text">
				<a href="?service_id=foo"
				   tal:attributes="href string:?service_id=${id}"
				   tal:content="id">service id</a>
			</td>
			<td tal:content="name">service name</td>
			<td tal:content="desc">service description</td>
			<td>
				<input type="checkbox" tal:attributes="checked enabled" />
			</td>
			<td>
				<input type="checkbox" tal:attributes="checked ssoEnabled" />
			</td>
			<td>
				<input type="checkbox" tal:attributes="checked anonymousAccess" />
			</td>
			<td>
				<input type="checkbox" tal:attributes="checked allowedToProxy" />
			</td>
	 	</tr>
		</tal:services>
		
	 	<tr>
	  		<td />
			<td colspan="7">
				<input type="submit" value=" Remove Services " />
			</td>
	 	</tr>
	</table>
	</form>
</div>

<div tal:condition="adding">

	<h3> Add a Service </h3>
	
	<form action="manage_addService" method="POST">
	<table>
		<tr>
			<td>ID</td>
			<td style="color:red">*</td>
			<td><input type="text" name="id" size="20" /></td>
		</tr>
		<tr>
			<td>Name</td>
			<td></td>
			<td><input type="text" name="name" size="20" /></td>
		</tr>
		<tr>
			<td>Description</td>
			<td></td>
			<td><input type="text" name="description" size="20" /></td>
		</tr>
		<tr>
			<td>Enabled</td>
			<td></td>
			<td>
				<input type="checkbox" name="enabled:boolean" value="True" checked />
			</td>
		</tr>
		<tr>
			<td>SSO Enabled</td>
			<td></td>
			<td>
				<input type="checkbox" name="ssoEnabled:boolean" value="True" checked />
			</td>
		</tr>
		<tr>
			<td>Anonymous Access</td>
			<td></td>
			<td>
				<input type="checkbox" name="anonymousAccess:boolean" value="False" />
			</td>
		</tr>
		<tr>
			<td>Allowed To Proxy</td>
			<td></td>
			<td>
				<input type="checkbox" name="allowedToProxy:boolean" value="True" checked />
			</td>
		</tr>
		<tr>
			<td>
				<input type="submit" value=" Add Service " />
			</td>
			<td />
	 	</tr>
	</table>
	</form>
</div>

<div tal:define="service_id request/service_id | nothing" tal:condition="updating">
	<h3>
		Update Service: <span tal:replace="service_id">service id</span>
	</h3>

	<form action="manage_editService" method="POST"
		tal:define="service python:here.findServiceById(service_id);
					id service/id;
					name service/name | nothing;
					description service/description | nothing;
					enabled service/enabled;
					ssoEnabled service/ssoEnabled;
					anonymousAccess service/anonymousAccess;
					allowedToProxy service/allowedToProxy;
					">
	<table>
		<tr>
			<td>ID</td>
			<td>
				<input type="hidden" name="id" tal:attributes="value id" />
				<span tal:content="id">service id</span>
			</td>
		</tr>
		<tr>
			<td>Name</td>
			<td><input type="text" name="name" tal:attributes="value name" /></td>
		</tr>
		<tr>
			<td>Description</td>
			<td>
				<textarea name="description" tal:content="description">
				</textarea>
			</td>
		</tr>
		<tr>
			<td>Enabled</td>
			<td>
				<input type="hidden" value="False" name="enabled:boolean:default"/>
				<input id="enabled" name="enabled:boolean" type="checkbox" value="True"
					tal:attributes="checked python:enabled and 'checked' or ''" />
			</td>
		</tr>
		<tr>
			<td>SSO Enabled</td>
			<td>
				<input type="hidden" value="False" name="ssoEnabled:boolean:default"/>
				<input id="ssoEnabled" name="ssoEnabled:boolean" type="checkbox" value="True"
					tal:attributes="checked python:ssoEnabled and 'checked' or ''" />
			</td>
		</tr>
		<tr>
			<td>Anonymous Access</td>
			<td>
				<input type="hidden" value="False" name="anonymousAccess:boolean:default"/>
				<input id="anonymousAccess" name="anonymousAccess:boolean" type="checkbox" value="True"
					tal:attributes="checked python:anonymousAccess and 'checked' or ''" />
			</td>
		</tr>
		<tr>
			<td>Allowed To Proxy</td>
			<td>
				<input type="hidden" value="False" name="allowedToProxy:boolean:default"/>
				<input id="allowedToProxy" name="allowedToProxy:boolean" type="checkbox" value="True"
					tal:attributes="checked python:allowedToProxy and 'checked' or ''" />
			</td>
		</tr>
		<tr>
			<td>
				<input type="submit" value=" Edit Service " />
			</td>
			<td />
	 	</tr>
	</table>
	</form>
</div>

</tal:block>

<h1 tal:replace="structure here/manage_page_footer">Footer</h1>
