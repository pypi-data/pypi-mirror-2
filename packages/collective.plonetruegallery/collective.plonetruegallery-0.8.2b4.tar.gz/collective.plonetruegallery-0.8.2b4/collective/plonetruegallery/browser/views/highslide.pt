<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="collective.plonetruegallery">

<metal:css fill-slot="style_slot">
  <link rel="stylesheet" type="text/css" 
      href="++resource++plonetruegallery.resources/highslide/highslide.css" />	
</metal:css>
<metal:js fill-slot="javascript_head_slot">

	<script type="text/javascript" 
	  src="++resource++plonetruegallery.resources/highslide/highslide-with-gallery.js">\
	</script>

  <!--[if lt IE 7]>
  <link rel="stylesheet" type="text/css" 
      href="++resource++plonetruegallery.resources/highslide/highslide-ie6.css" />
  <![endif]-->
  	  
<script type="text/javascript" tal:content="displayer/javascript">
</script>
<script type="text/javascript">
(function($){
	$(document).ready(function() {
		var images = $('a.highslide');
		if(images.length <= start_image_index){
		    start_image_index = 0;
		}
		if(auto_start){
		  $(images[start_image_index]).trigger('click');
		}
	});
})(jQuery);
</script>
</metal:js>

<body>
<metal:main fill-slot="main">
<tal:main-macro metal:define-macro="main">
	<h1 tal:content="context/Title" />

 	<div class="noimages"
    tal:condition="python: view.adapter.number_of_images == 0">
    <p i18n:translate="label_no_images_in_gallery">
      There are no images in this gallery.
    </p>
 	</div>
	
	<div class="highslide-gallery plonetruegallery"
	    tal:condition="python: view.adapter.number_of_images > 0"
      tal:define="images adapter/cooked_images;
                  Batch python:modules['Products.CMFPlone'].Batch;
                  b_size settings/batch_size;
                  b_start displayer/b_start;
                  batch python:Batch(images, b_size, b_start, orphan=1);">

    <p>
      <span tal:repeat="image batch">
        <a
    		    class="highslide" rel="group" onclick="return hs.expand(this)"
    		    tal:attributes="
    		      title string:${image/title} - ${image/description};
              href image/image_url;">
          <img 
            tal:attributes="src image/thumb_url; 
                            alt string:${image/title} - ${image/description}" 
          />
    		</a>
          <span class="highslide-heading">
            <a href="image" tal:content="image/title" tal:attributes="href image/link">Image Title</a>
          </span>
      </span>
    </p>
	<div metal:use-macro="here/batch_macros/macros/navigation">
      Navigation
    </div>
	</div>
 		
  <tal:subgallery tal:replace="structure view/subgallery_template" />	

</tal:main-macro>
</metal:main>
</body>
</html>
