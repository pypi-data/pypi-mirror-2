<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
  <head>
    <title>py.test examples</title>
    <meta content="text/html;charset=ISO-8859-1" name="Content-Type"/>
    <link href="../style.css" media="screen" rel="stylesheet" type="text/css"/></head>
  <body>
    <div id="navspace">
      <div><a href="http://pylib.org"><img alt="py lib" height="57" id="pyimg" src="http://codespeak.net/img/pylib.png" width="77"/></a></div>
      <div id="menubar">
        <div>
          <div><a class="menu" href="../announce/release-1.3.4.html">1.3.4 ANN</a></div></div>
        <div>
          <div><a class="menu" href="../install.html">INSTALL</a></div></div>
        <div>
          <div><a class="menu" href="../contact.html">CONTACT</a></div></div>
        <div>
          <div><a class="menu" href="../changelog.html">CHANGELOG</a></div></div>
        <div>
          <div><a class="menu" href="../faq.html">FAQ</a></div></div>
        <div>
          <div>
            <h3>py.test:</h3>
            <div><a class="menu" href="index.html">Index</a></div>
            <div><a class="menu" href="quickstart.html">Quickstart</a></div>
            <div><a class="menu" href="features.html">Features</a></div>
            <div><a class="menu" href="funcargs.html">Funcargs</a></div>
            <div><a class="menu" href="plugin/index.html">Plugins</a></div>
            <div><a class="menu" href="customize.html">Customize</a></div>
            <div><a class="menu" href="talks.html">Tutorials</a></div><a class="menu" href="http://hudson.testrun.org">hudson-tests</a></div></div>
        <div>
          <div>
            <h3>supporting APIs:</h3>
            <div><a class="menu" href="../index.html">Index</a></div>
            <div><a class="menu" href="../path.html">py.path</a></div>
            <div><a class="menu" href="../code.html">py.code</a></div></div></div></div></div>
    <div id="contentspace">


<div class="section" id="learning-by-examples">
<h1>Learning by examples</h1>
<div class="section" id="adding-custom-options">
<h2>adding custom options</h2>
<p>py.test supports adding of standard <a class="reference external" href="http://docs.python.org/library/optparse.html">optparse</a> Options.
A plugin may implement the <tt class="docutils literal">addoption</tt> hook for registering
custom options:</p>
<pre class="literal-block">
def pytest_addoption(parser):
    parser.addoption(&quot;-M&quot;, &quot;--myopt&quot;, action=&quot;store&quot;,
        help=&quot;specify string to set myopt&quot;)

def pytest_configure(config):
    if config.option.myopt:
        # do action based on option value
        #
</pre>
</div>
</div>
<div class="section" id="working-examples">
<h1>Working Examples</h1>
<div class="section" id="managing-state-at-module-class-and-method-level">
<h2>managing state at module, class and method level</h2>
<p>Here is a working example for what goes on when you setup modules,
classes and methods:</p>
<pre class="literal-block">
# [[from py/documentation/example/pytest/test_setup_flow_example.py]]

def setup_module(module):
    module.TestStateFullThing.classcount = 0

class TestStateFullThing:
    def setup_class(cls):
        cls.classcount += 1

    def teardown_class(cls):
        cls.classcount -= 1

    def setup_method(self, method):
        self.id = eval(method.func_name[5:])

    def test_42(self):
        assert self.classcount == 1
        assert self.id == 42

    def test_23(self):
        assert self.classcount == 1
        assert self.id == 23

def teardown_module(module):
    assert module.TestStateFullThing.classcount == 0
</pre>
<p>For this example the control flow happens as follows:</p>
<pre class="literal-block">
import test_setup_flow_example
setup_module(test_setup_flow_example)
   setup_class(TestStateFullThing)
       instance = TestStateFullThing()
       setup_method(instance, instance.test_42)
          instance.test_42()
       setup_method(instance, instance.test_23)
          instance.test_23()
   teardown_class(TestStateFullThing)
teardown_module(test_setup_flow_example)
</pre>
<p>Note that <tt class="docutils literal">setup_class(TestStateFullThing)</tt> is called and not
<tt class="docutils literal">TestStateFullThing.setup_class()</tt> which would require you
to insert <tt class="docutils literal">setup_class = classmethod(setup_class)</tt> to make
your setup function callable. Did we mention that lazyness
is a virtue?</p>
</div>
</div>
</div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-7597274-3");
pageTracker._trackPageview();
} catch(err) {}</script>
</body></html>