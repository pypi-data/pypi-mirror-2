<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
  <head>
    <title>capturelog</title>
    <meta content="text/html;charset=ISO-8859-1" name="Content-Type"/>
    <link href="../../style.css" media="screen" rel="stylesheet" type="text/css"/></head>
  <body>
    <div id="navspace">
      <div><a href="http://pylib.org"><img alt="py lib" height="57" id="pyimg" src="http://codespeak.net/img/pylib.png" width="77"/></a></div>
      <div id="menubar">
        <div>
          <div><a class="menu" href="../../announce/release-1.3.0.html">1.3.0 ANN</a></div></div>
        <div>
          <div><a class="menu" href="../../install.html">INSTALL</a></div></div>
        <div>
          <div><a class="menu" href="../../contact.html">CONTACT</a></div></div>
        <div>
          <div><a class="menu" href="../../changelog.html">CHANGELOG</a></div></div>
        <div>
          <div><a class="menu" href="../../faq.html">FAQ</a></div></div>
        <div>
          <div>
            <h3>py.test:</h3>
            <div><a class="menu" href="../index.html">Index</a></div>
            <div><a class="menu" href="../quickstart.html">Quickstart</a></div>
            <div><a class="menu" href="../features.html">Features</a></div>
            <div><a class="menu" href="../funcargs.html">Funcargs</a></div>
            <div><a class="menu" href="index.html">Plugins</a></div>
            <div><a class="menu" href="../customize.html">Customize</a></div>
            <div><a class="menu" href="../talks.html">Tutorials</a></div><a class="menu" href="http://hudson.testrun.org">hudson-tests</a></div></div>
        <div>
          <div>
            <h3>supporting APIs:</h3>
            <div><a class="menu" href="../../index.html">Index</a></div>
            <div><a class="menu" href="../../path.html">py.path</a></div>
            <div><a class="menu" href="../../code.html">py.code</a></div></div></div></div></div>
    <div id="contentspace">
<div class="document" id="capture-output-of-logging-module">
<h1 class="title">capture output of logging module.</h1>

<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#installation" id="id1">Installation</a></li>
<li><a class="reference internal" href="#usage" id="id2">Usage</a></li>
<li><a class="reference internal" href="#command-line-options" id="id3">command line options</a></li>
</ul>
</div>
<div class="section" id="installation">
<h1><a class="toc-backref" href="#id1">Installation</a></h1>
<p>You can install the <a class="reference external" href="http://pypi.python.org/pypi/pytest-capturelog/">pytest-capturelog pypi</a> package
with pip:</p>
<pre class="literal-block">
pip install pytest-capturelog
</pre>
<p>or with easy install:</p>
<pre class="literal-block">
easy_install pytest-capturelog
</pre>
</div>
<div class="section" id="usage">
<h1><a class="toc-backref" href="#id2">Usage</a></h1>
<p>If the plugin is installed log messages are captured by default and for
each failed test will be shown in the same manner as captured stdout and
stderr.</p>
<p>Running without options:</p>
<pre class="literal-block">
py.test test_capturelog.py
</pre>
<p>Shows failed tests like so:</p>
<pre class="literal-block">
-------------------------- Captured log ---------------------------
test_capturelog.py          26 INFO     text going to logger
------------------------- Captured stdout -------------------------
text going to stdout
------------------------- Captured stderr -------------------------
text going to stderr
==================== 2 failed in 0.02 seconds =====================
</pre>
<p>By default each captured log message shows the module, line number,
log level and message.  Showing the exact module and line number is
useful for testing and debugging.  If desired the log format and date
format can be specified to anything that the logging module supports.</p>
<p>Running pytest specifying formatting options:</p>
<pre class="literal-block">
py.test --log-format=&quot;%(asctime)s %(levelname)s %(message)s&quot; --log-date-format=&quot;%Y-%m-%d %H:%M:%S&quot; test_capturelog.py
</pre>
<p>Shows failed tests like so:</p>
<pre class="literal-block">
-------------------------- Captured log ---------------------------
2010-04-10 14:48:44 INFO text going to logger
------------------------- Captured stdout -------------------------
text going to stdout
------------------------- Captured stderr -------------------------
text going to stderr
==================== 2 failed in 0.02 seconds =====================
</pre>
<p>Further it is possible to disable capturing of logs completely with:</p>
<pre class="literal-block">
py.test --nocapturelog test_capturelog.py
</pre>
<p>Shows failed tests in the normal manner as no logs were captured:</p>
<pre class="literal-block">
------------------------- Captured stdout -------------------------
text going to stdout
------------------------- Captured stderr -------------------------
text going to stderr
==================== 2 failed in 0.02 seconds =====================
</pre>
</div>
<div class="section" id="command-line-options">
<h1><a class="toc-backref" href="#id3">command line options</a></h1>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">--nocapturelog</span></tt></dt>
<dd>disable log capture</dd>
<dt><tt class="docutils literal"><span class="pre">--log-format=LOG_FORMAT</span></tt></dt>
<dd>log format as used by the logging module</dd>
<dt><tt class="docutils literal"><span class="pre">--log-date-format=LOG_DATE_FORMAT</span></tt></dt>
<dd>log date format as used by the logging module</dd>
</dl>
</div>
</div>
</div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-7597274-3");
pageTracker._trackPageview();
} catch(err) {}</script>
</body></html>