<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
  <head>
    <title>hookspec</title>
    <meta content="text/html;charset=ISO-8859-1" name="Content-Type"/>
    <link href="../../style.css" media="screen" rel="stylesheet" type="text/css"/></head>
  <body>
    <div id="navspace">
      <div><a href="http://pylib.org"><img alt="py lib" height="57" id="pyimg" src="http://codespeak.net/img/pylib.png" width="77"/></a></div>
      <div id="menubar">
        <div>
          <div><a class="menu" href="../../announce/release-1.3.0.html">1.3.0 ANN</a></div></div>
        <div>
          <div><a class="menu" href="../../install.html">INSTALL</a></div></div>
        <div>
          <div><a class="menu" href="../../contact.html">CONTACT</a></div></div>
        <div>
          <div><a class="menu" href="../../changelog.html">CHANGELOG</a></div></div>
        <div>
          <div><a class="menu" href="../../faq.html">FAQ</a></div></div>
        <div>
          <div>
            <h3>py.test:</h3>
            <div><a class="menu" href="../index.html">Index</a></div>
            <div><a class="menu" href="../quickstart.html">Quickstart</a></div>
            <div><a class="menu" href="../features.html">Features</a></div>
            <div><a class="menu" href="../funcargs.html">Funcargs</a></div>
            <div><a class="menu" href="index.html">Plugins</a></div>
            <div><a class="menu" href="../customize.html">Customize</a></div>
            <div><a class="menu" href="../talks.html">Tutorials</a></div><a class="menu" href="http://hudson.testrun.org">hudson-tests</a></div></div>
        <div>
          <div>
            <h3>supporting APIs:</h3>
            <div><a class="menu" href="../../index.html">Index</a></div>
            <div><a class="menu" href="../../path.html">py.path</a></div>
            <div><a class="menu" href="../../code.html">py.code</a></div></div></div></div></div>
    <div id="contentspace">


<div class="section" id="hook-specification-sourcecode">
<h1>hook specification sourcecode</h1>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;</span>
<span style="color: #BA2121; font-style: italic">hook specifications for py.test plugins</span>
<span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;</span>

<span style="color: #408080; font-style: italic"># -------------------------------------------------------------------------</span>
<span style="color: #408080; font-style: italic"># Command line and configuration</span>
<span style="color: #408080; font-style: italic"># -------------------------------------------------------------------------</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest_namespace</span>():
    <span style="color: #BA2121">&quot;return dict of name-&gt;object which will get stored at py.test. namespace&quot;</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest_addoption</span>(parser):
    <span style="color: #BA2121">&quot;add optparse-style options via parser.addoption.&quot;</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest_addhooks</span>(pluginmanager):
    <span style="color: #BA2121">&quot;add hooks via pluginmanager.registerhooks(module)&quot;</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest_configure</span>(config):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; called after command line options have been parsed.</span>
<span style="color: #BA2121; font-style: italic">        and all plugins and initial conftest files been loaded.</span>
<span style="color: #BA2121; font-style: italic">    &quot;&quot;&quot;</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest_unconfigure</span>(config):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; called before test process is exited.  &quot;&quot;&quot;</span>

<span style="color: #408080; font-style: italic"># -------------------------------------------------------------------------</span>
<span style="color: #408080; font-style: italic"># collection hooks</span>
<span style="color: #408080; font-style: italic"># -------------------------------------------------------------------------</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest_ignore_collect</span>(path, config):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; return true value to prevent considering this path for collection.</span>
<span style="color: #BA2121; font-style: italic">    This hook is consulted for all files and directories prior to considering</span>
<span style="color: #BA2121; font-style: italic">    collection hooks.</span>
<span style="color: #BA2121; font-style: italic">    &quot;&quot;&quot;</span>
pytest_ignore_collect<span style="color: #666666">.</span>firstresult <span style="color: #666666">=</span> <span style="color: #008000">True</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest_collect_directory</span>(path, parent):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; return Collection node or None for the given path. &quot;&quot;&quot;</span>
pytest_collect_directory<span style="color: #666666">.</span>firstresult <span style="color: #666666">=</span> <span style="color: #008000">True</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest_collect_file</span>(path, parent):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; return Collection node or None for the given path. &quot;&quot;&quot;</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest_collectstart</span>(collector):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; collector starts collecting. &quot;&quot;&quot;</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest_collectreport</span>(report):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; collector finished collecting. &quot;&quot;&quot;</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest_deselected</span>(items):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; called for test items deselected by keyword. &quot;&quot;&quot;</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest_make_collect_report</span>(collector):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; perform a collection and return a collection. &quot;&quot;&quot;</span>
pytest_make_collect_report<span style="color: #666666">.</span>firstresult <span style="color: #666666">=</span> <span style="color: #008000">True</span>

<span style="color: #408080; font-style: italic"># XXX rename to item_collected()?  meaning in distribution context?</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest_itemstart</span>(item, node<span style="color: #666666">=</span><span style="color: #008000">None</span>):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; test item gets collected. &quot;&quot;&quot;</span>

<span style="color: #408080; font-style: italic"># -------------------------------------------------------------------------</span>
<span style="color: #408080; font-style: italic"># Python test function related hooks</span>
<span style="color: #408080; font-style: italic"># -------------------------------------------------------------------------</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest_pycollect_makemodule</span>(path, parent):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; return a Module collector or None for the given path.</span>
<span style="color: #BA2121; font-style: italic">    This hook will be called for each matching test module path.</span>
<span style="color: #BA2121; font-style: italic">    The pytest_collect_file hook needs to be used if you want to</span>
<span style="color: #BA2121; font-style: italic">    create test modules for files that do not match as a test module.</span>
<span style="color: #BA2121; font-style: italic">    &quot;&quot;&quot;</span>
pytest_pycollect_makemodule<span style="color: #666666">.</span>firstresult <span style="color: #666666">=</span> <span style="color: #008000">True</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest_pycollect_makeitem</span>(collector, name, obj):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; return custom item/collector for a python object in a module, or None.  &quot;&quot;&quot;</span>
pytest_pycollect_makeitem<span style="color: #666666">.</span>firstresult <span style="color: #666666">=</span> <span style="color: #008000">True</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest_pyfunc_call</span>(pyfuncitem):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; call underlying test function. &quot;&quot;&quot;</span>
pytest_pyfunc_call<span style="color: #666666">.</span>firstresult <span style="color: #666666">=</span> <span style="color: #008000">True</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest_generate_tests</span>(metafunc):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; generate (multiple) parametrized calls to a test function.&quot;&quot;&quot;</span>

<span style="color: #408080; font-style: italic"># -------------------------------------------------------------------------</span>
<span style="color: #408080; font-style: italic"># generic runtest related hooks</span>
<span style="color: #408080; font-style: italic"># -------------------------------------------------------------------------</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest_runtest_protocol</span>(item):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; implement fixture, run and report about the given test item. &quot;&quot;&quot;</span>
pytest_runtest_protocol<span style="color: #666666">.</span>firstresult <span style="color: #666666">=</span> <span style="color: #008000">True</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest_runtest_setup</span>(item):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; called before pytest_runtest_call(). &quot;&quot;&quot;</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest_runtest_call</span>(item):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; execute test item. &quot;&quot;&quot;</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest_runtest_teardown</span>(item):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; called after pytest_runtest_call(). &quot;&quot;&quot;</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest_runtest_makereport</span>(item, call):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; make a test report for the given item and call outcome. &quot;&quot;&quot;</span>
pytest_runtest_makereport<span style="color: #666666">.</span>firstresult <span style="color: #666666">=</span> <span style="color: #008000">True</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest_runtest_logreport</span>(report):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; process item test report. &quot;&quot;&quot;</span>

<span style="color: #408080; font-style: italic"># special handling for final teardown - somewhat internal for now</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest__teardown_final</span>(session):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; called before test session finishes. &quot;&quot;&quot;</span>
pytest__teardown_final<span style="color: #666666">.</span>firstresult <span style="color: #666666">=</span> <span style="color: #008000">True</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest__teardown_final_logerror</span>(report):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; called if runtest_teardown_final failed. &quot;&quot;&quot;</span>

<span style="color: #408080; font-style: italic"># -------------------------------------------------------------------------</span>
<span style="color: #408080; font-style: italic"># test session related hooks</span>
<span style="color: #408080; font-style: italic"># -------------------------------------------------------------------------</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest_sessionstart</span>(session):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; before session.main() is called. &quot;&quot;&quot;</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest_sessionfinish</span>(session, exitstatus):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; whole test run finishes. &quot;&quot;&quot;</span>

<span style="color: #408080; font-style: italic"># -------------------------------------------------------------------------</span>
<span style="color: #408080; font-style: italic"># hooks for influencing reporting (invoked from pytest_terminal)</span>
<span style="color: #408080; font-style: italic"># -------------------------------------------------------------------------</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest_report_header</span>(config):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; return a string to be displayed as header info for terminal reporting.&quot;&quot;&quot;</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest_report_teststatus</span>(report):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; return result-category, shortletter and verbose word for reporting.&quot;&quot;&quot;</span>
pytest_report_teststatus<span style="color: #666666">.</span>firstresult <span style="color: #666666">=</span> <span style="color: #008000">True</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest_terminal_summary</span>(terminalreporter):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; add additional section in terminal summary reporting. &quot;&quot;&quot;</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest_report_iteminfo</span>(item):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; return (fspath, lineno, name) for the item.</span>
<span style="color: #BA2121; font-style: italic">        the information is used for result display and to sort tests</span>
<span style="color: #BA2121; font-style: italic">    &quot;&quot;&quot;</span>
pytest_report_iteminfo<span style="color: #666666">.</span>firstresult <span style="color: #666666">=</span> <span style="color: #008000">True</span>

<span style="color: #408080; font-style: italic"># -------------------------------------------------------------------------</span>
<span style="color: #408080; font-style: italic"># doctest hooks</span>
<span style="color: #408080; font-style: italic"># -------------------------------------------------------------------------</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest_doctest_prepare_content</span>(content):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; return processed content for a given doctest&quot;&quot;&quot;</span>
pytest_doctest_prepare_content<span style="color: #666666">.</span>firstresult <span style="color: #666666">=</span> <span style="color: #008000">True</span>


<span style="color: #408080; font-style: italic"># -------------------------------------------------------------------------</span>
<span style="color: #408080; font-style: italic"># error handling and internal debugging hooks</span>
<span style="color: #408080; font-style: italic"># -------------------------------------------------------------------------</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest_plugin_registered</span>(plugin, manager):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; a new py lib plugin got registered. &quot;&quot;&quot;</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest_plugin_unregistered</span>(plugin):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; a py lib plugin got unregistered. &quot;&quot;&quot;</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest_internalerror</span>(excrepr):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; called for internal errors. &quot;&quot;&quot;</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest_keyboard_interrupt</span>(excinfo):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; called for keyboard interrupt. &quot;&quot;&quot;</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest_trace</span>(category, msg):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; called for debug info. &quot;&quot;&quot;</span>
</pre></div>
</div>
<div class="section" id="id1">
<h1>hook specification sourcecode</h1>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest_gwmanage_newgateway</span>(gateway, platinfo):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; called on new raw gateway creation. &quot;&quot;&quot;</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest_gwmanage_rsyncstart</span>(source, gateways):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; called before rsyncing a directory to remote gateways takes place. &quot;&quot;&quot;</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest_gwmanage_rsyncfinish</span>(source, gateways):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; called after rsyncing a directory to remote gateways takes place. &quot;&quot;&quot;</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest_configure_node</span>(node):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; configure node information before it gets instantiated. &quot;&quot;&quot;</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest_testnodeready</span>(node):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; Test Node is ready to operate. &quot;&quot;&quot;</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest_testnodedown</span>(node, error):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; Test Node is down. &quot;&quot;&quot;</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest_rescheduleitems</span>(items):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; reschedule Items from a node that went down. &quot;&quot;&quot;</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pytest_looponfailinfo</span>(failreports, rootdirs):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; info for repeating failing tests. &quot;&quot;&quot;</span>
</pre></div>
</div>
</div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-7597274-3");
pageTracker._trackPageview();
} catch(err) {}</script>
</body></html>