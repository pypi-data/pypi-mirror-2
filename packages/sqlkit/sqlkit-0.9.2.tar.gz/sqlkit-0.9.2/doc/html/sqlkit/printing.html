<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        
        <title>
    Printing
 &mdash; sqlkit v0.9.1 documentation</title>
        
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/docs.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sqlkit.css" type="text/css" />
    <link rel="stylesheet" href="../_static/jqueryslidemenu.css" type="text/css" />

    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
          URL_ROOT:    '../',
          VERSION:     '0.9.1',
          COLLAPSE_MODINDEX: false,
          FILE_SUFFIX: '.html'
      };
    </script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/jqueryslidemenu.js"/>

    <script type="text/javascript" src="../_static/init.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="top" title="sqlkit v0.9.1 documentation" href="../index.html" />
        <link rel="up" title="Widgets" href="widgets.html" />
        <link rel="next" title="Browsing data" href="browsing.html" />
        <link rel="prev" title="SqlTable" href="table.html" />
    

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-18221996-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
    </head>
    <body>
        



<!--[if !IE 7]>
	<style type="text/css">
		#wrap {display:table;height:100%}
	</style>
<![endif]-->


<div id="wrap">
    
<div id="header">

	<div class="logo"><a href="tour.html">
       <img src="../_static/sqlkit.png" align="left"  alt="Logo" border="0"/></a>
        </div>
	<div id="description">Acces to db made easy</div>
</div>


   <div style="clear:left;"></div>


<div id="main_menu" class="jqueryslidemenu">
	<ul>
            <li ><a href="tour.html" title="Home" 
                  ><span>Home</span></a></li>

            <li ><a href="contents.html"
                  title="Sqlkit - the python package" 
                  ><span>Sqlkit</span></a>

	       <ul>
		 <li ><a href="contents.html"
		       title="Sqlkit - the python package" 
		       ><span>Sqlkit</span></a></li>

		 <li ><a href="sqlwidget.html" title="Widgets" 
		       ><span>Widgets</span></a>
		       <ul> 
			 <li ><a href="mask.html" title="Mask" 
			       ><span>Mask view</span></a></li>
			 <li ><a href="table.html" title="Table" 
			       ><span>Table view</span></a></li>
		       </ul>
                 </li>
		 <li ><a href="browsing.html" title="Browsing Data" 
		       ><span>Browsing data</span></a>
		    <ul> 
		      <li ><a href="constraints.html" title="Constraints" 
			    ><span>Constraints</span></a></li>
		      <li ><a href="filters.html" title="Filters" 
			    ><span>Filters</span></a></li>
		      <li ><a href="totals.html" title="Totals" 
			    ><span>Totals</span></a></li>
		    </ul>
                 </li>
		 <li ><a href="editing.html" title="Editing Data" 
		       ><span>Editing data</span></a>
			 <ul> 
			   <li ><a href="completion.html" title="Completion" 
				 ><span>Completion</span></a></li>
			   <li ><a href="validation.html" title="Validation" 
				 ><span>Validation</span></a></li>
			   <li ><a href="relationship.html" title="Relationships" 
				 ><span>Relationships</span></a></li>
			 </ul>
		       </li>
		 <li ><a href="#" title="Printing" 
		       ><span>Printing</span></a></li>
		 <li ><a href="advanced/contents.html" title="Advanced configuration" 
		       ><span>Advanced configuration</span></a>
			 <ul> 
			   <li ><a href="advanced/fields.html" title="Fields" 
				 ><span>Fields</span></a></li>
			   <li ><a href="advanced/views.html" title="Views" 
				 ><span>Views</span></a></li>
			 </ul>
		       </li>

	       </ul>
            </li>

            <li ><a href="../misc/sqledit.html"
                  title="Sqledit GUI" 
                  ><span>Sqledit GUI</span></a></li>

            <li ><a href="tutorial.html" title="Tutorial" 
                  ><span>Tutorial</span></a></li>

            <li ><a href="../layout/contents.html" title="Layout"
                  ><span>Layout</span></a></li>

            <li ><a href="../misc/contents.html" title="Download" 
                  ><span>Download</span></a>

	       <ul>
		 <li ><a href="../misc/contents.html"
		       title="Download"
		       ><span>Download</span></a></li>
		 <li ><a href="http://sqlkit.argolinux.org/download/Changelog"  title="Changelog"
		       title="Changelog"
		       ><span>Changelog</span></a></li>
		 <li ><a href="../misc/backward_incompatibilities.html"
		       title="Backward incompatibilities"
		       ><span>Backward incompatibilities</span></a></li>
	       </ul>
            </li>



        </ul>
</div>
   <div style="clear:left;"></div>
  

    
    <div class="related">
      <ul>

	
<!-- <div class="prevnext"> -->
<!--    <li class="right"  style="margin-right: 10px">Indice -->
<!--      <a href="../genindex.html" title="Indice generale" -->
<!--                accesskey="I">indice</a></li> -->

        <li class="right">Prev:
        <a href="table.html" title="previous chapter">SqlTable</a></li>
        <li class="right">Next:
        <a href="browsing.html" title="next chapter">Browsing data</a></li>
<!-- </div> -->


      </ul>

    </div>

    
  <div class="sphinxsidebar">
     <div class="sphinxsidebarwrapper">


	    <div class="topnav">
    <h3>Table of contents</h3>
		    <ul>
<li><a class="reference external" href="#">Printing</a><ul>
<li><a class="reference external" href="#sqlkit-printing">Sqlkit printing</a></li>
<li><a class="reference external" href="#signals">Signals</a></li>
</ul>
</li>
</ul>

		<div class="clearboth"></div>
	    </div>



    <h3>Questions?</h3>

    <p>Subscribe to out mailing list <a href="http://groups.google.com/group/sqlkit">
       Google group</a>:</p>

    <form action="http://groups.google.com/group/sqlkit/boxsubscribe" style="padding-left: 1em">
      <input type="text" name="email" value="your@email"/>
      <input type="submit" name="sub" value="Subscribe" />
    </form>
    <div id="searchbox" style="display: none">

    <h3>Quick search</h3>
	<form class="search" action="../search.html" method="get">
	  <input type="text" name="q" size="18" />
	  <input type="submit" value="Search" />
	  <input type="hidden" name="check_keywords" value="yes" />

	  <input type="hidden" name="area" value="default" />
	</form>
	<p class="searchtip" style="font-size: 90%">
        Enter search terms or a module, class or function name.
	</p>
    <h3>License</h3>
	<img src="../_static/loghi/gplv3.png" alt="logo GPLv3">

    </div>
    <script type="text/javascript">$('#searchbox').show(0);</script>

     </div>
  </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">

            <div class="body">
                
<div class="section" id="module-sqlkit.misc.printing">
<h1>Printing<a class="headerlink" href="#module-sqlkit.misc.printing" title="Permalink to this headline">¶</a></h1>
<p>Sqlkit adds printing capability throught <a class="reference external" href="http://oootemplate.argolinux.org">oootemplate</a> module that in turn
uses templates created with <a class="reference external" href="http://www.openoffice.org">Openoffice.org</a> and very simple syntax.</p>
<p>In this module &#8216;print&#8217; is used in a loose way. In all situations &#8216;print&#8217; means
producing a printable file, it can be an <tt class="docutils literal"><span class="pre">.odt</span></tt> file or a <tt class="docutils literal"><span class="pre">.pdf</span></tt> one.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In a network environment you&#8217;ll probably use a <strong>remote</strong> server that means
the file will not be generated locally. Openoffice 3.1 comes with python2.6
interpreter and uno module even under Windows. So that there&#8217;s no problem
using that interpreter or using a different interpreter but pointing to
it&#8217;s modules.</p>
</div>
<div class="section" id="sqlkit-printing">
<h2>Sqlkit printing<a class="headerlink" href="#sqlkit-printing" title="Permalink to this headline">¶</a></h2>
<p>Each sqlwidget has a <tt class="docutils literal"><span class="pre">printing</span></tt> attribute that manages printer entries that is an instance
of <tt class="docutils literal"><span class="pre">PrintTool</span></tt>.</p>
<p>A standard way should be as easy as just setting a directory where templates
should be found and adding menu entries via <tt class="docutils literal"><span class="pre">add_menu_entry</span></tt>. The default
template dir is a subdir of the current directory named <tt class="docutils literal"><span class="pre">templates</span></tt>.</p>
<p>Templates present in this directory -if named as the nick of the sqlwidget-
will be automatically added, but you will normally want to customize the context
or adding variable to it or adding formatting functions (e.g. to transform numbers
into monetary format), that can be easily done connecting to
<a class="reference internal" href="#psignals"><em>context-ready signal</em></a>.</p>
<p>The default way of filling the context wraps each object into an <a class="reference internal" href="#obj-proxy"><em>ObjectProxy</em></a>
that uses <a class="reference external" href="advanced/fields.html#fields"><em>Fields</em></a> to present each value in a human readable format, that means also that
it tries hard to follow foreign keys and substitute values retrieved by <a class="reference external" href="completion.html#description"><em>foreign key description &amp; search field</em></a>.</p>
<dl class="class">
<dt id="sqlkit.misc.printing.PrintTool">
<em class="property">class </em><tt class="descclassname">sqlkit.misc.printing.</tt><tt class="descname">PrintTool</tt><big>(</big><em>master</em><big>)</big><a class="headerlink" href="#sqlkit.misc.printing.PrintTool" title="Permalink to this definition">¶</a></dt>
<dd><p>a print obj that is able to create a default context to handle to
oootemplate</p>
<dl class="method">
<dt id="sqlkit.misc.printing.PrintTool.__init__">
<tt class="descname">__init__</tt><big>(</big><em>master</em><big>)</big><a class="headerlink" href="#sqlkit.misc.printing.PrintTool.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes the printing tool setting a default template dir and checks for
availability of module &#8216;uno&#8217; from openoffice. If uno is missing the printing
capabilities are made invisible.</p>
<p>If templates are found with the name <tt class="docutils literal"><span class="pre">nick.odt</span></tt>  where the nick is the nick of
the sqlwidget, entries are automatically added. This way you can generate templates
and use them w/o even the need for a single line of code (unless you need to
customize the context, of course)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameter:</th><td class="field-body"><em>master</em> &#8211; the table or mask instance of which this is a printing tool</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sqlkit.misc.printing.PrintTool.add_menu_entry">
<tt class="descname">add_menu_entry</tt><big>(</big><em>description</em>, <em>template_name</em>, <em>server=None</em>, <em>port=None</em>, <em>mode='pdf'</em>, <em>output_name=None</em>, <em>accel=None</em>, <em>tip=None</em>, <em>action_name=None</em><big>)</big><a class="headerlink" href="#sqlkit.misc.printing.PrintTool.add_menu_entry" title="Permalink to this definition">¶</a></dt>
<dd><p>Add menu entry with &#8216;description&#8217; using &#8216;template&#8217;
Both are fake printers in the sense that are &#8216;printer to file&#8217;</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><em>description</em> &#8211; the description that will appear in the menu entry</li>
<li><em>template_name</em> &#8211; the template name to be used</li>
<li><em>mode</em> &#8211; the mode of the printer: pdf or odt</li>
<li><em>output_name</em> &#8211; the output name. Can be a callable that
will receive <tt class="docutils literal"><span class="pre">template_name</span></tt> as parameter. If <tt class="docutils literal"><span class="pre">self.output_dir</span></tt> is defined
<tt class="docutils literal"><span class="pre">output_name</span></tt> will be joined with <tt class="docutils literal"><span class="pre">self.ouput_dir</span></tt> to retrieve it from the client</li>
<li><em>accel</em> &#8211; accelerator to be used with this</li>
<li><em>tip</em> &#8211; tip for the entry</li>
<li><em>action_name</em> &#8211; action name (defaults to templ_ + template_name)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sqlkit.misc.printing.PrintTool.prepare_context">
<tt class="descname">prepare_context</tt><big>(</big><em>context</em><big>)</big><a class="headerlink" href="#sqlkit.misc.printing.PrintTool.prepare_context" title="Permalink to this definition">¶</a></dt>
<dd><p>This function is meant to be overridden by a customized one</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameter:</th><td class="field-body"><em>context</em> &#8211; <p>the automatically prepared <tt class="docutils literal"><span class="pre">oootemplate.Context</span></tt>.
It contains 2 keys:</p>
<ul>
<li><dl class="first docutils">
<dt>&#8216;obj&#8217;: the current object for mask and normally <em>None</em> for tables</dt>
<dd>(unless an object was edited, in which case it will pooint to that object)</dd>
</dl>
</li>
<li>&#8216;Table1&#8217; : the list of record currently loaded in this sqlwidget</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>You can add any keys but remember to use the correct syntax for tables (a dict
with lists as &lt;values).</p>
<p>This is normally used to set totals or arrange so that related table&#8217;s record
are used in Tables. Read example 76.</p>
</dd></dl>

<dl class="attribute">
<dt id="sqlkit.misc.printing.PrintTool.template_dir">
<tt class="descname">template_dir</tt><a class="headerlink" href="#sqlkit.misc.printing.PrintTool.template_dir" title="Permalink to this definition">¶</a></dt>
<dd>The directory where templates are searched for. Default is cwd/templates.
It&#8217;s a path significant for the openoffice server</dd></dl>

<dl class="attribute">
<dt id="sqlkit.misc.printing.PrintTool.server">
<tt class="descname">server</tt><a class="headerlink" href="#sqlkit.misc.printing.PrintTool.server" title="Permalink to this definition">¶</a></dt>
<dd>the openoffice server to connect to for printing</dd></dl>

<dl class="attribute">
<dt id="sqlkit.misc.printing.PrintTool.port">
<tt class="descname">port</tt><a class="headerlink" href="#sqlkit.misc.printing.PrintTool.port" title="Permalink to this definition">¶</a></dt>
<dd>the port to use to connect to the server</dd></dl>

<dl class="attribute">
<dt id="sqlkit.misc.printing.PrintTool.output_dir">
<tt class="descname">output_dir</tt><a class="headerlink" href="#sqlkit.misc.printing.PrintTool.output_dir" title="Permalink to this definition">¶</a></dt>
<dd>the output dir when server is remote as viewed from client (may be an URL)</dd></dl>

<dl class="attribute">
<dt id="sqlkit.misc.printing.PrintTool.remote_output_dir">
<tt class="descname">remote_output_dir</tt><a class="headerlink" href="#sqlkit.misc.printing.PrintTool.remote_output_dir" title="Permalink to this definition">¶</a></dt>
<dd>the output dir when server is remote as viewed from server (a local file for the server)</dd></dl>

<dl class="attribute">
<dt id="sqlkit.misc.printing.PrintTool.pdf_viewer">
<tt class="descname">pdf_viewer</tt><a class="headerlink" href="#sqlkit.misc.printing.PrintTool.pdf_viewer" title="Permalink to this definition">¶</a></dt>
<dd>the preferred viewer for pdf files</dd></dl>

<dl class="attribute">
<dt id="sqlkit.misc.printing.PrintTool.odt_viewer">
<tt class="descname">odt_viewer</tt><a class="headerlink" href="#sqlkit.misc.printing.PrintTool.odt_viewer" title="Permalink to this definition">¶</a></dt>
<dd>the preferred viewer for openoffice templates</dd></dl>

<dl class="method">
<dt id="sqlkit.misc.printing.PrintTool.add_to_table">
<tt class="descname">add_to_table</tt><big>(</big><em>context</em>, <em>table_name</em>, <em>obj_list</em>, <em>master=None</em>, <em>reset=True</em>, <em>format=None</em><big>)</big><a class="headerlink" href="#sqlkit.misc.printing.PrintTool.add_to_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Add to an openoffice table a list of objects wrapped in ObjProxy</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><em>context</em> &#8211; the context to be manipulated</li>
<li><em>table_name</em> &#8211; the table_name where objects list must be added</li>
<li><em>master</em> &#8211; the master where to retrieve fields</li>
<li><em>obj_list</em> &#8211; the list of objects to be added</li>
<li><em>reset</em> &#8211; boolean. If True the list becomes the only list, otherwise it&#8217;s added.
Defaults to True</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sqlkit.misc.printing.ObjProxy">
<em class="property">class </em><tt class="descclassname">sqlkit.misc.printing.</tt><tt class="descname">ObjProxy</tt><big>(</big><em>obj</em>, <em>master=None</em><big>)</big><a class="headerlink" href="#sqlkit.misc.printing.ObjProxy" title="Permalink to this definition">¶</a></dt>
<dd><p id="obj-proxy">A proxy that knows how to retrieve the field.human_value of attributes</p>
</dd></dl>

</div>
<div class="section" id="signals">
<span id="psignals"></span><h2>Signals<a class="headerlink" href="#signals" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">context-ready:</th><td class="field-body"><p class="first">the context has been prepared. You can connect to this signal to add
element to the context.</p>
<dl class="last function">
<dt>
<tt class="descname">context_ready_cb(printtool, context, template_name, sqlwidget):</tt></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><em>printer</em> &#8211; the printing.PrintTool object that emitted the signal</li>
<li><em>context</em> &#8211; the context</li>
<li><em>template_name</em> &#8211; the template name that is rendered</li>
<li><em>sqlwidget</em> &#8211; the sqlwidget</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</td>
</tr>
</tbody>
</table>
</div>
</div>


            </div>
        </div>
     </div>
   </div>

        
</div> <!-- wrap -->

            <div class="bottomnav footer">
                <div class="doc_copyright">
                Alessandro Dentella -- Copyright 2006-2007-2008-2009-2010
		  Sqlkit release 0.9.1
<!--                 % if hasdoc('copyright'): -->
<!--                     &copy; <a href="../copyright.html">Copyright</a> 2008, Sandro Dentella. -->
<!--                 % else: -->
<!--                     &copy; Copyright 2008, Sandro Dentella. -->
<!--                 % endif -->
                    creato usando  <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.4.
                </div>
            </div>
        












<br style="clear: left" />

    </body>
</html>




