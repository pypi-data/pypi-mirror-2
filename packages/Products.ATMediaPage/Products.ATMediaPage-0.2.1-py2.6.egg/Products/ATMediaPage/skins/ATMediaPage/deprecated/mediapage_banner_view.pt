<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="plone">
    <body>
        <div metal:fill-slot="main">
            <tal:main-macro metal:define-macro="main" tal:omit-tag="">
                <div tal:define="results    python:here.portal_catalog(portal_type=['ATImage','Image'], sort_on='getObjPositionInParent', sort_order='forward', path={'query': here.absolute_url_path(), 'level': -1});
                                 resCount   python:len(results);
                                 useZoom    here/getUseImageZoom;">
                    <div tal:attributes="class python:'ATMP ATMP_banner_view' + test(results, '', ' empty');
                                         id    python:'ATMP_' + here.id;">
                        <div class="ATMP_TopImage" tal:condition="resCount">
                            <a href="" title="" rel=""
                               tal:define="topImg python:results[0];"
                               tal:attributes="rel    python:test(useZoom, 'lightbox', None);
                                               href   python:test(useZoom, topImg.getURL() + '/image_large', topImg.getURL() + '/image_view_large');
                                               title  string:${topImg/Title} | ${topImg/Description};"><img src="" alt="" title=""
                               tal:attributes="src    python:topImg.getURL() + '/image_large';
                                               alt    topImg/Description;
                                               title  topImg/Description;" /></a>
                        </div>

                        <div tal:replace="structure provider:plone.abovecontenttitle" />

                        <h1 tal:content="object_title">Title or id</h1>

                        <div tal:replace="structure provider:plone.belowcontenttitle" />

                        <div tal:replace="structure provider:plone.abovecontentbody" />

                        <p class="documentDescription" tal:content="here/Description" tal:condition="here/Description">Description</p>

                        <div class="ATMP_ImageBox1" tal:condition="python: resCount > 1">
                            <tal:loop repeat="result python: results[1:]">
                                <div tal:define="nbr repeat/result/number;"
                                     tal:attributes="id python:'ATMP_Image-' + str(nbr)"><a href="" title="" rel=""
                                     tal:attributes="rel    python:test(useZoom, 'lightbox', None);
                                                     href   python:test(useZoom, result.getURL() + '/image_large', result.getURL() + '/image_view_large');
                                                     title  string:${result/Title} | ${result/Description};"><img src="" alt="" title=""
                                     tal:attributes="src    python:result.getURL() + '/image_mini';
                                                     alt    result/Description;
                                                     title  result/Description;" /></a></div>
                            </tal:loop>
                        </div>

                        <div tal:condition="here/getText" tal:attributes="class python:test(here.Format() in ('text/structured', 'text/x-rst', ), 'stx', 'plain')" tal:content="structure here/getText">Text</div>

                        <div class="visualClear"><!-- clears floating areas --></div>

                        <div tal:replace="structure provider:plone.belowcontentbody" />

                        <div metal:use-macro="here/document_relateditems/macros/relatedItems">show related items if they exist</div>

                    </div>
                </div>
            </tal:main-macro>
        </div>
    </body>
</html>
