<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="plone">
    <body>
        <div metal:fill-slot="main">
            <tal:main-macro metal:define-macro="main" tal:omit-tag="">
                <div tal:define="results    python:here.portal_catalog(portal_type = ['ATImage','Image'], sort_on='getObjPositionInParent', sort_order='forward', path={ 'query': here.absolute_url_path(),'level' : -1 });
                                 allImages  python:map(lambda b: b.getObject(), results);
                                 resCount   python:len(results);
                                 useZoom    here/getUseImageZoom;">
                    <div tal:attributes="class python:'ATMP ATMP_images-autochange_view22' + test(results, '', ' empty');
                                         id    python:'ATMP_' + here.id;">

                        <div tal:replace="structure provider:plone.abovecontenttitle" />

                        <h1 tal:content="object_title">Title or id</h1>

                        <div tal:replace="structure provider:plone.belowcontenttitle" />

                        <div tal:replace="structure provider:plone.abovecontentbody" />

                        <div class="ATMP_DescriptionBox">
                            <div class="ATMP_ImageBox1" tal:condition="resCount">
                                <div id="ATMP_Image-1"
                                     tal:define="rndImages python:container.createAutoImagesJSCode_py(allImages, here);
                                                 img       nocall:rndImages/firstImage;">
                                    <script type="text/javascript"
                                            tal:content="rndImages/jsCode" />
                                    <a href="" title="" rel=""
                                       tal:attributes="rel    python:test(useZoom, 'lightbox', None);
                                                       href   python:test(useZoom, img.absolute_url() + '/image_large', img.absolute_url() + '/image_view_large');
                                                       title  string:${img/Title} | ${img/Description};"><img src="" id="ATMP_AutochangeImage" alt="" title=""
                                       tal:attributes="src    python:img.absolute_url() + '/image_mini';
                                                       alt    img/Description;
                                                       title  img/Description;" /></a>
                                    <div class="ATMP_ImageTitle" id="ATMP_ImageTitle" tal:content="img/Title">Titel</div>
                                </div>
                            </div>

                            <p class="documentDescription" tal:content="here/Description" tal:condition="here/Description">Description</p>

                            <div class="visualClear"><!-- clears floating areas --></div>
                        </div>

                        <div tal:condition="here/getText" tal:attributes="class python:test(here.Format() in ('text/structured', 'text/x-rst', ), 'stx', 'plain')" tal:content="structure here/getText">Text</div>

                        <div class="visualClear"><!-- clears floating areas --></div>

                        <div tal:replace="structure provider:plone.belowcontentbody" />

                        <div metal:use-macro="here/document_relateditems/macros/relatedItems">show related items if they exist</div>

                    </div>
                </div>
            </tal:main-macro>
        </div>
    </body>
</html>
