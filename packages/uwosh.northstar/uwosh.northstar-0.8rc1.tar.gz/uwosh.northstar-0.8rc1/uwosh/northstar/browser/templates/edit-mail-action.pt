<div class="dialog-box" id="prompt"> 
    <h2>Edit Mail Action</h2> 
 
    <p class='discreet'> 
        Where you can edit mailing options. In the email fields, you can use 'authenticated_user' to grab the email of the user performing the action.
    </p> 
 
    <form action="@@uwosh-northstar-edit-mail-action" method="POST"
            tal:define="errors view/errors;
                        action options/action;">
        <input type="hidden" name="selected-workflow" tal:attributes="value view/selected_workflow/id" />
        <input type="hidden" name="selected-transition" tal:attributes="value view/selected_transition/id" />
        
        <div class="field error Archetypestitlefield"
            tal:define="field_name string:from;
                        has_error python: field_name in errors;
                        error python: errors.get(field_name, None);"
            tal:attributes="class python: has_error and 'field error' or 'field'">
            
            <label tal:attributes="for field_name" class="formQuestion">From</label>
            <span title="Required" class="fieldRequired">
                (Required)
            </span>
            <div id="title_help" class="formHelp">Either a plone user id or an email address.</div>

            <div class="fieldErrorBox" 
                tal:condition="has_error"
                tal:content="error">From Error
            </div>
            <input  type="text" 
                    class="the-other"
                    tal:attributes="name field_name; 
                                    id field_name; 
                                    value action/from_;
                                    disabled python: action.from_ == '{{site_owner_email}}' and 'disabled' or ''" /> 
            <input  class="one-or-the-other"
                    type="checkbox" 
                    tal:attributes="name string:${field_name}-checkbox; 
                                    id string:${field_name}-checkbox;
                                    checked python: action.from_ == '{{site_owner_email}}' and 'true' or ''" 
                    value="{{site_owner_email}}" />
            <label tal:attributes="for string:${field_name}-checkbox">Site Owner</label>
        </div>
        
        <div class="field error Archetypestitlefield"
            tal:define="field_name string:to;
                        has_error python: field_name in errors;
                        error python: errors.get(field_name, None);"
            tal:attributes="class python: has_error and 'field error' or 'field'">
            
            <label tal:attributes="for field_name" class="formQuestion">To</label>
            <span title="Required" class="fieldRequired">
                (Required)
            </span>
            <div id="title_help" class="formHelp">Either a plone userid or an email address.</div>

            <div class="fieldErrorBox" 
                tal:condition="has_error"
                tal:content="error">To Error
            </div>
            <input  type="text" 
                    class="the-other"
                    tal:attributes="name field_name; 
                                    id field_name; 
                                    value action/to_;
                                    disabled python: action.to_ == '{{authenticated_user_email}}' and 'disabled' or ''" /> 
            <input  class="one-or-the-other" 
                    type="checkbox" 
                    tal:attributes="name string:${field_name}-checkbox; 
                                    id string:${field_name}-checkbox;
                                    checked python: action.to_ == '{{authenticated_user_email}}' and 'true' or ''" 
                    value="{{authenticated_user_email}}" />
            <label tal:attributes="for string:${field_name}-checkbox">Authenticated User</label>
        </div>
        
        <div class="field error Archetypestitlefield"
            tal:define="field_name string:cc;
                        has_error python: field_name in errors;
                        error python: errors.get(field_name, None);"
            tal:attributes="class python: has_error and 'field error' or 'field'">
            
            <label tal:attributes="for field_name" class="formQuestion">CC</label>
            <div id="title_help" class="formHelp">Either a plone userid or an email address. For multiple address, use commas.</div>

            <div class="fieldErrorBox" 
                tal:condition="has_error"
                tal:content="error">cc Error
            </div>
            <input type="text" size="50" tal:attributes="name field_name; id field_name; value action/cc" /> 
        </div>
        
        <div class="field error Archetypestitlefield"
            tal:define="field_name string:subject;
                        has_error python: field_name in errors;
                        error python: errors.get(field_name, None);"
            tal:attributes="class python: has_error and 'field error' or 'field'">
            
            <label tal:attributes="for field_name" class="formQuestion">Subject</label>
            <div id="title_help" class="formHelp">The subject of the email being sent. Replacements work here also.</div>

            <div class="fieldErrorBox" 
                tal:condition="has_error"
                tal:content="error">Subject Error
            </div>
            <input type="text" size="50" tal:attributes="name field_name; id field_name; value action/subject" /> 
        </div>
        
        <div class="field error Archetypestitlefield"
            tal:define="field_name string:body;
                        has_error python: field_name in errors;
                        error python: errors.get(field_name, None);"
            tal:attributes="class python: has_error and 'field error' or 'field'">
            
            <label tal:attributes="for field_name" class="formQuestion">Body</label>
            <div id="title_help" class="formHelp">
                The actual message to send. 
                You can place information about the transition here also. 
                To do that, in your message you'll need to provide hints about your transition that will be filled in once the email sends.
                For instance, you can add, "{{ portal_url }}", to have provide the url of the site. Or you can add, "{{ transition }}", to
                list the name of the transition that was performed.
                Available replacements are, object_url, portal_url, object_title, portal_title, member_fullname, previous_state, 
                new_state, transition, site_owner, authenticated_user, formatted_datetime, year, month, day, hour, minute and ampm.
            </div>

            <div class="fieldErrorBox" 
                tal:condition="has_error"
                tal:content="error">Body Error
            </div>
            <textarea cols="20" rows="10" tal:attributes="name field_name; id field_name" tal:content="action/body">
            </textarea>
        </div>
        
        <input name="save" type="submit" class="context" value="Save" />
        
    </form> 
    <br /> 
 
</div>