<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="collective.contentmigrationui">

<head>
</head>
<body>
<metal:js fill-slot="javascript_head_slot">
    <script type="text/javascript"
        tal:attributes="src string:${context/absolute_url}/++resource++collective.contentmigrationui.javascript/contentsmap.js">
	</script>
</metal:js>
<div metal:fill-slot="main">
	
	<h1 class="documentFirstHeading">
		<img tal:attributes="src string:${context/absolute_url}/++resource++collective.contentmigrationui.images/process-icon.png" alt="" />
		<span i18n:translate="">Contents migration wizard</span> : <span>Select migration</span>
	</h1>
	<form method="post"
		tal:attributes="action string:${context/absolute_url}/${view/__name__}">
		<div class="formControls">
			<p class="documentDescription" i18n:translate="">Select the desired migration to apply</p>
			<table id="allMigrations" class="listing">
				<thead>
					<tr><th></th>
					  <th>Source portal type</th>
					  <th>Destination portal type</th>
					  <th>Migration notes</th>
					</tr>
				</thead>
				<tbody>
			<tal:allmigrations repeat="migration view/getAllMigrations">
			    <tal:migrInfo define="migrationInfo python:view.getMigrationInfo(migration[1]);
				                       oddrow repeat/migration/odd">
				
					<tr tal:attributes="class python:oddrow is True and 'even' or 'odd'">
						<td>
				<input type="radio"
						name="chosen_type"
						tal:attributes="value python: migration[0];
										id string:portal_type_${repeat/migration/number}"/>
				</td><td>
				<img tal:attributes="src python:migrationInfo[0].getIcon()">
				<span tal:content="python:migrationInfo[0].Title()+' (' +migrationInfo[0].Metatype()+')'"></span>
				</td>
				<td>
					<img tal:attributes="src python:migrationInfo[1].getIcon()">
	                <span tal:content="python:migrationInfo[1].Title()+' (' +migrationInfo[1].Metatype()+')'"></span>
				</td>
				<td>
					<tal:notsafe condition="python:getattr(migration[1],'safeMigration',False) is not True">
					   <img src="error_icon.gif" alt=""/>
                        <span tal:content="python:migration[1].description"></span>
					</tal:notsafe>
				</td>
				</tr>
				</tal:migrInfo>
			</tal:allmigrations>
			</tbody>
			</table>
			<input type="submit"
				i18n:translate=""
				i18n:attributes="value"
				name="form.button.Select"
				value="Select"
				class="context" />
			<input type="submit"
				i18n:translate=""
				i18n:attributes="value"
				name="form.button.Cancel"
				value="Cancel"
				class="standalone" />
		</div>
	</form>

</div>
</body>
</html>