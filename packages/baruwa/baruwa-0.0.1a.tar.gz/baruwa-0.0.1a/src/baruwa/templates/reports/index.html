{% extends 'base.html' %}
{% block headers %}
<script type="text/javascript" language="javascript" src="/static/js/jquery.js"></script>
<script type="text/javascript" charset="utf-8">
//<![CDATA[
var rj;
var ax_error = false;
//]]>
</script>
<script type="text/javascript" language="javascript" src="/static/js/reports.js"></script>
{% endblock headers %}
{% block submenu %}
&nbsp;
{% endblock submenu %}
{% block title %}
Reports
{% endblock title %}
{% block heading %}
Reports
{% endblock heading %}
{% block content %}
<table class="maillog">
<tbody>
<tr>
<td class="divider" colspan="2">Statistics</td>
</tr>
<tr>
<td class="stats">Message count</td>
<td class="stats" id="msgcount">{{data.count}}</td>
</tr>
<tr>
<td class="stats">Oldest message processed on</td>
<td class="stats" id="oldestmsg">{{data.oldest|date:"D d M Y @ G:i A"}}</td>
</tr>
<tr>
<td class="stats">Newest message processed on</td>
<td class="stats" id="newestmsg">{{data.newest|date:"D d M Y @ G:i A"}}</td>
</tr>
<tr>
<td class="divider" colspan="2">Reports</td>
</tr>
<tr>
<td colspan="2">
<ul class="reports">
  <li><a href="/reports/1/">Top Senders by Quantity</a></li>
  <li><a href="/reports/2/">Top Senders by Volume</a></li>
  <li><a href="/reports/3/">Top Sender Domains by Quantity</a></li>
  <li><a href="/reports/4/">Top Sender Domains by Volume</a></li>
  <li><a href="/reports/5/">Top Recipients by Quantity</a></li>
  <li><a href="/reports/6/">Top Recipients by Volume</a></li>
  <li><a href="/reports/7/">Top Recipient Domains By Quantity</a></li>
  <li><a href="/reports/8/">Top Recipient Domains By Volume</a></li>
  <li><a href="/reports/9/">Spamassassin Score Distribution</a></li>
  <!--<li><a href="/reports/p/">Spamassassin Rule Hits</a></li>
  <li><a href="/reports/a/v/">Top Viruses</a></li>-->
  <li><a href="/reports/10/">Top Mail hosts</a></li>
  <li><a href="/reports/11/">Message Totals</a></li>
  <li><a href="/messages/full/">Message Listings</a></li>
</ul>
</td>
</tr>
<tr>
<td class="divider" colspan="2">Add Filter</td>
</tr>
<tr id="filter-form-errors" style="display:{% if errors %}table-row{%else%}none{%endif%};">
<td class="filter_errors first-t" colspan="2">{{errors}}</td>
</tr>
<tr>
<td colspan="2">
<form id="filter-form" method="post" action="/reports/">
<table>
<tr>
<td class="first-t">{{form.filtered_field}}</td>
<td class="first-t">{{form.filtered_by}}</td>
<td class="first-t"><input type="text" id="id_filtered_value" name="filtered_value" size="100" /></td>
<td class="first-t"><input id="filter_form_submit" type="submit" value="Add" /></td>
</tr>
</table>
</form>
</td>
</tr>
<tr>
<td class="divider" colspan="2">Active Filter(s)<a name="active_filters">&nbsp;</a></td>
</tr>
<tr>
<td colspan="2">
<table id="afilters" class="maillog">
<tbody>
{% for f in active_filters %} 
<tr{% if forloop.last%} class="last"{%endif%}>
<td class="first-t filters" colspan="2">
[ <a href="/reports/fd/{{forloop.counter0}}/">x</a> ] 
[ <a href="/reports/fs/{{forloop.counter0}}/">Save</a> ] 
{{f.filter_field}} {{f.filter_by}} {{f.filter_value}}</td>
</tr>
{% empty %}
<tr class="last">
<td class="first-t filters" colspan="2">No active filters at the moment</td>
</tr>
{% endfor %}
</tbody>
</table>
</td>
</tr>
<tr>
<td class="divider" colspan="2">Saved Filter(s)</td>
</tr>
<tr>
<td colspan="2">
<table id="sfilters" class="maillog">
<tbody>
{% for sf in saved_filters %}
<tr{% if forloop.last%} class="last"{%endif%}>
<td class="first-t filters" colspan="2">
[ <a href="/reports/sfd/{{sf.filter_id}}/">x</a> ] 
{% if not sf.is_loaded %}
[ <a href="/reports/sfl/{{sf.filter_id}}/">Load</a> ] 
{% else %}
[ Load ] 
{% endif %}
{{sf.filter_name}}</td>
</tr>
{% empty %}
<tr class="last">
<td class="first-t filters" colspan="2">No saved filters at the moment</td>
</tr>
{% endfor %}
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
{% endblock content %}
