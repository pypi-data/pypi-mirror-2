
<VirtualHost *:80>
    ServerAdmin webmasters@manicsages.org
    ServerName 0.comsat.manicsages.org
    ServerAlias *.0.comsat.manicsages.org

    ErrorLog /var/log/apache2/comsat-0.error_log
    CustomLog "|/usr/sbin/rotatelogs -f /var/log/apache2/comsat-0.access_log.%Y-%m%d-%H%M 16M" common

    DocumentRoot "/var/www/comsat"

    <Location "/media">
        SetHandler none
    </Location>
    
    # Provide access to orbited
    ProxyPass /.comsat/ http://localhost:9010/
    ProxyPass /tcp http://localhost:9010/tcp
    <Proxy *>
        Order deny,allow
        Allow from all
    </Proxy>

    # Serve only the media folder
    <Directory "/var/www/comsat">
        Options Indexes FollowSymLinks
        AllowOverride None
        Order allow,deny
        Deny from all
    </Directory>
    <Directory "/var/www/comsat/media">
        Options Indexes FollowSymLinks
        AllowOverride None
        Order allow,deny
        Allow from all
    </Directory>

    <IfModule peruser.c>
        ServerEnvironment apache apache
        MinSpareProcessors 4
        MaxProcessors 20
    </IfModule>

    <IfModule itk.c>
        AssignUserID apache apache
        MaxClientsVHost 1000
    </IfModule>
</VirtualHost>


<VirtualHost *:80>
    ServerAdmin webmasters@manicsages.org
    ServerName 1.comsat.manicsages.org
    ServerAlias *.1.comsat.manicsages.org

    ErrorLog /var/log/apache2/comsat-1.error_log
    CustomLog "|/usr/sbin/rotatelogs -f /var/log/apache2/comsat-1.access_log.%Y-%m%d-%H%M 16M" common

    DocumentRoot "/var/www/comsat"

    <Location "/media">
        SetHandler none
    </Location>
    
    # Provide access to orbited
    ProxyPass /.comsat/ http://localhost:9011/
    ProxyPass /tcp http://localhost:9011/tcp
    <Proxy *>
        Order deny,allow
        Allow from all
    </Proxy>

    # Serve only the media folder
    <Directory "/var/www/comsat">
        Options Indexes FollowSymLinks
        AllowOverride None
        Order allow,deny
        Deny from all
    </Directory>
    <Directory "/var/www/comsat/media">
        Options Indexes FollowSymLinks
        AllowOverride None
        Order allow,deny
        Allow from all
    </Directory>

    <IfModule peruser.c>
        ServerEnvironment apache apache
        MinSpareProcessors 4
        MaxProcessors 20
    </IfModule>

    <IfModule itk.c>
        AssignUserID apache apache
        MaxClientsVHost 1000
    </IfModule>
</VirtualHost>

<VirtualHost *:80>
    ServerAdmin webmasters@manicsages.org
    ServerName base.comsat.manicsages.org

    #ErrorLog /var/log/apache2/comsat.error_log
    #CustomLog /var/log/apache2/comsat.access_log common
    #ErrorLog /dev/null
    #CustomLog /dev/null common
    ErrorLog /var/log/apache2/comsat.error_log
    CustomLog "|/usr/sbin/rotatelogs -f /var/log/apache2/comsat.access_log.%Y-%m%d-%H%M 16M" common

    DocumentRoot "/var/www/comsat"

    <Location "/media">
        SetHandler none
    </Location>
    
    # Serve only the media folder
    <Directory "/var/www/comsat">
        Options Indexes FollowSymLinks
        AllowOverride None
        Order allow,deny
        Deny from all
    </Directory>
    <Directory "/var/www/comsat/media">
        Options Indexes FollowSymLinks
        AllowOverride None
        Order allow,deny
        Allow from all
    </Directory>

    <IfModule peruser.c>
        # this must match a Processor
        ServerEnvironment apache apache

        # these are optional - defaults to the values specified in httpd.conf
        MinSpareProcessors 4
        MaxProcessors 20
    </IfModule>

    <IfModule itk.c>
        # The userid and groupid this VirtualHost will run as
        AssignUserID apache apache

        # Optional: A separate MaxClients for the VirtualHost,
        # to limit the maximum number of processes
        MaxClientsVHost 1000

        # Note that if you do not assign a user ID for your
        # VirtualHosts, none will be assigned by default,
        # ie. you'll run as root. Don't forget this!
    </IfModule>
</VirtualHost>
# vim:syntax=apache
