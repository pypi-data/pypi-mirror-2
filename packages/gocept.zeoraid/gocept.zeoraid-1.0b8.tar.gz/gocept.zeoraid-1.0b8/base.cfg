[buildout]
extends = versions.cfg
develop = .
parts = zodbscripts test zeo1 zeo2 zeo3 zeoraid1 zeoraid2
find-links = http://download.zope.org/distribution/
versions = versions
allow-picked-versions = false

[test]
recipe = zc.recipe.testrunner
eggs = gocept.zeoraid
defaults = ['-c', '-vv', '--all']

[storage1]
recipe = zc.recipe.filestorage

[zeo1]
recipe = zc.zodbrecipes:server
zeo.conf = 
    <zeo>
    address 8100
    </zeo>
    <filestorage 1>
    path ${storage1:path}
    </filestorage>

[storage2]
recipe = zc.recipe.filestorage

[zeo2]
recipe = zc.zodbrecipes:server
zeo.conf = 
    <zeo>
    address 8101
    </zeo>
    <filestorage 1>
    path ${storage2:path}
    </filestorage>

[storage3]
recipe = zc.recipe.filestorage

[zeo3]
recipe = zc.zodbrecipes:server
zeo.conf = 
    <zeo>
    address 8102
    </zeo>
    <filestorage 1>
    path ${storage3:path}
    </filestorage>

[zeoraid1]
recipe = gocept.zeoraid:server
zeo.conf =
    <zeo>
    address 127.0.0.1:8200
    </zeo>
    %import gocept.zeoraid
    <raidstorage main>
        <zeoclient 1>
            server localhost:8100
            storage 1
            wait false
        </zeoclient>
        <zeoclient 2>
            server localhost:8101
            storage 1
            wait false
        </zeoclient>
    </raidstorage>

[zeoraid2]
recipe = gocept.zeoraid:server
zeo.conf =
    <zeo>
    address 127.0.0.1:8201
    </zeo>
    %import gocept.zeoraid
    <raidstorage main>
        <zeoclient 1>
            server localhost:8100
            storage 1
            wait false
        </zeoclient>
        <zeoclient 2>
            server localhost:8101
            storage 1
            wait false
        </zeoclient>
    </raidstorage>

[zodbscripts]
recipe = zc.recipe.egg:scripts
eggs = ZODB3
       gocept.zeoraid
interpreter = py
