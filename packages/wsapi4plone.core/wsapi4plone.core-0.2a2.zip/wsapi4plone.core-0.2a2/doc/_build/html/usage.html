

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Python Usage Examples (via the interpreter) &mdash; Web Services API for Plone v0.2a2 documentation</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.2a2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Web Services API for Plone v0.2a2 documentation" href="index.html" />
    <link rel="next" title="Changelog" href="changes.html" />
    <link rel="prev" title="Web Services API" href="api.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="changes.html" title="Changelog"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="api.html" title="Web Services API"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Web Services API for Plone v0.2a2 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="python-usage-examples-via-the-interpreter">
<h1>Python Usage Examples (via the interpreter)<a class="headerlink" href="#python-usage-examples-via-the-interpreter" title="Permalink to this headline">¶</a></h1>
<p>Setup the client connection using <a class="reference external" href="http://docs.python.org/library/xmlrpclib.html#module-xmlrpclib" title="(in Python v2.7)"><tt class="xref py py-mod docutils literal"><span class="pre">xmlrpclib</span></tt></a> with basic authorization.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">xmlrpclib</span> <span class="kn">import</span> <span class="n">ServerProxy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">client</span> <span class="o">=</span> <span class="n">ServerProxy</span><span class="p">(</span><span class="s">&#39;http://user:password@localhost:8888/plone&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The above URI is an example. The terms within it will likely
need changed to suit ones needs. The url scheme is like so:</p>
<div class="last highlight-python"><pre>(http|https)://[&lt;username&gt;:&lt;password&gt;@]&lt;hostname&gt;[:80|:&lt;port&gt;]/&lt;site_name&gt;</pre>
</div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Please take a look at the <a class="reference external" href="http://pypi.python.org/pypi/wsapi4plone.client">wsapi4plone.client</a> package if you are
interested in cookie based authentication.</p>
</div>
<div class="section" id="finding-what-you-re-looking-for">
<span id="query-example"></span><h2>Finding what you&#8217;re looking for<a class="headerlink" href="#finding-what-you-re-looking-for" title="Permalink to this headline">¶</a></h2>
<p>We can use the <tt class="docutils literal"><span class="pre">query</span></tt> call to search for content in the site. This will also
allow us to get a full index of all the content objects in the site if we do not
provide any parameters.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">query</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="go">7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span>
<span class="go">{&#39;/plone/front-page&#39;: {&#39;CreationDate&#39;: &#39;2007-04-02 15:28:30&#39;,</span>
<span class="go">                       &#39;Creator&#39;: &#39;admin&#39;,</span>
<span class="go">                       &#39;Date&#39;: &#39;2009-08-19 09:56:50&#39;,</span>
<span class="go">                       &#39;Description&#39;: &#39;Congratulations! You have successfully installed Plone.&#39;,</span>
<span class="go">                       &#39;EffectiveDate&#39;: &#39;None&#39;,</span>
<span class="go">                       &#39;ExpirationDate&#39;: &#39;None&#39;,</span>
<span class="go">                       &#39;ModificationDate&#39;: &#39;2009-08-19 09:56:50&#39;,</span>
<span class="go">                       &#39;Subject&#39;: [],</span>
<span class="go">                       &#39;Title&#39;: &#39;Welcome to Plone&#39;,</span>
<span class="go">                       &#39;Type&#39;: &#39;Page&#39;,</span>
<span class="go">                       &#39;UID&#39;: &#39;07f20e423b6ca478eb8691ff816b83a3&#39;,</span>
<span class="go">                       &#39;container&#39;: False,</span>
<span class="go">                       &#39;created&#39;: &lt;DateTime ...&gt;,</span>
<span class="go">                       &#39;effective&#39;: &lt;DateTime ...&gt;,</span>
<span class="go">                       &#39;expires&#39;: &lt;DateTime ...&gt;,</span>
<span class="go">                       &#39;id&#39;: &#39;front-page&#39;,</span>
<span class="go">                       &#39;listCreators&#39;: [&#39;admin&#39;],</span>
<span class="go">                       &#39;modified&#39;: &lt;DateTime ...&gt;,</span>
<span class="go">                       &#39;review_state&#39;: &#39;published&#39;,</span>
<span class="go">                       &#39;size&#39;: &#39;4.9 kB&#39;}, ... }</span>
</pre></div>
</div>
<p>We can also pass criteria to the query call in the form of a dictionary. The
<tt class="docutils literal"><span class="pre">query</span></tt> call is simply an abstraction of the Plone portal_catalog&#8217;s search
method. Therefore, you can look at the <a class="reference external" href="http://plone.org/documentation/manual/plone-community-developer-documentation/searching-and-indexing/query">Plone Manual&#8217;s Querying section</a>
for more information on the possible calls to the portal_catalog. The query call uses a dictionary of keyword arguments. A basic example would look like:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">query</span><span class="p">({</span><span class="s">&#39;Title&#39;</span><span class="p">:</span> <span class="s">&quot;Users&quot;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="go">[&#39;/plone/Members&#39;]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Where Title in the above case would normally be a keyword argument
like <tt class="docutils literal"><span class="pre">search(Title=&quot;Users&quot;)</span></tt> it needs to be a dictionary of keyword
arguments to pass through the XML-RPC parts of the Zope2 Publisher.</p>
</div>
</div>
<div class="section" id="get-a-content-object">
<span id="get-object-example"></span><h2>Get a content object<a class="headerlink" href="#get-a-content-object" title="Permalink to this headline">¶</a></h2>
<p>To get information about the site (or the current calling location based on the
URL used to instantiate the client) use the <tt class="docutils literal"><span class="pre">get_object</span></tt> call without any
parameters.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">site_object</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_object</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">site_object</span>
<span class="go">{&#39;/plone&#39;: [{&#39;description&#39;: &#39;&#39;, &#39;id&#39;: &#39;plone&#39;, &#39;title&#39;: &#39;Site&#39;},</span>
<span class="go">            &#39;Plone Site&#39;,</span>
<span class="go">            {&#39;contents&#39;: {&#39;/plone/Members&#39;: {&#39;CreationDate&#39;: &#39;2009-08-19 09:56:50&#39;,</span>
<span class="go">                                             &#39;Creator&#39;: &#39;admin&#39;,</span>
<span class="go">                                             &#39;Date&#39;: &#39;2009-08-19 09:56:51&#39;,</span>
<span class="go">                                             &#39;Description&#39;: &quot;Container for users&#39; home directories&quot;,</span>
<span class="go">                                             &#39;EffectiveDate&#39;: &#39;None&#39;,</span>
<span class="go">                                             &#39;ExpirationDate&#39;: &#39;None&#39;,</span>
<span class="go">                                             &#39;ModificationDate&#39;: &#39;2009-08-19 09:56:51&#39;,</span>
<span class="go">                                             &#39;Subject&#39;: [],</span>
<span class="go">                                             &#39;Title&#39;: &#39;Users&#39;,</span>
<span class="go">                                             &#39;Type&#39;: &#39;Large Folder&#39;,</span>
<span class="go">                                             &#39;UID&#39;: &#39;6e22e44bbe5581e10e3ff4913cebf83a&#39;,</span>
<span class="go">                                             &#39;container&#39;: True,</span>
<span class="go">                                             &#39;created&#39;: &lt;DateTime ...&gt;,</span>
<span class="go">                                             &#39;effective&#39;: &lt;DateTime ...&gt;,</span>
<span class="go">                                             &#39;expires&#39;: &lt;DateTime ...&gt;,</span>
<span class="go">                                             &#39;id&#39;: &#39;Members&#39;,</span>
<span class="go">                                             &#39;listCreators&#39;: [&#39;admin&#39;],</span>
<span class="go">                                             &#39;modified&#39;: &lt;DateTime ...&gt;,</span>
<span class="go">                                             &#39;review_state&#39;: &#39;published&#39;,</span>
<span class="go">                                             &#39;size&#39;: &#39;1 kB&#39;}, ... }]}</span>
</pre></div>
</div>
<div class="section" id="analyzing-the-results">
<h3>Analyzing the results<a class="headerlink" href="#analyzing-the-results" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">get_object</span></tt> call will return data in a dictionary that is keyed by
absolute path within the Zope2 instance. The value of each key is a list of
three items. The items are loosely referred as the following and will appear
in a Python list in the specified order.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">schema:</th><td class="field-body">The schema isn&#8217;t exactly a schema, but for lack of a better term has
been called such. The data is a dictionary of the content object&#8217;s
attribute name and value. Further information about the schema can be
determined by using the <a class="reference internal" href="api.html#get-schema-def"><em>get_schema</em></a> call
and the content&#8217;s type name.</td>
</tr>
<tr class="field"><th class="field-name">type:</th><td class="field-body">The type is a string that represents the content-type of the object. The
type name is derived from the name that has been registered in <a class="reference external" href="http://plone.org/documentation/manual/plone-community-developer-documentation/content/types">Plone&#8217;s
portal_types tool</a>.</td>
</tr>
<tr class="field"><th class="field-name">extensions:</th><td class="field-body">This third value will always be available, but may return an empty
dictionary when there are no extensions for the object that has
been requested. When an extension is available, it will appear in
the dictionary, keyed by its registered name. You will need to
consult the particular extension&#8217;s documentation to understand the
out/input structure. Extensions can be written to provide support
for information that is secondary to the object&#8217;s true purpose
(e.g. getting/setting the default page view). Extensions are
usually content-type specific, but can be global in scope.  See the
<a class="reference internal" href="extensions.html#contents-extension"><em>Contents Extension</em></a> for a more in-depth explanation of how
extensions work. If you are interested in extending the WSAPI, take
a look at <a class="reference internal" href="extensions.html#extensions-development"><em>How to make an extension</em></a>.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="get-specific-content-objects-by-path">
<h3>Get specific content objects by path<a class="headerlink" href="#get-specific-content-objects-by-path" title="Permalink to this headline">¶</a></h3>
<p>To be more specific about which objects you want returned, you can provide a
list of paths to <tt class="docutils literal"><span class="pre">get_object</span></tt>. The path can be relative to the xmlrpclib
initialization location or absolute. However, everything will always be returned
with the absolute path, no matter if you use relative paths or not.</p>
<p>In the following example we use both relative and absolute URLs to get the
<em>Members</em> container object and the <em>front-page</em> document object.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">objs</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_object</span><span class="p">([</span><span class="s">&#39;Members&#39;</span><span class="p">,</span> <span class="s">&#39;/plone/front-page&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">objs</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">objs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="go">[&#39;/plone/front-page&#39;, &#39;/plone/Members&#39;]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="put-or-update-information-on-a-content-object">
<span id="put-object-example"></span><h2>Put or update information on a content object<a class="headerlink" href="#put-or-update-information-on-a-content-object" title="Permalink to this headline">¶</a></h2>
<p>To put (as in the HTTP PUT method) or update information in an existing content
object, we pass the <tt class="docutils literal"><span class="pre">put_object</span></tt> call. A dictionary of keyed paths that are
valued with a list of schema and type information is provided as a single
parameter. In short, you can do a <a class="reference internal" href="api.html#get-object-def"><em>get_object</em></a> call and change/update the results, then simply pass those results back into <tt class="docutils literal"><span class="pre">put_object</span></tt>. Let&#8217;s take a look at an example that changes the text body of the <em>front-page</em> object using the <a class="reference internal" href="api.html#get-object-def"><em>get_object</em></a> shortcut.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">frontpage</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_object</span><span class="p">([</span><span class="s">&#39;/plone/front-page&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">schema</span> <span class="o">=</span> <span class="n">frontpage</span><span class="p">[</span><span class="s">&#39;/plone/front-page&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>At this point we have the schema of the object. We could drop everything except the fields that have been modified, but in this case we will just send back the entire object.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">schema</span><span class="p">[</span><span class="s">&#39;text&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;Once a new technology starts rolling, </span><span class="se">\</span>
<span class="gp">... </span><span class="s">if you&#39;re not part of the steamroller, you&#39;re part of the road. </span><span class="se">\</span>
<span class="gp">... </span><span class="s">--Stewart Brand&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frontpage</span><span class="p">[</span><span class="s">&#39;/plone/front-page&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">schema</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">updated_objects</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">put_object</span><span class="p">(</span><span class="n">frontpage</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">updated_objects</span>
<span class="go">[&#39;/plone/front-page&#39;]</span>
</pre></div>
</div>
<p>And now let&#8217;s check the <em>front-page</em> has been updated.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">updated_frontpage</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_object</span><span class="p">(</span><span class="n">updated_objects</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">updated_frontpage</span><span class="p">[</span><span class="s">&#39;/plone/front-page&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s">&#39;text&#39;</span><span class="p">]</span>
<span class="go">&quot;Once a new technology starts rolling, if you&#39;re not part of the steamroller, you&#39;re part of the road. --Stewart Brand&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="post-a-new-content-object">
<span id="post-object-example"></span><h2>Post a new content object<a class="headerlink" href="#post-a-new-content-object" title="Permalink to this headline">¶</a></h2>
<p>To create or post (as in HTTP POST method) a piece of content to a Plone site
you would use <tt class="docutils literal"><span class="pre">post_object</span></tt>, which is almost the same as
<a class="reference internal" href="api.html#put-object-def"><em>put_object</em></a>. The only difference between the two calls is that the
type (a.k.a. content-type) is optional with <a class="reference internal" href="api.html#put-object-def"><em>put_object</em></a>, but not with
<tt class="docutils literal"><span class="pre">post_object</span></tt>. Also, it should be noted that it is your responsibility to
provide any required attributes, as <tt class="docutils literal"><span class="pre">post_object</span></tt> does not verify you have
providing values for required attributes.</p>
<div class="section" id="knowing-what-content-types-are-available">
<h3>Knowing what content-types are available<a class="headerlink" href="#knowing-what-content-types-are-available" title="Permalink to this headline">¶</a></h3>
<p>Since <tt class="docutils literal"><span class="pre">post_object</span></tt> requires you to provide a type, where do you find out what
types are available? The <a class="reference internal" href="api.html#get-types-def"><em>get_types</em></a> call is for this very purpose.
Here is a quick example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">client</span><span class="o">.</span><span class="n">get_types</span><span class="p">()</span>
<span class="go">[[&#39;Document&#39;, &#39;Page&#39;],</span>
<span class="go"> [&#39;Event&#39;, &#39;Event&#39;],</span>
<span class="go"> [&#39;Favorite&#39;, &#39;Favorite&#39;],</span>
<span class="go"> [&#39;File&#39;, &#39;File&#39;],</span>
<span class="go"> [&#39;Folder&#39;, &#39;Folder&#39;],</span>
<span class="go"> [&#39;Image&#39;, &#39;Image&#39;],</span>
<span class="go"> [&#39;Link&#39;, &#39;Link&#39;],</span>
<span class="go"> [&#39;News Item&#39;, &#39;News Item&#39;],</span>
<span class="go"> [&#39;Topic&#39;, &#39;Collection&#39;],</span>
<span class="go"> [&#39;MyFolder&#39;, &#39;MyFolder&#39;]]</span>
</pre></div>
</div>
<div class="admonition-see-also admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">Look at <a class="reference internal" href="#get-types-example"><em>Get the available content-types</em></a> for more information about
:ref`get_types_def`.</p>
</div>
</div>
<div class="section" id="getting-the-required-fields-of-a-content-type">
<span id="required-fields-inspection-example"></span><h3>Getting the required fields of a content-type<a class="headerlink" href="#getting-the-required-fields-of-a-content-type" title="Permalink to this headline">¶</a></h3>
<p>Before you create new content object it is helpful to know what attributes the
content-type has. To do that we can use <tt class="docutils literal"><span class="pre">get_schema</span></tt>, which will return the
attributes and meta-data about those attributes for the requested content-type.
Here is a quick example for the <em>Link</em> schema and how to determine its required
attributes:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">link_schema</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_schema</span><span class="p">(</span><span class="s">&#39;Link&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">link_schema</span> <span class="k">if</span> <span class="n">link_schema</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s">&#39;required&#39;</span><span class="p">]</span> <span class="p">]</span>
<span class="go">[&#39;remoteUrl&#39;, &#39;title&#39;]</span>
</pre></div>
</div>
<div class="admonition-see-also admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">Look at <a class="reference internal" href="#get-schema-example"><em>Get a content object&#8217;s structure</em></a> for more information about
<a class="reference internal" href="api.html#get-schema-def"><em>get_schema</em></a>.</p>
</div>
</div>
<div class="section" id="creating-the-content">
<span id="post-object-example-create"></span><h3>Creating the content<a class="headerlink" href="#creating-the-content" title="Permalink to this headline">¶</a></h3>
<p>To create objects we need to give <tt class="docutils literal"><span class="pre">post_object</span></tt> the same data structure you
give to <a class="reference internal" href="api.html#put-object-def"><em>put_object</em></a> and receive from <a class="reference internal" href="api.html#get-object-def"><em>get_object</em></a>. Recall
from the <a class="reference internal" href="#get-object-example"><em>Get a content object</em></a>, objects are keyed by absolute path, which
means that our <tt class="docutils literal"><span class="pre">post_object</span></tt> parameter data structure is a dictionary of path
keys and object values. The key of the dictionary will be the to-be-created
object identifier or ID. Everything else is relatively straight forward, since
it is so similar to <a class="reference internal" href="api.html#put-object-def"><em>put_object</em></a>. Let&#8217;s take a look at an example where
we create a <em>Link</em> content object to the PSU WebLion website.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">weblion</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;/plone/weblion&#39;</span><span class="p">:</span> <span class="p">[</span>
<span class="gp">... </span>   <span class="p">{</span><span class="s">&#39;title&#39;</span><span class="p">:</span> <span class="s">&#39;PSU WebLion&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s">&#39;remoteUrl&#39;</span><span class="p">:</span> <span class="s">&#39;http://weblion.psu.edu/&#39;</span><span class="p">},</span>
<span class="gp">... </span>   <span class="s">&#39;Link&#39;</span><span class="p">]</span>
<span class="gp">... </span>   <span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">object_path</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">post_object</span><span class="p">(</span><span class="n">weblion</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">We could have used the relative path <tt class="docutils literal"><span class="pre">weblion</span></tt> as the key rather
than the absolute path.</p>
</div>
<p>Now if we retrieve the object, we will find that it has a bunch of other attributes that we did not set that are automatically set by Plone and Zope.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">weblion</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_object</span><span class="p">(</span><span class="n">object_path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weblion</span>
<span class="go">{&#39;/plone/weblion&#39;: [{&#39;allowDiscussion&#39;: False,</span>
<span class="go">                     &#39;contributors&#39;: [],</span>
<span class="go">                     &#39;creation_date&#39;: &lt;DateTime ...&gt;,</span>
<span class="go">                     &#39;creators&#39;: [&#39;admin&#39;],</span>
<span class="go">                     &#39;description&#39;: &#39;&#39;,</span>
<span class="go">                     &#39;effectiveDate&#39;: None,</span>
<span class="go">                     &#39;excludeFromNav&#39;: False,</span>
<span class="go">                     &#39;expirationDate&#39;: None,</span>
<span class="go">                     &#39;id&#39;: &#39;weblion&#39;,</span>
<span class="go">                     &#39;language&#39;: &#39;&#39;,</span>
<span class="go">                     &#39;location&#39;: &#39;&#39;,</span>
<span class="go">                     &#39;modification_date&#39;: &lt;DateTime ...&gt;,</span>
<span class="go">                     &#39;relatedItems&#39;: [],</span>
<span class="go">                     &#39;remoteUrl&#39;: &#39;http://weblion.psu.edu/&#39;,</span>
<span class="go">                     &#39;rights&#39;: &#39;&#39;,</span>
<span class="go">                     &#39;subject&#39;: [],</span>
<span class="go">                     &#39;title&#39;: &#39;PSU WebLion&#39;},</span>
<span class="go">                    &#39;Link&#39;,</span>
<span class="go">                    None]}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="delete-a-content-object">
<span id="delete-object-example"></span><h2>Delete a content object<a class="headerlink" href="#delete-a-content-object" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">delete_object</span></tt> does exactly as the name would suggest, deletes objects.
To use <tt class="docutils literal"><span class="pre">delete_object</span></tt>, you pass it a list of paths, much like the list of
paths used with <a class="reference internal" href="api.html#get-object-def"><em>get_object</em></a>. Like the other calls, the paths can be
absolute or relative to the client instantiation URL. Let&#8217;s try
<tt class="docutils literal"><span class="pre">delete_object</span></tt> by deleting the <em>Members</em> folder and the <em>events</em> collection.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">client</span><span class="o">.</span><span class="n">delete_object</span><span class="p">([</span><span class="s">&#39;Members&#39;</span><span class="p">,</span><span class="s">&#39;/plone/events&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="get-the-available-content-types">
<span id="get-types-example"></span><h2>Get the available content-types<a class="headerlink" href="#get-the-available-content-types" title="Permalink to this headline">¶</a></h2>
<p>Plone comes with a nice variety of content-types; and this is one of the reasons
it is such a powerful system. To list all the content-types available in a Plone site we can use <tt class="docutils literal"><span class="pre">get_types</span></tt>. In addition, you can provide the call with a path to a container object, which will allow you to discover the addible content-types for that container. Let&#8217;s take a look at the types that can be added to the current call location (the site root) and the <tt class="docutils literal"><span class="pre">news</span></tt> object (a <em>Large Plone Folder</em>).</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">client</span><span class="o">.</span><span class="n">get_types</span><span class="p">()</span>
<span class="go">[[&#39;Document&#39;, &#39;Page&#39;],</span>
<span class="go"> [&#39;Event&#39;, &#39;Event&#39;],</span>
<span class="go"> [&#39;Favorite&#39;, &#39;Favorite&#39;],</span>
<span class="go"> [&#39;File&#39;, &#39;File&#39;],</span>
<span class="go"> [&#39;Folder&#39;, &#39;Folder&#39;],</span>
<span class="go"> [&#39;Image&#39;, &#39;Image&#39;],</span>
<span class="go"> [&#39;Link&#39;, &#39;Link&#39;],</span>
<span class="go"> [&#39;News Item&#39;, &#39;News Item&#39;],</span>
<span class="go"> [&#39;Topic&#39;, &#39;Collection&#39;],</span>
<span class="go"> [&#39;MyFolder&#39;, &#39;MyFolder&#39;]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">client</span><span class="o">.</span><span class="n">get_types</span><span class="p">(</span><span class="s">&#39;/plone/news&#39;</span><span class="p">)</span>
<span class="go">[[&#39;News Item&#39;, &#39;News Item&#39;]]</span>
</pre></div>
</div>
</div>
<div class="section" id="get-a-content-object-s-structure">
<span id="get-schema-example"></span><h2>Get a content object&#8217;s structure<a class="headerlink" href="#get-a-content-object-s-structure" title="Permalink to this headline">¶</a></h2>
<p>You usually want a blue print or schematic before trying to start an engineering
project. The same usually holds true for content objects, because not all
content has the same shape or function. The <tt class="docutils literal"><span class="pre">get_schema</span></tt> call helps to
determine the schema of a content-type. The schema is basically a blue print for
the object. The call returns a dictionary of object attributes and there
meta-data for the requested content-type.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The current implementation provides a dictionary of two key value
pairs (required and type) as the attribute meta-data. Future versions of this
package may also provide default values, permission information and
vocabularies and/or sources.</p>
</div>
<p>Let&#8217;s take a look at the schema for an <em>Image</em> content-type.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">image_schema</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_schema</span><span class="p">(</span><span class="s">&#39;Image&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_schema</span>
<span class="go">{&#39;allowDiscussion&#39;: {&#39;required&#39;: False, &#39;type&#39;: &#39;boolean&#39;},</span>
<span class="go"> &#39;contributors&#39;: {&#39;required&#39;: False, &#39;type&#39;: &#39;lines&#39;},</span>
<span class="go"> &#39;creation_date&#39;: {&#39;required&#39;: False, &#39;type&#39;: &#39;datetime&#39;},</span>
<span class="go"> &#39;creators&#39;: {&#39;required&#39;: False, &#39;type&#39;: &#39;lines&#39;},</span>
<span class="go"> &#39;description&#39;: {&#39;required&#39;: False, &#39;type&#39;: &#39;text&#39;},</span>
<span class="go"> &#39;effectiveDate&#39;: {&#39;required&#39;: False, &#39;type&#39;: &#39;datetime&#39;},</span>
<span class="go"> &#39;excludeFromNav&#39;: {&#39;required&#39;: False, &#39;type&#39;: &#39;boolean&#39;},</span>
<span class="go"> &#39;expirationDate&#39;: {&#39;required&#39;: False, &#39;type&#39;: &#39;datetime&#39;},</span>
<span class="go"> &#39;id&#39;: {&#39;required&#39;: 0, &#39;type&#39;: &#39;string&#39;},</span>
<span class="go"> &#39;image&#39;: {&#39;required&#39;: True, &#39;type&#39;: &#39;image&#39;},</span>
<span class="go"> &#39;language&#39;: {&#39;required&#39;: False, &#39;type&#39;: &#39;string&#39;},</span>
<span class="go"> &#39;location&#39;: {&#39;required&#39;: False, &#39;type&#39;: &#39;string&#39;},</span>
<span class="go"> &#39;modification_date&#39;: {&#39;required&#39;: False, &#39;type&#39;: &#39;datetime&#39;},</span>
<span class="go"> &#39;relatedItems&#39;: {&#39;required&#39;: False, &#39;type&#39;: &#39;reference&#39;},</span>
<span class="go"> &#39;rights&#39;: {&#39;required&#39;: False, &#39;type&#39;: &#39;text&#39;},</span>
<span class="go"> &#39;subject&#39;: {&#39;required&#39;: False, &#39;type&#39;: &#39;lines&#39;},</span>
<span class="go"> &#39;title&#39;: {&#39;required&#39;: False, &#39;type&#39;: &#39;string&#39;}}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><tt class="docutils literal"><span class="pre">get_schema</span></tt> takes a path parameter in addition to the content-type
name, because sometimes there are type constraints on content and content
containers.</p>
</div>
</div>
<div class="section" id="get-a-content-object-s-workflow-state">
<span id="get-workflow-example"></span><h2>Get a content object&#8217;s workflow state<a class="headerlink" href="#get-a-content-object-s-workflow-state" title="Permalink to this headline">¶</a></h2>
<p>You can only go so far with creating and updating content before, for instance,
you need to transition the content object from a private state to a public
state. To obtain the transition information, you use``get_workflow``, which
returns a dictionary with two bits of information:</p>
<ol class="arabic simple">
<li>The current workflow <em>state</em> of the content</li>
<li>The available <em>transition(s)</em> the authenticated user can perform</li>
</ol>
<p>Let&#8217;s take a look at the <em>weblion</em> object we created in
<a class="reference internal" href="#post-object-example-create"><em>Creating the content</em></a>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">client</span><span class="o">.</span><span class="n">get_workflow</span><span class="p">(</span><span class="s">&#39;weblion&#39;</span><span class="p">)</span>
<span class="go">{&#39;state&#39;: &#39;private&#39;, &#39;transitions&#39;: [&#39;submit&#39;, &#39;publish&#39;]}</span>
</pre></div>
</div>
</div>
<div class="section" id="transition-a-content-object-s-workflow-state">
<span id="set-workflow-example"></span><h2>Transition a content object&#8217;s workflow state<a class="headerlink" href="#transition-a-content-object-s-workflow-state" title="Permalink to this headline">¶</a></h2>
<p>Using <a class="reference internal" href="api.html#get-workflow-def"><em>get_workflow</em></a> has provided you with available transitions that
can be perform on the requested content object. We can now use <tt class="docutils literal"><span class="pre">set_workflow</span></tt>
to transition the workflow state of the object. Let&#8217;s <em>publish</em> the <em>weblion</em>
object that was create in <a class="reference internal" href="#post-object-example-create"><em>Creating the content</em></a>. In this example the
second parameterーa pathーis optional and will default to the client call
location.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">client</span><span class="o">.</span><span class="n">set_workflow</span><span class="p">(</span><span class="s">&#39;publish&#39;</span><span class="p">,</span> <span class="s">&#39;weblion&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">client</span><span class="o">.</span><span class="n">get_workflow</span><span class="p">(</span><span class="s">&#39;weblion&#39;</span><span class="p">)</span>
<span class="go">{&#39;state&#39;: &#39;published&#39;, &#39;transitions&#39;: [&#39;retract&#39;, &#39;reject&#39;]}</span>
</pre></div>
</div>
</div>
<div class="section" id="get-a-content-object-s-discussion-container">
<span id="get-discussion-example"></span><h2>Get a content object&#8217;s discussion container<a class="headerlink" href="#get-a-content-object-s-discussion-container" title="Permalink to this headline">¶</a></h2>
<p>Use <tt class="docutils literal"><span class="pre">get_discussion</span></tt> to get the discussion container (a.k.a. comments
container) of a content object with the full or relative path to the object.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">client</span><span class="o">.</span><span class="n">get_discussion</span><span class="p">(</span><span class="s">&#39;weblion&#39;</span><span class="p">)</span>
<span class="go">{&#39;1257246779&#39;: {&#39;in_reply_to&#39;: &#39;1257246760&#39;,</span>
<span class="go">                &#39;cooked_text&#39;: &#39;a comment on comment 1&#39;,</span>
<span class="go">                &#39;title&#39;: &#39;comment 1.1&#39;,</span>
<span class="go">                &#39;created&#39;: &#39;2009-11-03 12:12:59&#39;,</span>
<span class="go">                &#39;text&#39;: &#39;a comment on comment 1&#39;,</span>
<span class="go">                &#39;creators&#39;: (&#39;admin&#39;,)},</span>
<span class="go"> &#39;1257246760&#39;: {&#39;in_reply_to&#39;: &#39;&#39;,</span>
<span class="go">                &#39;cooked_text&#39;: &#39;the first comment!&#39;,</span>
<span class="go">                &#39;title&#39;: &#39;comment 1&#39;,</span>
<span class="go">                &#39;created&#39;: &#39;2009-11-03 12:12:40&#39;,</span>
<span class="go">                &#39;text&#39;: &#39;the first comment!&#39;,</span>
<span class="go">                &#39;creators&#39;: (&#39;admin&#39;,)},</span>
<span class="go"> &#39;1257246799&#39;: {&#39;in_reply_to&#39;: &#39;&#39;,</span>
<span class="go">                &#39;cooked_text&#39;: &#39;another comment&#39;,</span>
<span class="go">                &#39;title&#39;: &#39;comment 2&#39;,</span>
<span class="go">                &#39;created&#39;: &#39;2009-11-03 12:13:19&#39;,</span>
<span class="go">                &#39;text&#39;: &#39;another comment&#39;,</span>
<span class="go">                &#39;creators&#39;: (&#39;admin&#39;,)}</span>
<span class="go"> }</span>
</pre></div>
</div>
</div>
<div class="section" id="working-with-binary-data">
<span id="binary-data-example"></span><h2>Working with binary data<a class="headerlink" href="#working-with-binary-data" title="Permalink to this headline">¶</a></h2>
<p>Receiving binary data through the Web Services API is typically marshalled to
a binary object. In Python, XML-RPC binary data is marshaled to
a <tt class="xref py py-class docutils literal"><span class="pre">xmlrpclib.Binary</span></tt> object (see <a class="reference external" href="http://docs.python.org/library/xmlrpclib.html#module-xmlrpclib" title="(in Python v2.7)"><tt class="xref py py-mod docutils literal"><span class="pre">xmlrpclib</span></tt></a>).</p>
<p>To illustrate how this works, we&#8217;ll use the <cite>get_object</cite> call on an Image
object at <tt class="docutils literal"><span class="pre">/plone/images/an-image</span></tt>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">client</span><span class="o">.</span><span class="n">get_object</span><span class="p">([</span><span class="s">&#39;images/an-image&#39;</span><span class="p">])</span>
<span class="go">{&#39;/Plone/images/an-image&#39;: [{&#39;allowDiscussion&#39;: False,</span>
<span class="go">                             &#39;contributors&#39;: [],</span>
<span class="go">                             &#39;creation_date&#39;: &lt;DateTime ...&gt;,</span>
<span class="go">                             &#39;creators&#39;: [&#39;admin&#39;],</span>
<span class="go">                             &#39;description&#39;: &#39;&#39;,</span>
<span class="go">                             &#39;effectiveDate&#39;: None,</span>
<span class="go">                             &#39;excludeFromNav&#39;: False,</span>
<span class="go">                             &#39;expirationDate&#39;: None,</span>
<span class="go">                             &#39;id&#39;: &#39;an-image&#39;,</span>
<span class="go">                             &#39;image&#39;: {&#39;alt&#39;: &#39;An Image&#39;,</span>
<span class="go">                                       &#39;content_type&#39;: &#39;image/jpeg&#39;,</span>
<span class="go">                                       &#39;data&#39;: &lt;xmlrpclib.Binary ...&gt;,</span>
<span class="go">                                       &#39;height&#39;: 464,</span>
<span class="go">                                       &#39;size&#39;: 31503,</span>
<span class="go">                                       &#39;title&#39;: &#39;An Image&#39;,</span>
<span class="go">                                       &#39;width&#39;: 600},</span>

<span class="go">                             &#39;language&#39;: &#39;en&#39;,</span>
<span class="go">                             &#39;location&#39;: &#39;&#39;,</span>
<span class="go">                             &#39;modification_date&#39;: &lt;DateTime ...&gt;,</span>
<span class="go">                             &#39;relatedItems&#39;: [],</span>
<span class="go">                             &#39;rights&#39;: &#39;&#39;,</span>
<span class="go">                             &#39;subject&#39;: [],</span>
<span class="go">                             &#39;title&#39;: &#39;An Image&#39;},</span>
<span class="go">                            &#39;Image&#39;,</span>
<span class="go">                            {}]}</span>
</pre></div>
</div>
<p>Sending binary data has similar needs to receiving it. The XML-RPC library
needs to know how to marshall the content to a XML-RPC Binary type (see the
<a class="reference external" href="http://www.xmlrpc.com/spec">XML-RPC specification</a> for details about
the base64/binary type). In Python, <a class="reference external" href="http://docs.python.org/library/xmlrpclib.html#module-xmlrpclib" title="(in Python v2.7)"><tt class="xref py py-mod docutils literal"><span class="pre">xmlrpclib</span></tt></a> will marshall
<tt class="xref py py-class docutils literal"><span class="pre">xmlrpclib.Binary</span></tt> to the appropriate request format. Here is an
example of how to add a PDF to Plone using the web services API:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">xmlrpclib</span> <span class="kn">import</span> <span class="n">Binary</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&#39;example.pdf&#39;</span><span class="p">,</span> <span class="s">&#39;r&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">binary_data</span> <span class="o">=</span> <span class="n">Binary</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdf_object</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;file&#39;</span><span class="p">:</span> <span class="n">binary_data</span><span class="p">,</span> <span class="s">&#39;title&#39;</span><span class="p">:</span> <span class="s">&quot;Example PDF&quot;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">example_pdf</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">post_object</span><span class="p">({</span><span class="s">&#39;example-pdf&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">pdf_object</span><span class="p">,</span> <span class="s">&#39;File&#39;</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">client</span><span class="o">.</span><span class="n">get_object</span><span class="p">(</span><span class="n">example_pdf</span><span class="p">)</span>
<span class="go">{&#39;/plone/example-pdf&#39;: [{&#39;allowDiscussion&#39;: False,</span>
<span class="go">                         &#39;contributors&#39;: [],</span>
<span class="go">                         &#39;creation_date&#39;: &lt;DateTime ...&gt;,</span>
<span class="go">                         &#39;creators&#39;: [&#39;admin&#39;],</span>
<span class="go">                         &#39;description&#39;: &#39;&#39;,</span>
<span class="go">                         &#39;effectiveDate&#39;: None,</span>
<span class="go">                         &#39;excludeFromNav&#39;: False,</span>
<span class="go">                         &#39;expirationDate&#39;: None,</span>
<span class="go">                         &#39;file&#39;: {&#39;content_type&#39;: &#39;application/pdf&#39;,</span>
<span class="go">                                  &#39;data&#39;: &lt;xmlrpclib.Binary ...&gt;,</span>
<span class="go">                                  &#39;height&#39;: 0,</span>
<span class="go">                                  &#39;size&#39;: 269894,</span>
<span class="go">                                  &#39;title&#39;: &#39;Example PDF&#39;,</span>
<span class="go">                                  &#39;width&#39;: 0},</span>
<span class="go">                         &#39;id&#39;: &#39;example-pdf&#39;,</span>
<span class="go">                         &#39;language&#39;: &#39;en&#39;,</span>
<span class="go">                         &#39;location&#39;: &#39;&#39;,</span>
<span class="go">                         &#39;modification_date&#39;: &lt;DateTime ...&gt;,</span>
<span class="go">                         &#39;relatedItems&#39;: [],</span>
<span class="go">                         &#39;rights&#39;: &#39;&#39;,</span>
<span class="go">                         &#39;subject&#39;: [],</span>
<span class="go">                         &#39;title&#39;: &#39;Example PDF&#39;},</span>
<span class="go">                        &#39;File&#39;,</span>
<span class="go">                        {}]}</span>
</pre></div>
</div>
<div class="section" id="common-gotcha">
<h3>Common gotcha<a class="headerlink" href="#common-gotcha" title="Permalink to this headline">¶</a></h3>
<p>Notice in the above example, that the file key in the
creation dictionary (<tt class="docutils literal"><span class="pre">pdf_object</span></tt>) does not contain a dictionary
like the response from the <a class="reference internal" href="api.html#get-object-def"><em>get_object</em></a> call.</p>
<p>The web services API will not except a dictionary
for binary data fields.
This is a common gotcha, because in most cases
the results of a <a class="reference internal" href="api.html#get-object-def"><em>get_object</em></a> can
be passed directly into a <a class="reference internal" href="api.html#put-object-def"><em>put_object</em></a>
or <a class="reference internal" href="api.html#post-object-def"><em>post_object</em></a> call without issue.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The handling of binary data will likely change in future versions of
wsapi4plone.core.</p>
</div>
<p>To inspect an object for binary data fields,
use the <a class="reference internal" href="api.html#get-schema-def"><em>get_schema</em></a> call
and evaluating the field&#8217;s type value
(see also <a class="reference internal" href="#required-fields-inspection-example"><em>Getting the required fields of a content-type</em></a>).</p>
</div>
</div>
<div class="section" id="working-with-dates-and-times">
<h2>Working with dates and times<a class="headerlink" href="#working-with-dates-and-times" title="Permalink to this headline">¶</a></h2>
<p>Similar to <a class="reference internal" href="#binary-data-example"><em>Working with binary data</em></a>, XML-RPC supports a date and time type.
In Python, <a class="reference external" href="http://docs.python.org/library/xmlrpclib.html#module-xmlrpclib" title="(in Python v2.7)"><tt class="xref py py-mod docutils literal"><span class="pre">xmlrpclib</span></tt></a> marshalls dates and times to
<tt class="xref py py-class docutils literal"><span class="pre">xmlrpclib.DateTime</span></tt>
(or Python&#8217;s <a class="reference external" href="http://docs.python.org/library/datetime.html#module-datetime" title="(in Python v2.7)"><tt class="xref py py-mod docutils literal"><span class="pre">datetime</span></tt></a> type depending
on whether <a class="reference external" href="http://docs.python.org/library/xmlrpclib.html#xmlrpclib.ServerProxy" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">xmlrpclib.ServerProxy</span></tt></a> is instantiated
with <tt class="docutils literal"><span class="pre">use_datetime=True</span></tt>).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It is easier to use Python&#8217;s <a class="reference external" href="http://docs.python.org/library/datetime.html#module-datetime" title="(in Python v2.7)"><tt class="xref py py-mod docutils literal"><span class="pre">datetime</span></tt></a> type rather than
the <a class="reference external" href="http://docs.python.org/library/xmlrpclib.html#module-xmlrpclib" title="(in Python v2.7)"><tt class="xref py py-mod docutils literal"><span class="pre">xmlrpclib</span></tt></a> datetime type.</p>
</div>
<p>To inspect an object for datetime fields,
use the <a class="reference internal" href="api.html#get-schema-def"><em>get_schema</em></a> call
and evaluating the field&#8217;s type value
(see also <a class="reference internal" href="#required-fields-inspection-example"><em>Getting the required fields of a content-type</em></a>).
For example, a Link content-type has a few datetime fields:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">link_schema</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_schema</span><span class="p">(</span><span class="s">&#39;Link&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">link_schema</span> <span class="k">if</span> <span class="n">link_schema</span><span class="p">[</span><span class="n">f</span><span class="p">][</span><span class="s">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;datetime&#39;</span><span class="p">]</span>
<span class="go">[&#39;modification_date&#39;, &#39;creation_date&#39;, &#39;effectiveDate&#39;, &#39;expirationDate&#39;]</span>
</pre></div>
</div>
<p>Here is an example Link (at <tt class="docutils literal"><span class="pre">example-link</span></tt>) output. Notice that
<a class="reference external" href="http://docs.python.org/library/xmlrpclib.html#module-xmlrpclib" title="(in Python v2.7)"><tt class="xref py py-mod docutils literal"><span class="pre">xmlrpclib</span></tt></a> has marshalled the datetime field result
to a <tt class="xref py py-class docutils literal"><span class="pre">xmlrpclib.DateTime</span></tt> object.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">client</span><span class="o">.</span><span class="n">get_object</span><span class="p">([</span><span class="s">&#39;example-link&#39;</span><span class="p">])</span>
<span class="go">{&#39;/plone/example-link&#39;: [{&#39;allowDiscussion&#39;: False,</span>
<span class="go">                          &#39;contributors&#39;: [],</span>
<span class="go">                          &#39;creation_date&#39;: &lt;DateTime &#39;2010-05-27T11:23:14-04:00&#39; at ...&gt;,</span>
<span class="go">                          ...</span>
<span class="go">                          &#39;title&#39;: &#39;example.come&#39;},</span>
<span class="go">                         &#39;Link&#39;,</span>
<span class="go">                         {}]}</span>
</pre></div>
</div>
<p>To update a datetime field simply send it in a format
that the XML-RPC library can marshall.
In Python, an example for updating the creation date would look like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">xmlrpclib</span> <span class="kn">import</span> <span class="n">DateTime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">creation_date</span> <span class="o">=</span> <span class="n">DateTime</span><span class="p">(</span><span class="s">&#39;20110527T11:30:26&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">link_object</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;creation_date&#39;</span><span class="p">:</span> <span class="n">creation_date</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">example_link</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">put_object</span><span class="p">({</span><span class="s">&#39;example-link&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">link_object</span><span class="p">,</span> <span class="s">&#39;Link&#39;</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">client</span><span class="o">.</span><span class="n">get_object</span><span class="p">(</span><span class="n">example_link</span><span class="p">)</span>
<span class="go">{&#39;/plone/example-link&#39;: [{&#39;allowDiscussion&#39;: False,</span>
<span class="go">                          &#39;contributors&#39;: [],</span>
<span class="go">                          &#39;creation_date&#39;: &lt;DateTime &#39;2011-05-27T11:30:26&#39; at ...&gt;,</span>
<span class="go">                          ...</span>
<span class="go">                          &#39;title&#39;: &#39;example.come&#39;},</span>
<span class="go">                         &#39;Link&#39;,</span>
<span class="go">                         {}]}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You may notice fields that have a datetime string. These fields
have not marshalled to an XML-RPC DateTime object because Plone stores them
as strings.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Python Usage Examples (via the interpreter)</a><ul>
<li><a class="reference internal" href="#finding-what-you-re-looking-for">Finding what you&#8217;re looking for</a></li>
<li><a class="reference internal" href="#get-a-content-object">Get a content object</a><ul>
<li><a class="reference internal" href="#analyzing-the-results">Analyzing the results</a></li>
<li><a class="reference internal" href="#get-specific-content-objects-by-path">Get specific content objects by path</a></li>
</ul>
</li>
<li><a class="reference internal" href="#put-or-update-information-on-a-content-object">Put or update information on a content object</a></li>
<li><a class="reference internal" href="#post-a-new-content-object">Post a new content object</a><ul>
<li><a class="reference internal" href="#knowing-what-content-types-are-available">Knowing what content-types are available</a></li>
<li><a class="reference internal" href="#getting-the-required-fields-of-a-content-type">Getting the required fields of a content-type</a></li>
<li><a class="reference internal" href="#creating-the-content">Creating the content</a></li>
</ul>
</li>
<li><a class="reference internal" href="#delete-a-content-object">Delete a content object</a></li>
<li><a class="reference internal" href="#get-the-available-content-types">Get the available content-types</a></li>
<li><a class="reference internal" href="#get-a-content-object-s-structure">Get a content object&#8217;s structure</a></li>
<li><a class="reference internal" href="#get-a-content-object-s-workflow-state">Get a content object&#8217;s workflow state</a></li>
<li><a class="reference internal" href="#transition-a-content-object-s-workflow-state">Transition a content object&#8217;s workflow state</a></li>
<li><a class="reference internal" href="#get-a-content-object-s-discussion-container">Get a content object&#8217;s discussion container</a></li>
<li><a class="reference internal" href="#working-with-binary-data">Working with binary data</a><ul>
<li><a class="reference internal" href="#common-gotcha">Common gotcha</a></li>
</ul>
</li>
<li><a class="reference internal" href="#working-with-dates-and-times">Working with dates and times</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="api.html"
                        title="previous chapter">Web Services API</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="changes.html"
                        title="next chapter">Changelog</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/usage.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="changes.html" title="Changelog"
             >next</a> |</li>
        <li class="right" >
          <a href="api.html" title="Web Services API"
             >previous</a> |</li>
        <li><a href="index.html">Web Services API for Plone v0.2a2 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2010, Michael Mulich.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.7.
    </div>
  </body>
</html>