[migrate_users]
parts =
    export_users
    copy_users
    import_users
    setup_plugins
    dump_memberdata
    copy_memberdata
    load_memberdata

[export_users]
recipe = collective.migrator:export_obj
obj = acl_users/source_users
      acl_users/source_groups
      acl_users/portal_role_manager
      portal_memberdata
instance = remote

[copy_users]
recipe = collective.migrator:copy_file
files = portal_memberadata.zexp
         source_groups.zexp
         source_users.zexp
         portal_role_manager.zexp
source = remote
target = local
source_dir = ${remote:export}
target_dir = ${local:import}

[import_users]
recipe = collective.migrator:import_obj
obj = acl_users/source_users
      acl_users/source_groups
      acl_users/portal_role_manager
      portal_memberdata
instance = local

[setup_plugins]
recipe = collective.migrator:ext_method
source = scripts/setup_plugins.py
func = setup_plugins
output = plugins.out
instance = local

[dump_memberdata]
recipe = collective.migrator:ext_method
source = scripts/memberdata.py
func = dump_memberdata
output = memberdata.txt
instance = remote

[copy_memberdata]
recipe = collective.migrator:copy_file
files = memberdata.txt
source = remote
target = local
source_dir = ${buildout:directory}
target_dir = ${local:extensions}

[load_memberdata]
recipe = collective.migrator:ext_method
source = scripts/memberdata.py
func = load_memberdata
output = memberdata.out
instance = local

