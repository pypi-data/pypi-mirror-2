<html>
<head>
<title>zinnia.templatetags.zcalendar</title>
</head>
<body>
zinnia.templatetags.zcalendar
<style>
.coverage pre {float: left; margin: 0px 1em; border: none;
               padding: 0px; }
.num pre { margin: 0px }
.nocov, .nocov pre {background-color: #faa}
.cov, .cov pre {background-color: #cfc}
div.coverage div { clear: both; height: 1.1em}
</style>
<div class="stats">
Covered: 50 lines<br/>
Missed: 0 lines<br/>
Skipped 13 lines<br/>
Percent: 100 %<br/>

</div>
<div class="coverage">
<div class="cov"><span class="num"><pre> 1</pre></span><pre>&quot;&quot;&quot;Calendar module for Zinnia templatetags&quot;&quot;&quot;</pre></div>
<div class="cov"><span class="num"><pre> 2</pre></span><pre>from datetime import date</pre></div>
<div class="cov"><span class="num"><pre> 3</pre></span><pre>from calendar import HTMLCalendar</pre></div>
<div class="skip"><span class="num"><pre> 4</pre></span><pre></pre></div>
<div class="cov"><span class="num"><pre> 5</pre></span><pre>from django.utils.dates import MONTHS</pre></div>
<div class="cov"><span class="num"><pre> 6</pre></span><pre>from django.utils.dates import WEEKDAYS_ABBR</pre></div>
<div class="cov"><span class="num"><pre> 7</pre></span><pre>from django.utils.formats import get_format</pre></div>
<div class="cov"><span class="num"><pre> 8</pre></span><pre>from django.core.urlresolvers import reverse</pre></div>
<div class="skip"><span class="num"><pre> 9</pre></span><pre></pre></div>
<div class="cov"><span class="num"><pre>10</pre></span><pre>from zinnia.models import Entry</pre></div>
<div class="skip"><span class="num"><pre>11</pre></span><pre></pre></div>
<div class="cov"><span class="num"><pre>12</pre></span><pre>AMERICAN_TO_EUROPEAN_WEEK_DAYS = [6, 0, 1, 2, 3, 4, 5]</pre></div>
<div class="skip"><span class="num"><pre>13</pre></span><pre></pre></div>
<div class="skip"><span class="num"><pre>14</pre></span><pre></pre></div>
<div class="cov"><span class="num"><pre>15</pre></span><pre>class ZinniaCalendar(HTMLCalendar):</pre></div>
<div class="cov"><span class="num"><pre>16</pre></span><pre>    &quot;&quot;&quot;Override of HTMLCalendar&quot;&quot;&quot;</pre></div>
<div class="skip"><span class="num"><pre>17</pre></span><pre></pre></div>
<div class="cov"><span class="num"><pre>18</pre></span><pre>    def __init__(self):</pre></div>
<div class="cov"><span class="num"><pre>19</pre></span><pre>        &quot;&quot;&quot;Retrieve and convert the localized first week day</pre></div>
<div class="cov"><span class="num"><pre>20</pre></span><pre>        at initialization&quot;&quot;&quot;</pre></div>
<div class="cov"><span class="num"><pre>21</pre></span><pre>        HTMLCalendar.__init__(self, AMERICAN_TO_EUROPEAN_WEEK_DAYS[</pre></div>
<div class="cov"><span class="num"><pre>22</pre></span><pre>            get_format('FIRST_DAY_OF_WEEK')])</pre></div>
<div class="skip"><span class="num"><pre>23</pre></span><pre></pre></div>
<div class="cov"><span class="num"><pre>24</pre></span><pre>    def formatday(self, day, weekday):</pre></div>
<div class="cov"><span class="num"><pre>25</pre></span><pre>        &quot;&quot;&quot;Return a day as a table cell with a link</pre></div>
<div class="cov"><span class="num"><pre>26</pre></span><pre>        if entries are published this day&quot;&quot;&quot;</pre></div>
<div class="cov"><span class="num"><pre>27</pre></span><pre>        if day and day in self.day_entries:</pre></div>
<div class="cov"><span class="num"><pre>28</pre></span><pre>            day_date = date(self.current_year, self.current_month, day)</pre></div>
<div class="cov"><span class="num"><pre>29</pre></span><pre>            archive_day_url = reverse('zinnia_entry_archive_day',</pre></div>
<div class="cov"><span class="num"><pre>30</pre></span><pre>                                      args=[day_date.strftime('%Y'),</pre></div>
<div class="cov"><span class="num"><pre>31</pre></span><pre>                                            day_date.strftime('%m'),</pre></div>
<div class="cov"><span class="num"><pre>32</pre></span><pre>                                            day_date.strftime('%d')])</pre></div>
<div class="cov"><span class="num"><pre>33</pre></span><pre>            return '&lt;td class=&quot;%s entry&quot;&gt;&lt;a href=&quot;%s&quot; '\</pre></div>
<div class="cov"><span class="num"><pre>34</pre></span><pre>                   'rel=&quot;archives&quot;&gt;%d&lt;/a&gt;&lt;/td&gt;' % (</pre></div>
<div class="cov"><span class="num"><pre>35</pre></span><pre>                self.cssclasses[weekday], archive_day_url, day)</pre></div>
<div class="skip"><span class="num"><pre>36</pre></span><pre></pre></div>
<div class="cov"><span class="num"><pre>37</pre></span><pre>        return super(ZinniaCalendar, self).formatday(day, weekday)</pre></div>
<div class="skip"><span class="num"><pre>38</pre></span><pre></pre></div>
<div class="cov"><span class="num"><pre>39</pre></span><pre>    def formatmonth(self, theyear, themonth, withyear=True):</pre></div>
<div class="cov"><span class="num"><pre>40</pre></span><pre>        &quot;&quot;&quot;Return a formatted month as a table with</pre></div>
<div class="cov"><span class="num"><pre>41</pre></span><pre>        new attributes computed for formatting a day&quot;&quot;&quot;</pre></div>
<div class="cov"><span class="num"><pre>42</pre></span><pre>        self.current_year = theyear</pre></div>
<div class="cov"><span class="num"><pre>43</pre></span><pre>        self.current_month = themonth</pre></div>
<div class="cov"><span class="num"><pre>44</pre></span><pre>        self.day_entries = [entries.creation_date.day for entries in</pre></div>
<div class="cov"><span class="num"><pre>45</pre></span><pre>                            Entry.published.filter(</pre></div>
<div class="cov"><span class="num"><pre>46</pre></span><pre>                                creation_date__year=theyear,</pre></div>
<div class="cov"><span class="num"><pre>47</pre></span><pre>                                creation_date__month=themonth)]</pre></div>
<div class="skip"><span class="num"><pre>48</pre></span><pre></pre></div>
<div class="cov"><span class="num"><pre>49</pre></span><pre>        return super(ZinniaCalendar, self).formatmonth(</pre></div>
<div class="cov"><span class="num"><pre>50</pre></span><pre>            theyear, themonth, withyear)</pre></div>
<div class="skip"><span class="num"><pre>51</pre></span><pre></pre></div>
<div class="cov"><span class="num"><pre>52</pre></span><pre>    def formatweekday(self, day):</pre></div>
<div class="cov"><span class="num"><pre>53</pre></span><pre>        &quot;&quot;&quot;Return a weekday name translated</pre></div>
<div class="cov"><span class="num"><pre>54</pre></span><pre>        as a table header.&quot;&quot;&quot;</pre></div>
<div class="cov"><span class="num"><pre>55</pre></span><pre>        return '&lt;th class=&quot;%s&quot;&gt;%s&lt;/th&gt;' % (self.cssclasses[day],</pre></div>
<div class="cov"><span class="num"><pre>56</pre></span><pre>                                           WEEKDAYS_ABBR[day].title())</pre></div>
<div class="skip"><span class="num"><pre>57</pre></span><pre></pre></div>
<div class="cov"><span class="num"><pre>58</pre></span><pre>    def formatmonthname(self, theyear, themonth, withyear=True):</pre></div>
<div class="cov"><span class="num"><pre>59</pre></span><pre>        &quot;&quot;&quot;Return a month name translated</pre></div>
<div class="cov"><span class="num"><pre>60</pre></span><pre>        as a table row.&quot;&quot;&quot;</pre></div>
<div class="cov"><span class="num"><pre>61</pre></span><pre>        monthname = '%s %s' % (MONTHS[themonth].title(), theyear)</pre></div>
<div class="cov"><span class="num"><pre>62</pre></span><pre>        return '&lt;tr&gt;&lt;th colspan=&quot;7&quot; class=&quot;month&quot;&gt;%s&lt;/th&gt;&lt;/tr&gt;' % monthname</pre></div>
<div class="skip"><span class="num"><pre>63</pre></span><pre></pre></div>
</div>
</body>
</html>
