{% load redsolutioncms_tags %}
{% raw %}
    {% extends 'pages/base.html' %}
    {% load pages_tags %}
{% endraw %}

{% raw %}
{% if 'redsolutioncms.django-generic-ratings' in cms_settings.installed_packages %}
{% block js %}
{{ block.super }}
	<script type="text/javascript" src="/media/ratings/js/jquery-1.5.1.min.js"></script>
    <script type="text/javascript" src="/media/ratings/js/jquery.MetaData.js"></script>
	<script type="text/javascript" src="/media/ratings/js/jquery.rating.js"></script>
	<script type="text/javascript" src="/media/ratings/js/jquery-ui-1.8.14.custom.min.js"></script>
{% endblock%}
{% block css %}
{{ block.super }}
	<link rel="stylesheet" type="text/css" href="/media/ratings/css/jquery.rating.css" />
{% endblock %}
{% endif %}
{% endraw %}

{% raw %}
{% block content %}
{% endraw %}

{% if pages_settings.default_template_type == 0 %} {# one column #}
    <div class="one-column">
	{% with 'main_content' as placeholder %}
	{% include "pages/redsolutioncms/placeholder_include.html" %}
	{% endwith %}
	</div>
{% endif %}

{% if pages_settings.default_template_type == 1 %} {# two columns #}
    <table>
        <tr>
            <td>
    {% with 'main_content' as placeholder %}
    {% include "pages/redsolutioncms/placeholder_include.html" %}
    {% endwith %}
            </td>
            <td>
    {% with 'right_content' as placeholder %}
    {% include "pages/redsolutioncms/placeholder_include.html" %}
    {% endwith %}
            </td>
        </tr>
    </table>
{% endif %}

{% if 'redsolutioncms.django-generic-ratings' in cms_settings.installed_packages %}{% raw %}
	{% load ratings_tags %}

	{% get_rating_form for current_page as rating_form %}

	<form action="{% url ratings_vote %}" method="post">
    	{% csrf_token %}
    	{{ rating_form }}
    	<p><input type="submit" value="Vote &rarr;"></p>
	</form>

	{% get_rating_score for current_page as score %}
	{% if score %}
	    Average score: {{ score.average|floatformat }}
    	Number of votes: {{ score.num_votes }}
	{% else %}
    	How sad: nobody voted {{ object }}
	{% endif %}
{% endraw %}{% endif %}

{% raw %}
{% endblock %}
{% endraw %}
