application: lovely-gae
version: 1
runtime: python
api_version: 1

handlers:

# static favicon
- url: /(favicon.ico)
  static_files: static/\1
  upload: static/(favicon.ico)

# map all under the /static url to our static directory
- url: /static
  static_dir: static

# enable the remote api see:
# http://code.google.com/appengine/articles/remote_api.html
- url: /remote_api
  script: $PYTHON_LIB/google/appengine/ext/remote_api/handler.py
  login: admin

# register any handlers of the lovely.gae package
- url: /lovely.gae/.*
  script: admin.py
  login: admin

# handle any other urls with the main script
- url: /.*
  script: main.py

# Override the skip files, so that we do not upload the whole packages
# directory. The last line is the most important bit, which makes sure
# that only lovely.gae and tornado eggs get uploaded. The 'foo' string
# also has to be added due to a hacky implementation of the directory
# filtering in the appengine SDK. It checks if it is allowed to access
# /foo in directories, which is not true for the last regex we define.
skip_files: |
  ^(.*/)?(
  (app\.yaml)|
  (app\.yml)|
  (index\.yaml)|
  (index\.yml)|
  (EGG_INFO)|
  (\.egg-info.*)|
  (#.*#)|
  (.*~)|
  (.*\.py[co])|
  (.*/RCS/.*)|
  (\..*)|
  )$|
  ^packages\/(?!(lovely\.gae|tornado|foo))
