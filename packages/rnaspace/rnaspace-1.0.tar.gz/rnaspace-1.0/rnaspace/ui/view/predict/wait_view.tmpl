##
## RNAspace: non-coding RNA annotation platform
## Copyright (C) 2009  CNRS, INRA, INRIA, Univ. Paris-Sud 11
## 
## This program is free software: you can redistribute it and/or modify
## it under the terms of the GNU General Public License as published by
## the Free Software Foundation, either version 3 of the License, or
## (at your option) any later version.
## 
## This program is distributed in the hope that it will be useful,
## but WITHOUT ANY WARRANTY; without even the implied warranty of
## MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
## GNU General Public License for more details.
## 
## You should have received a copy of the GNU General Public License
## along with this program.  If not, see <http://www.gnu.org/licenses/>.
##

#from rnaspace.ui.view.rnaspace_template import rnaspace_template
#extends rnaspace_template

#def predict_id: active
#def header_title: Wait...

#block import_ressources
#end block

#block jquery
var mount_point = "${mount_point}";
#raw
    $("#home_btn").attr("href", mount_point + "index?authkey="+$("#authkey").val());
    $("#manage_btn").attr("href", "");
    $("#manage_btn").click(function() {
        jConfirm("If you get back on this page, you will restart a brand new project, keep on going ?", 'Confirm', function(r) {
            if( r ){
                document.location.replace(mount_point + "/manage");
            }
        });
	return false;
    });
    $("#predict_btn").attr("href", mount_point + "predict/index?authkey="+$("#authkey").val())
    if($("#explore_btn").hasClass("notaccessible")) {
        $("#explore_btn").attr("href", "");
        $("#explore_btn").click(function() { return false; });
    }else{
        $("#explore_btn").attr("href", mount_point + "explore/index?authkey="+$("#authkey").val());
    }
#end raw
#end block

#block javascript
 window.setTimeout('window.location.replace("$url&run=${run_id}")', 1000*5);
#end block

#block page_content

<input type="hidden" id="authkey" value="$authkey" />

#set $emails = ""
#for $i in $email
	#set $emails += "<b>" +  $i + "</b>, "
#end for
#set $emails = $emails[:$len($emails)-2]

<div class="cbb_header">
  <div class="cbb_title">Job submitted</div>
  <div class="cbb_content">
    <br /> <br />
    <img align="left" hspace="10" alt="Wait"
	 src="${mount_point}ressource/img/wait.gif" />
    <br />
    Your request has been successfully submitted.
    Your ID is <b>$id</b>
    <br /><br />
    This page is updated every five  seconds and you will be redirected to
    the results page as soon as the job is completed.
    <br />
    #if $email != '':
    Processing may be long, if you don't want to wait watch your mail box.
    <br />
    An email will be sent to $emails with a link to the result page.
    <br /><br />
    #end if
  </div>
</div>

#end block
