<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="plone">
<body>
    
<metal:body fill-slot="body">
    <metal:block define-macro="content-core"
          tal:define="kssClassesView context/@@kss_field_decorator_view; 
                      getKssClasses nocall:kssClassesView/getKssClassesInlineEditable;
                      templateId template/getId;
                      text python:context.CookedBody(stx_level=2);
                      len_text python:len(text.strip())">

        <div class="visualBoxEntry"
             tal:condition="context/getImage|nothing">

                        <a href="#" 
                       tal:condition="exists:context/image_visual">
                        <img src="" alt=""
                             tal:replace="structure python: path('nocall:context/tag')(scale='visual')" />
                    </a>

                    <a href="#" 
                       tal:condition="not:exists:context/image_visual">                       
                       <img src="" alt=""
                             tal:replace="structure python: path('nocall:context/tag')(scale='preview')" />
                    </a>
                    <div metal:define-macro="text-field-view"
                         class="visualBoxText"
                         tal:define="kss_class python:getKssClasses('text', 
                         templateId=templateId, macro='text-field-view');
                         text text|context/getText|nothing"
             tal:condition="text"
             tal:attributes="class python:test(context.Format() in ('text/structured',
                                                   'text/x-rst', ), 'stx' + kss_class, 'plain' + kss_class)">
            <div metal:define-slot="inside" tal:replace="structure text">The body</div>
        </div>
        </div>

    </metal:block>
</metal:body>

</body>
</html>