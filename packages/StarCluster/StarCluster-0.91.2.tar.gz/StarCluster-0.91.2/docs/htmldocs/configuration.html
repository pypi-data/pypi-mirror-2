<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>StarCluster Configuration File &mdash; StarCluster v0.91 documentation</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '#',
        VERSION:     '0.91',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="StarCluster v0.91 documentation" href="index.html" />
    <link rel="next" title="Using Elastic Block Storage (EBS) Volumes with StarCluster" href="volumes.html" />
    <link rel="prev" title="Installing StarCluster" href="installation.html" /> 
  </head>
  <body>

<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
<a href="index.html"><img src="_static/logo.png" border="0" alt="StarCluster"/></a>
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="volumes.html" title="Using Elastic Block Storage (EBS) Volumes with StarCluster"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="installation.html" title="Installing StarCluster"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">home</a>|&nbsp;</li>
        <li><a href="search.html">search</a>|&nbsp;</li>
       <li><a href="contents.html">documentation </a> &raquo;</li>
 
      </ul>
    </div>

      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference external" href="#">StarCluster Configuration File</a><ul>
<li><a class="reference external" href="#creating-the-config-file">Creating the config file</a></li>
<li><a class="reference external" href="#amazon-web-services-credentials">Amazon Web Services Credentials</a></li>
<li><a class="reference external" href="#amazon-ec2-keypairs">Amazon EC2 Keypairs</a></li>
<li><a class="reference external" href="#defining-cluster-templates">Defining Cluster Templates</a></li>
<li><a class="reference external" href="#defining-multiple-cluster-templates">Defining Multiple Cluster Templates</a></li>
<li><a class="reference external" href="#setting-the-default-cluster-template">Setting the Default Cluster Template</a></li>
<li><a class="reference external" href="#amazon-ebs-volumes">Amazon EBS Volumes</a></li>
<li><a class="reference external" href="#starcluster-plugins">StarCluster Plugins</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="installation.html"
                                  title="previous chapter">Installing StarCluster</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="volumes.html"
                                  title="next chapter">Using Elastic Block Storage (EBS) Volumes with StarCluster</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="_sources/configuration.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="starcluster-configuration-file">
<h1>StarCluster Configuration File<a class="headerlink" href="#starcluster-configuration-file" title="Permalink to this headline">¶</a></h1>
<p>The StarCluster configuration file uses ini formatting (see <a class="reference external" href="http://en.wikipedia.org/wiki/INI_file">http://en.wikipedia.org/wiki/INI_file</a>).
It is made up of various sections which are described in detail here. This document explains how
to configure the three required sections <strong>[aws info]</strong>, <strong>[keypair]</strong>, and <strong>[cluster]</strong> as well as
optional <strong>[global]</strong>, <strong>[volume]</strong>, and <strong>[plugin]</strong> sections.</p>
<div class="section" id="creating-the-config-file">
<h2>Creating the config file<a class="headerlink" href="#creating-the-config-file" title="Permalink to this headline">¶</a></h2>
<p>The default starcluster config lives in ~/.starcluster/config. You can either create this file manually
or have starcluster create it for you with an example configuration template (recommended).</p>
<p>To have StarCluster generate an example configuration file (~/.starcluster/config), simply run &#8220;starcluster help&#8221;
at the command-line. Provided that the configuration file does not exist, you will see the following:</p>
<div class="highlight-none"><div class="highlight"><pre>user@localhost$ starcluster help
StarCluster - (http://web.mit.edu/starcluster)
Software Tools for Academics and Researchers (STAR)
Please submit bug reports to starcluster@mit.edu

cli.py:475 - ERROR - Config file /home/user/.starcluster/config does not exist

Options:
--------
[1] Show the StarCluster config template
[2] Write config template to /home/user/.starcluster/config
[q] Quit

Plase enter your selection:
</pre></div>
</div>
<p>Selecting 1 will print the example configuration file template to standard output.</p>
<p>Selecting 2 will write the configuration file template to ~/.starcluster/config</p>
<p>The configuration template provided by StarCluster should be ready to go out-of-the-box after filling in your Amazon Web
Services credentials and setting up a keypair. This example config provides a simple <em>cluster template</em> called &#8216;smallcluster&#8217;.
This &#8216;smallcluster&#8217; template is also set as the default <em>cluster template</em>. The following sections explain each section of the
config and their options.</p>
</div>
<div class="section" id="amazon-web-services-credentials">
<h2>Amazon Web Services Credentials<a class="headerlink" href="#amazon-web-services-credentials" title="Permalink to this headline">¶</a></h2>
<p>The first required section in the configuration file is <strong>[aws info]</strong>. This section specifies all of your
AWS credentials. The following settings are required</p>
<div class="highlight-ini"><div class="highlight"><pre><span class="k">[aws info]</span>
<span class="c"># replace these with your AWS keys (required)</span>
<span class="na">aws_access_key_id</span> <span class="o">=</span> <span class="s">#your_aws_access_key_id</span>
<span class="na">aws_secret_access_key</span> <span class="o">=</span> <span class="s">#your_secret_access_key</span>
<span class="c"># these settings are optional and only used for creating new AMIs</span>
<span class="na">aws_user_id</span><span class="o">=</span> <span class="s">#your userid</span>
<span class="na">ec2_cert</span> <span class="o">=</span> <span class="s">/path/to/your/ec2_cert.pem</span>
<span class="na">ec2_private_key</span> <span class="o">=</span> <span class="s">/path/to/your/ec2_pk.pem</span>
</pre></div>
</div>
</div>
<div class="section" id="amazon-ec2-keypairs">
<h2>Amazon EC2 Keypairs<a class="headerlink" href="#amazon-ec2-keypairs" title="Permalink to this headline">¶</a></h2>
<p>In addition to supplying your <strong>[aws info]</strong> you must also define at least one <strong>[keypair]</strong> section that
represents one of your keypairs on Amazon EC2. You can also define a new <strong>[keypair]</strong> section for each Amazon EC2
keypair you want to use with StarCluster.</p>
<p>As an example, suppose we have two keypairs on Amazon EC2 that we wish to use with StarCluster called &#8220;mykeypair1&#8221;
and &#8220;mykeypair2&#8221;.  To configure StarCluster for these keypairs we define a <strong>[keypair]</strong> section for each of them
in the configuration file:</p>
<div class="highlight-ini"><div class="highlight"><pre><span class="k">[keypair mykeypair1]</span>
<span class="c"># this is the path to your openssh private key for mykeypair1</span>
<span class="na">key_location</span><span class="o">=</span><span class="s">/path/to/your/mykeypair1.rsa</span>

<span class="k">[keypair mykeypair2]</span>
<span class="c"># this is the path to your openssh private key for mykeypair2</span>
<span class="na">key_location</span><span class="o">=</span><span class="s">/path/to/your/mykeypair2.rsa</span>
</pre></div>
</div>
<p>These keypair sections can now be referenced in a <em>cluster templates</em>&#8216; <strong>keyname</strong> setting as we&#8217;ll show below in an
example <em>cluster template</em>.</p>
</div>
<div class="section" id="defining-cluster-templates">
<h2>Defining Cluster Templates<a class="headerlink" href="#defining-cluster-templates" title="Permalink to this headline">¶</a></h2>
<p>In order to launch StarCluster(s) on Amazon EC2, you must first provide a <em>cluster template</em> that contains all of the
configuration for the cluster. A <em>cluster template</em> is simply a <strong>[cluster]</strong> section in the config. Once a <em>cluster
template</em> has been defined, you can launch multiple StarClusters from it. Below is an example <em>cluster template</em> called
&#8216;smallcluster&#8217; which defines a 2-node cluster using <em>m1.small</em> EC2 instances and the mykeypair1 keypair we defined above.</p>
<div class="highlight-ini"><div class="highlight"><pre><span class="c"># Sections starting with &quot;cluster&quot; define your cluster templates</span>
<span class="c"># The section name is the name you give to your cluster template e.g.:</span>
<span class="k">[cluster smallcluster]</span>
<span class="c"># change this to the name of one of the keypair sections defined above</span>
<span class="c"># (see the EC2 getting started guide tutorial on using ec2-add-keypair to learn</span>
<span class="c"># how to create new keypairs)</span>
<span class="na">keyname</span> <span class="o">=</span> <span class="s">mykeypair1</span>

<span class="c"># number of ec2 instances to launch</span>
<span class="na">cluster_size</span> <span class="o">=</span> <span class="s">2</span>

<span class="c"># create the following user on the cluster</span>
<span class="na">cluster_user</span> <span class="o">=</span> <span class="s">sgeadmin</span>
<span class="c"># optionally specify shell (defaults to bash)</span>
<span class="c"># options: bash, zsh, csh, ksh, tcsh</span>
<span class="na">cluster_shell</span> <span class="o">=</span> <span class="s">bash</span>

<span class="c"># AMI for master node. Defaults to NODE_IMAGE_ID if not specified</span>
<span class="c"># The base i386 StarCluster AMI is ami-0330d16a</span>
<span class="c"># The base x86_64 StarCluster AMI is ami-0f30d166</span>
<span class="na">master_image_id</span> <span class="o">=</span> <span class="s">ami-0330d16a</span>
<span class="c"># instance type for master node</span>
<span class="na">master_instance_type</span> <span class="o">=</span> <span class="s">m1.small</span>

<span class="c"># AMI for worker nodes. Also used for the master node if MASTER_IMAGE_ID is not specified</span>
<span class="c"># The base i386 StarCluster AMI is ami-0330d16a</span>
<span class="c"># The base x86_64 StarCluster AMI is ami-0f30d166</span>
<span class="na">node_image_id</span> <span class="o">=</span> <span class="s">ami-0330d16a</span>

<span class="c"># instance type</span>
<span class="na">node_instance_type</span> <span class="o">=</span> <span class="s">m1.small</span>

<span class="c"># availability zone</span>
<span class="na">availability_zone</span> <span class="o">=</span> <span class="s">us-east-1c</span>
</pre></div>
</div>
</div>
<div class="section" id="defining-multiple-cluster-templates">
<h2>Defining Multiple Cluster Templates<a class="headerlink" href="#defining-multiple-cluster-templates" title="Permalink to this headline">¶</a></h2>
<p>You are not limited to defining just one <em>cluster template</em>. StarCluster allows you to define multiple independent cluster
templates by simply creating a new <strong>[cluster]</strong> section with all of the same settings (different values of course).</p>
<p>However, you may find that defining new <em>cluster templates</em> is some what repetitive with respect to redefining the same
settings over and over. To remedy this situation, StarCluster allows <em>cluster templates</em> to extend other <em>cluster
templates</em>:</p>
<div class="highlight-ini"><div class="highlight"><pre><span class="k">[cluster mediumcluster]</span>
<span class="c"># Declares that this cluster uses smallcluster&#39;s settings as defaults</span>
<span class="na">extends</span> <span class="o">=</span> <span class="s">smallcluster</span>
<span class="c"># this rest of this section is identical to smallcluster except for the following settings:</span>
<span class="na">keyname</span> <span class="o">=</span> <span class="s">mykeypair2</span>
<span class="na">node_instance_type</span> <span class="o">=</span> <span class="s">c1.xlarge</span>
<span class="na">cluster_size</span> <span class="o">=</span> <span class="s">8</span>
<span class="na">volumes</span> <span class="o">=</span> <span class="s">biodata2</span>
</pre></div>
</div>
<p>In the example above, <em>mediumcluster</em> will use all of <em>smallcluster</em>&#8216;s settings as defaults. All other settings in the <em>mediumcluster</em>
template override these defaults. For the <em>mediumcluster</em> template above, we can see that <em>mediumcluster</em> is the same as <em>smallcluster</em>
except for its keyname, node_instance_type, cluster_size, and volumes settings.</p>
</div>
<div class="section" id="setting-the-default-cluster-template">
<h2>Setting the Default Cluster Template<a class="headerlink" href="#setting-the-default-cluster-template" title="Permalink to this headline">¶</a></h2>
<p>StarCluster allows you to specify a default <em>cluster template</em> to be used when using the &#8220;start&#8221; command. This is useful for
users that mostly use a single <em>cluster template</em>. To define a default <em>cluster template</em>, define a <strong>[global]</strong> section and
configure the <strong>default_template</strong> setting:</p>
<div class="highlight-ini"><div class="highlight"><pre><span class="k">[global]</span>
<span class="na">default_template</span> <span class="o">=</span> <span class="s">smallcluster</span>
</pre></div>
</div>
<p>The above example sets the &#8216;smallcluster&#8217; <em>cluster template</em> as the default.</p>
</div>
<div class="section" id="amazon-ebs-volumes">
<h2>Amazon EBS Volumes<a class="headerlink" href="#amazon-ebs-volumes" title="Permalink to this headline">¶</a></h2>
<p>StarCluster has the ability to use Amazon EBS volumes to provide persistent data storage on a given cluster. If you wish to use
EBS volumes with StarCluster you will need to define a <strong>[volume]</strong> section in the configuration file for each volume you wish to
use with StarCluster and then add this <strong>[volume]</strong> section name to a <em>cluster template</em>&#8216;s <strong>volumes</strong> setting. Please note that
using EBS volumes with StarCluster is completely optional. If you do not wish to use EBS volumes with StarCluster, simply do not
define any <strong>[volume]</strong> sections and remove or comment-out the <strong>volumes</strong> setting from your <em>cluster template(s)</em>.</p>
<p>However, if you do not use an EBS volume with StarCluster, any data that you wish to keep around after shutdown
must be manually copied somewhere outside of the cluster (e.g. download the data locally or move it to S3 manually). This is because
local instance storage on EC2 is ephemeral and does not persist after an instance has been shutdown. The advantage of using EBS
volumes with StarCluster is that when you shutdown a particular cluster, any data saved on an EBS volume attached to that cluster
will be available the next time the volume is attached to another cluster (or EC2 instance).</p>
<p>To configure an EBS volume for use with Starcluster, define a new <strong>[volume]</strong> section for each EBS volume. For example, suppose
we have two volumes we&#8217;d like to use: vol-c9999999 and vol-c8888888. Below is an example configuration for these volumes:</p>
<div class="highlight-ini"><div class="highlight"><pre><span class="k">[volume myvoldata1]</span>
<span class="c"># this is the Amazon EBS volume id</span>
<span class="na">volume_id</span><span class="o">=</span><span class="s">vol-c9999999</span>
<span class="c"># the path to mount this EBS volume on</span>
<span class="c"># (this path will also be nfs shared to all nodes in the cluster)</span>
<span class="na">mount_path</span><span class="o">=</span><span class="s">/home</span>

<span class="k">[volume myvoldata2]</span>
<span class="na">volume_id</span><span class="o">=</span><span class="s">vol-c8888888</span>
<span class="na">mount_path</span><span class="o">=</span><span class="s">/scratch</span>

<span class="k">[volume myvoldata2-alternate]</span>
<span class="c"># same volume as myvoldata2 but uses 2nd partition instead of 1st</span>
<span class="na">volume_id</span><span class="o">=</span><span class="s">vol-c8888888</span>
<span class="na">mount_path</span><span class="o">=</span><span class="s">/scratch2</span>
<span class="na">partition</span><span class="o">=</span><span class="s">2</span>
</pre></div>
</div>
<p>StarCluster by default attempts to mount the first partition in the volume onto the master node. It is possible to use a different
partition by configuring a <strong>partition</strong> setting in your <strong>[volume]</strong> section as in the <em>myvoldata2-alternate</em> example above.</p>
<p>After defininig one or more <strong>[volume]</strong> sections, you then need to add them to a <em>cluster template</em> in order to use them. To do this,
specify the <strong>[volume]</strong> section name(s) in the <strong>volumes</strong> setting in one or more of your <em>cluster templates</em>. For example, to use both
myvoldata1 and myvoldata2 from the above example in a <em>cluster template</em> called <em>smallcluster</em>:</p>
<div class="highlight-ini"><pre>[cluster smallcluster]
...
volumes = myvoldata1, myvoldata2
...</pre>
</div>
<p>Now any time a cluster is started using the <em>smallcluster</em> template, myvoldata1 will be mounted to /home on the master, myvoldata2 will
be mounted to /scratch on the master, and both /home and /scratch will be NFS shared to the rest of the cluster nodes.</p>
</div>
<div class="section" id="starcluster-plugins">
<h2>StarCluster Plugins<a class="headerlink" href="#starcluster-plugins" title="Permalink to this headline">¶</a></h2>
<p>StarCluster also has support for user contributed plugins (see <a class="reference external" href="plugins.html"><em>StarCluster Plugin System</em></a>).  To configure a <em>cluster template</em> to use a particular
plugin, we must first create a plugin section for each plugin we wish to use. For example, suppose we have two plugins myplug1 and myplug2:</p>
<div class="highlight-ini"><div class="highlight"><pre><span class="k">[plugin myplug1]</span>
<span class="na">setup_class</span> <span class="o">=</span> <span class="s">myplug1.SetupClass</span>
<span class="na">myplug1_arg_one</span> <span class="o">=</span> <span class="s">2</span>

<span class="k">[plugin myplug2]</span>
<span class="na">setup_class</span> <span class="o">=</span> <span class="s">myplug2.SetupClass</span>
<span class="na">myplug2_arg_one</span> <span class="o">=</span> <span class="s">3</span>
</pre></div>
</div>
<p>In this example, myplug{1,2}_arg_one are arguments to the plugin&#8217;s <em>setup_class</em>. The &#8216;myplug{1,2}_arg_one&#8217; variable names were made up
for this example.  The names of these arguments depend on the plugin being used. Some plugins may not even have arguments.</p>
<p>After you&#8217;ve defined some <strong>[plugin]</strong> sections, you can reference them in a <em>cluster template</em> like so:</p>
<div class="highlight-ini"><div class="highlight"><pre><span class="k">[cluster mediumcluster]</span>
<span class="c"># Declares that this cluster uses smallcluster&#39;s settings as defaults</span>
<span class="na">extends</span> <span class="o">=</span> <span class="s">smallcluster</span>
<span class="c"># this rest of this section is identical to smallcluster except for the following settings:</span>
<span class="na">keyname</span> <span class="o">=</span> <span class="s">mykeypair2</span>
<span class="na">node_instance_type</span> <span class="o">=</span> <span class="s">c1.xlarge</span>
<span class="na">cluster_size</span> <span class="o">=</span> <span class="s">8</span>
<span class="na">volumes</span> <span class="o">=</span> <span class="s">biodata2</span>
<span class="na">plugins</span> <span class="o">=</span> <span class="s">myplug1, myplug2</span>
</pre></div>
</div>
<p>Notice the added <em>plugins</em> setting for the &#8216;mediumcluster&#8217; template. This setting instructs StarCluster to first run the &#8216;myplug1&#8217; plugin
and then the &#8216;myplug2&#8217; plugin afterwards. Reversing myplug1/myplug2 in the plugins setting in the above example would reverse the order
of execution.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="volumes.html" title="Using Elastic Block Storage (EBS) Volumes with StarCluster"
             >next</a> |</li>
        <li class="right" >
          <a href="installation.html" title="Installing StarCluster"
             >previous</a> |</li>
        <li><a href="index.html">home</a>|&nbsp;</li>
        <li><a href="search.html">search</a>|&nbsp;</li>
       <li><a href="contents.html">documentation </a> &raquo;</li>
 
      </ul>
    </div>
    <div class="footer">
      &copy; Copyright 2010, Software Tools for Academics and Researchers.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.5.
    </div>
  </body>
</html>