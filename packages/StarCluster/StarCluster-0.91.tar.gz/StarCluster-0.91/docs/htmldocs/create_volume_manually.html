<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Manually Creating an EBS Volume for Use with StarCluster &mdash; StarCluster v0.91 documentation</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '#',
        VERSION:     '0.91',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="StarCluster v0.91 documentation" href="index.html" />
    <link rel="up" title="Using Elastic Block Storage (EBS) Volumes with StarCluster" href="volumes.html" />
    <link rel="next" title="Launching a StarCluster on Amazon EC2" href="launch.html" />
    <link rel="prev" title="Using Elastic Block Storage (EBS) Volumes with StarCluster" href="volumes.html" /> 
  </head>
  <body>

<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
<a href="index.html"><img src="_static/logo.png" border="0" alt="StarCluster"/></a>
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="launch.html" title="Launching a StarCluster on Amazon EC2"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="volumes.html" title="Using Elastic Block Storage (EBS) Volumes with StarCluster"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">home</a>|&nbsp;</li>
        <li><a href="search.html">search</a>|&nbsp;</li>
       <li><a href="contents.html">documentation </a> &raquo;</li>

          <li><a href="volumes.html" accesskey="U">Using Elastic Block Storage (EBS) Volumes with StarCluster</a> &raquo;</li> 
      </ul>
    </div>

      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference external" href="#">Manually Creating an EBS Volume for Use with StarCluster</a><ul>
<li><a class="reference external" href="#initializing-a-new-ebs-volume">Initializing a New EBS Volume</a></li>
<li><a class="reference external" href="#creating-a-new-ebs-volume">Creating a New EBS Volume</a></li>
<li><a class="reference external" href="#partitioning-and-formatting-the-new-volume">Partitioning and Formatting the New Volume</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="volumes.html"
                                  title="previous chapter">Using Elastic Block Storage (EBS) Volumes with StarCluster</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="launch.html"
                                  title="next chapter">Launching a StarCluster on Amazon EC2</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="_sources/create_volume_manually.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="manually-creating-an-ebs-volume-for-use-with-starcluster">
<h1>Manually Creating an EBS Volume for Use with StarCluster<a class="headerlink" href="#manually-creating-an-ebs-volume-for-use-with-starcluster" title="Permalink to this headline">¶</a></h1>
<div class="section" id="initializing-a-new-ebs-volume">
<h2>Initializing a New EBS Volume<a class="headerlink" href="#initializing-a-new-ebs-volume" title="Permalink to this headline">¶</a></h2>
<p>StarCluster has the ability to use an Amazon Elastic Block Storage device for
persistent storage. This device is attached to the master node of the cluster and
then mounted to <em>MOUNT_PATH</em> specified in the config.  The device is then shared
across the nodes using the network file system (NFS).</p>
<p>To use EBS for persistent storage you must first create a new EBS volume,
partition the volume, and then format the partitions. Below are instructions
for creating and formating a new EBS volume for use with StarCluster.</p>
<p><strong>NOTE:</strong> These instructions only need to be followed the first time you create
an EBS volume.</p>
</div>
<div class="section" id="creating-a-new-ebs-volume">
<h2>Creating a New EBS Volume<a class="headerlink" href="#creating-a-new-ebs-volume" title="Permalink to this headline">¶</a></h2>
<p>For now, these instructions utilize the ElasticFox Firefox plugin to create
the EBS volume. In the next release, StarCluster will provide a command line
option for creating and initializing a new EBS volume. Nevertheless, ElasticFox
is a very useful tool for managing your EC2 instances, images, volumes, etc.</p>
<p>After installing Firefox with the latest ElasticFox addon, follow the steps
below to create and initialize your EBS volume.</p>
<p>1. Open ElasticFox by first opening Firefox and then going to Tools -&gt; ElasticFox
in the main menu:</p>
<img alt="_images/openelasticfox.png" src="_images/openelasticfox.png" />
<p>2. Add your AWS Credentials to ElasticFox by clicking the Credentials button,
filling in your AWS account info, and pressing the <strong>Add</strong> button.</p>
<img alt="_images/setupaccount.png" src="_images/setupaccount.png" />
<p>3. After you&#8217;ve entered your AWS Credentials in ElasticFox, navigate to the
<em>Volumes and Snapshots</em> tab in ElasticFox.</p>
<img alt="_images/volumesandsnapshots.png" src="_images/volumesandsnapshots.png" />
<p>4. Next we&#8217;ll add a new Elastic Block Storage volume by clicking the <em>plus</em> icon and
providing the Size, Availability Zone (<strong>remember this!!!</strong>), and optionally any
Tag (ie description) you want to apply (leave <strong>SNAP ID</strong> blank)</p>
<img alt="_images/createvolume.png" src="_images/createvolume.png" />
<ol class="arabic simple" start="5">
<li>Press the Create button to create the volume</li>
</ol>
</div>
<div class="section" id="partitioning-and-formatting-the-new-volume">
<h2>Partitioning and Formatting the New Volume<a class="headerlink" href="#partitioning-and-formatting-the-new-volume" title="Permalink to this headline">¶</a></h2>
<p>The previous steps created a new Elastic Block Storage device. However, this device
has not yet been partitioned and formatted. To do this, we&#8217;ll launch a m1.small instance
in the same availability zone that we created the volume in. We will then attach the EBS
device to this instance, partition the device with one partition that takes up the entire
device, and then format that partition using the ext3 filesystem.</p>
<p>1. In ElasticFox switch over to the Images tab, type StarCluster into the search
box, and right click the &#8216;StarCluster i386&#8217; image and select Launch instance(s)
of this AMI</p>
<img alt="_images/launchstarclusterami.png" src="_images/launchstarclusterami.png" />
<p>2. In the dialog that pops up, make sure to select the same Availability Zone you
used to create the EBS volume in the previous section. This is needed in order to
attach the volume to the new instance. Also, be sure to select your AWS keypair.</p>
<img alt="_images/launchinstancedialog.png" src="_images/launchinstancedialog.png" />
<p>3. Switch over to the Instances tab and continue to press the refresh tab every
few minutes or so until the instance is in a running state</p>
<img alt="_images/runninginstance.png" src="_images/runninginstance.png" />
<p>4. Once the instance is running, switch over to the Volumes and Snapshots tab,
right click your volume, and select Attach Volume</p>
<img alt="_images/attachvolume.png" src="_images/attachvolume.png" />
<p>5. In the dialog that pops up, select the instance&#8217;s id in the instance combo box
and put /dev/sdj in the device section and press OK. If you don&#8217;t see your instance
in the combo list, this is most likely due to your instance not being launched in the
same availability zone as your EBS volume.</p>
<img alt="_images/attachdialog.png" src="_images/attachdialog.png" />
<p>6. Refresh the Volumes and Snapshots tab every few minutes until the volume is
attached.</p>
<p>7. Once the volume has been attached to the instance, ssh into the instance using
your AWS Keypair. This can be done directly using PuTTY or OpenSSH. You can also
do this through ElasticFox in the Instances tab by right clicking the instance and
selecting <em>Connect to Public DNS Name</em>. This will launch a terminal and attempt to
login to the instance as root via SSH:</p>
<img alt="_images/connecttoinstance.png" src="_images/connecttoinstance.png" />
<p>8. After logging into the server as root, run the following command to
automatically partition the volume with one Linux partition (/dev/sdj1) that takes
up the entire volume:</p>
<div class="highlight-none"><div class="highlight"><pre>echo &quot;,,L&quot; | sfdisk /dev/sdj
</pre></div>
</div>
<p>The output should be similar to:</p>
<div class="highlight-none"><div class="highlight"><pre>$ echo &quot;,,L&quot; | sfdisk /dev/sdj
Checking that no-one is using this disk right now ...
OK


Disk /dev/sdj: 1014 cylinders, 62 heads, 62 sectors/track
Old situation:
Units = cylinders of 1968128 bytes, blocks of 1024 bytes, counting from 0
...
...
</pre></div>
</div>
<p>9. Next, format /dev/sdj1 with the ext3 filesystem by running the following
command as root:</p>
<div class="highlight-none"><div class="highlight"><pre>mkfs.ext3 /dev/sdj1
</pre></div>
</div>
<p>The output should be similar to:</p>
<div class="highlight-none"><div class="highlight"><pre>$ mkfs.ext3 /dev/sdj1
mke2fs 1.41.3 (12-Oct-2008)
Filesystem label=
OS type: Linux
Block size=4096 (log=2)
Fragment size=4096 (log=2)
121920 inodes, 487226 blocks
24361 blocks (5.00%) reserved for the super user
First data block=0
Maximum filesystem blocks=499122176
15 block groups
32768 blocks per group, 32768 fragments per group
8128 inodes per group
Superblock backups stored on blocks:
32768, 98304, 163840, 229376, 294912


Writing inode tables: done
Creating journal (8192 blocks): done
Writing superblocks and filesystem accounting information: done

This filesystem will be automatically checked every 27 mounts or
180 days, whichever comes first. Use tune2fs -c or -i to override.
</pre></div>
</div>
<p>10. Congratulations!!! You&#8217;ve now successfully initialized your EBS volume. Be
sure to enable the EBS settings in the StarCluster configuration file in order
to use your new EBS volume.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="launch.html" title="Launching a StarCluster on Amazon EC2"
             >next</a> |</li>
        <li class="right" >
          <a href="volumes.html" title="Using Elastic Block Storage (EBS) Volumes with StarCluster"
             >previous</a> |</li>
        <li><a href="index.html">home</a>|&nbsp;</li>
        <li><a href="search.html">search</a>|&nbsp;</li>
       <li><a href="contents.html">documentation </a> &raquo;</li>

          <li><a href="volumes.html" >Using Elastic Block Storage (EBS) Volumes with StarCluster</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      &copy; Copyright 2010, Software Tools for Academics and Researchers.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.5.
    </div>
  </body>
</html>