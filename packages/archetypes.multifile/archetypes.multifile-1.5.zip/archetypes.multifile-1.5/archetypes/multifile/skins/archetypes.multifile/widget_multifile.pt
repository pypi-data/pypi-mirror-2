<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      i18n:domain="archetypes.multifile">

  <head><title></title></head>

  <body>

    <!-- File Widgets -->

    <div metal:define-macro="file_view">
      <metal:label define-slot="widget_label" />
      <tal:define define="units accessor;
						  portal_url context/@@plone_portal_state/portal_url;
						  show_content_type field/widget/show_content_type">
		<ul>
        <tal:rep repeat="unit units">
			<li>
      			  <tal:block define="size unit/get_size;
			                           icon unit/icon;
			                           content_type unit/content_type;
			                           filename unit/filename"
			                   condition="python:size &gt; 0">

			          <tal:link>
			              <a href="" 
								tal:attributes="href string:${context/absolute_url}/at_multi_download/$fieldName?name=$filename">
			                <img tal:condition="icon" src=""
			                     tal:attributes="src string:${icon}"/>
			                <b tal:content="filename"></b></a>
							<tal:type condition="show_content_type">
				                (<span tal:content="content_type">ContentType</span>
				                <tal:size content="python:'%sKb' % (size / 1024)">0Kb</tal:size>)
							</tal:type>
			          </tal:link>
              
			        </tal:block>
			</li>
        </tal:rep>    
      </tal:define>
      
    </div>

    <metal:define define-macro="file_edit">
      <metal:label define-slot="widget_label" />
      <tal:define define="units accessor">
        <tal:rep repeat="unit units">
        <tal:block define="size unit/get_size;
                           icon unit/icon | nothing;
                           content_type unit/content_type;
                           filename unit/filename"
                   condition="python:size &gt; 0">

          <tal:link>
               <div class="multifile-file-list">
              <a href="" tal:attributes="href string:${here/absolute_url}/at_multi_download/$fieldName?name=$filename">
                <img tal:condition="icon" src=""
                     tal:attributes="src string:${here/portal_url}/$icon"/>
                <b tal:content="filename"></b></a>
                (<span tal:content="content_type">ContentType</span>
                <tal:size content="python:'%sKb' % (size / 1024)">0Kb</tal:size>)
                
              <input type="checkbox"             
                class="noborder multi-file-hidden"
                name="delete:list"
                value="value"
                tal:attributes="value filename;name string:${fieldName}_d:list;
                    id string:${filename}_deleteCheckBox"
                />
              <a href="javascript:;" onclick="addEvent();"
                 tal:attributes="onclick string:return deleteFile('${filename}_deleteCheckBox')">
					<tal:remove i18n:translate="label_remove_file">Remove File</tal:remove></a>
                </div>
          </tal:link>
        </tal:block>
        </tal:rep>    
      </tal:define>

      <metal metal:use-macro="here/widget_multifile/macros/file_upload"/>
    </metal:define>


    <metal:define define-macro="file_upload">
		<br/>
        <input type="file"
               size="30"
               tabindex=""
               tal:attributes="name string:${fieldName}_f:list;
                               id string:${fieldName}_f:list;
                               tabindex tabindex/next|nothing;
							   onchange string:return addEvent('${fieldName}_f');
							  " />
              
              <br />
                        
        <input type="hidden" value="0" id="theValue" />
        <input type="hidden"
				id="multifile-remove-label"
				value="Remove"
				i18n:attributes="value" />

        <div class="email-link" id="myDiv"> </div>
              
        <input type="hidden" value="" id="theFile" name="theFile"/>
            
    </metal:define>

    <metal:define define-macro="view">
      <metal:use use-macro="here/widget_multifile/macros/file_view" />
    </metal:define>

    <metal:define define-macro="edit">
      <metal:use use-macro="field_macro | here/widgets/field/macros/edit">
        <metal:fill fill-slot="widget_body">
          <metal:use use-macro="here/widget_multifile/macros/file_edit" />
        </metal:fill>
      </metal:use>
    </metal:define>

    <metal:define define-macro="search">
      <metal:use use-macro="here/widget_multifile/macros/edit" />
    </metal:define>

  </body>

</html>
