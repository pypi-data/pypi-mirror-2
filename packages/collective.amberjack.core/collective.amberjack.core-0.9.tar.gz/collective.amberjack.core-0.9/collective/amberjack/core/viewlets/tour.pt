<tal:viewlet condition="view/enabled" i18n:domain="collective.amberjack.core">
<div class="ajTourDef" style="display:none" tal:attributes="id view/tourId">
  <tal:steps repeat="macrostep view/getMacroSteps">
    <div tal:attributes="title macrostep/url;
                         xpath macrostep/xpath;
                         xcontent macrostep/xcontent"
         tal:define="errors python:macrostep.validate(context, request)">
      <dl tal:condition="errors"
          tal:repeat="error errors"
          class="portalMessage warning">
        <dt i18n:domain="plone" i18n:translate="">Warning</dt>
        <dd tal:content="error">Error message</dd>
      </dl>
      <h2 tal:content="macrostep/title">the title of a macro step</h2>
      <div tal:content="structure macrostep/text">the description for the user of a macro step</div>

      <ul class="ajSteps">
        <tal:ajsteps repeat="step macrostep/steps">
          <tal:ajstep define="step_nr python:view.getStepNumber(step)">
            <li>
              <div class="ajDescr">
                <span tal:replace="structure step/description">every step has a brief explanation of what to do</span>
              </div>
              <a href="" onclick="doStep(this); return false" 
                 tal:attributes="class string:ajStep-${step_nr} ajLink;
                                 style step/display;
                                 onclick python:errors and 'return false' or default">&gt;&gt;</a>
			  <span class="visualClear"></span>
            </li>
          </tal:ajstep>
        </tal:ajsteps>
      </ul>
      <div id="ajLastStep"
          tal:condition="repeat/macrostep/end">
        <span tal:define="next_tour view/nextTour"
              tal:condition="next_tour"
              tal:omit-tag="">
          <span i18n:translate="next-tour">Next tour:</span>
          <a class="ajNextUrl"
             tal:attributes="href next_tour/url"
             tal:content="next_tour/title">next tour title</a>
        </span>
      </div>
    </div>
  </tal:steps>
  <script type="text/ecmascript" tal:content="view/javascriptSteps" />
</div>
</tal:viewlet>
