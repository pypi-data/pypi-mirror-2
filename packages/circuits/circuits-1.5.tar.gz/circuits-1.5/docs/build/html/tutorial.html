

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Tutorial &mdash; circuits v1.5 documentation</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.5',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="circuits v1.5 documentation" href="index.html" />
    <link rel="next" title="Manual" href="manual.html" />
    <link rel="prev" title="Installing" href="installing.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="manual.html" title="Manual"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="installing.html" title="Installing"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">circuits v1.5 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="tutorial">
<h1>Tutorial<a class="headerlink" href="#tutorial" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>Welcome to the circuits tutorial. Let&#8217;s get a few things out of the way...</p>
<p>As mentioned in the README (<em>included in the circuits distribution</em>) and in
the introduction to this documentation, circuits is:</p>
<p>a <strong>Lightweight</strong> <strong>Event</strong> driven <strong>Framework</strong> for the
<a class="reference external" href="http://www.python.org/">Python Programming Language</a> with a
strong <strong>Component</strong> Architecture.</p>
<p>There is a certain style to programming with the circuits framework. It might
be a little foreign at first, but once you get the hang of it, it&#8217;s actually
fairly straight forward.</p>
<p>In circuits, you implement a functional system by implementing smaller
functional components that interact together to produce more complex
behavior. For example, Component A might be responsible for doing a set
of tasks, while Component B is responsible for another set of tasks. The
two components might occasionally communicate some information (<em>by passing
messages/events</em>) to cooperate accomplishing bigger tasks. Designing your
system/application this way encourages a decoupled design and components
in circuits are designed to help accomplish this.</p>
<p>This is called the <strong>Component Architecture</strong>.</p>
<p>The three most important things in circuits are;</p>
<ul class="simple">
<li>Events</li>
<li>Components</li>
<li>Interaction between components</li>
</ul>
<p>Oh and by the way... In case you&#8217;re confused, circuits is completely
asynchronous in nature. This means things are performed in a highly
concurrent way and circuits encourages concurrent and distributed
programming.</p>
<p>Without further ado, let&#8217;s start introducing concepts in circuits...</p>
</div>
<div class="section" id="events">
<h2>Events<a class="headerlink" href="#events" title="Permalink to this headline">¶</a></h2>
<p>In circuits, information is passed around components in the form of events
(<em>or messages</em>). circuits defines an Event class which is used to create an
actual Event object which holds Event data and properties about that event.</p>
<p>The Event object is what is passed around a system of components and also
what is passed to other processes or remote nodes (<em>by using a Bridge</em>).</p>
<div class="section" id="creating-an-event">
<h3>Creating an event<a class="headerlink" href="#creating-an-event" title="Permalink to this headline">¶</a></h3>
<p>To create an event, simply create an instance of the Event class and pass
any required data to its constructor. For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">e</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">op</span><span class="o">=</span><span class="s">&quot;add&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This creates an Event object containing two pieces of data:</p>
<ul class="simple">
<li>A list containing the numbers: 1, 2, 3</li>
<li>A string &#8220;add&#8221; whoose key is <tt class="docutils literal"><span class="pre">op</span></tt> (<em>stored as kwargs</em>).</li>
</ul>
<p>The Event class&#8217;s constructor is defined as:</p>
<div class="highlight-python"><pre>class Event(object):

   def __init__(self, ``*args, **kwargs``):
      ...</pre>
</div>
<dl class="docutils">
<dt><strong>Note</strong>: Normally you would subclass <tt class="docutils literal"><span class="pre">Event</span></tt> and create your own classes of</dt>
<dd>events with appropriate docstrings describing what the event is and
what it&#8217;s used for. You may even create constraints in the args and
keyword args that can be passed to it during initialization.</dd>
</dl>
</div>
<div class="section" id="using-an-event">
<h3>Using an Event<a class="headerlink" href="#using-an-event" title="Permalink to this headline">¶</a></h3>
<p>Once an Event object is created, you can push/fire it into a system by calling
the <tt class="docutils literal"><span class="pre">.push(...)</span></tt> or <tt class="docutils literal"><span class="pre">.fire(...)</span></tt> method on any Component in the system or
Manager. For example:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">circuits</span> <span class="kn">import</span> <span class="n">Event</span><span class="p">,</span> <span class="n">Manager</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">Manager</span><span class="p">()</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span><span class="s">&quot;foo&quot;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">Event</span><span class="p">(</span><span class="s">&quot;bar&quot;</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
<p>Now this doesn&#8217;t do anything very useful by itself, but we&#8217;ll get to more
useful things later...</p>
</div>
</div>
<div class="section" id="event-handlers">
<h2>Event Handlers<a class="headerlink" href="#event-handlers" title="Permalink to this headline">¶</a></h2>
<p>In order to do useful things with events and components we need a way to
create <strong>Event Handlers</strong> that react to events. In circuits there are two
types of handlers: <strong>Listeners</strong> and <strong>Filters</strong>.</p>
<p>A Listener is an Event Handler that simply &#8220;listens&#8221; for an Event while a
Filter is an Event Handler with a higher priority than Listeners and is
capable of filtering the Event from other handlers.</p>
<p>To create an Event Handler (<em>a Listener</em>) simply use the <tt class="docutils literal"><span class="pre">handler(...)</span></tt>
decorator on a Component:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">circuits</span> <span class="kn">import</span> <span class="n">handler</span><span class="p">,</span> <span class="n">Component</span>

<span class="k">class</span> <span class="nc">System</span><span class="p">(</span><span class="n">Component</span><span class="p">):</span>

   <span class="nd">@handler</span><span class="p">(</span><span class="s">&quot;hello&quot;</span><span class="p">)</span>
   <span class="k">def</span> <span class="nf">onHello</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="k">print</span> <span class="s">&quot;Hello World!&quot;</span>
</pre></div>
</td></tr></table></div>
<p>This will create a Component called <tt class="docutils literal"><span class="pre">System</span></tt> that defines an Event Handler
that listens to the channel &#8220;hello&#8221;.</p>
<dl class="docutils">
<dt><strong>Note:</strong></dt>
<dd><ul class="first last simple">
<li>The Component automatically defines methods to be Event Handlers that listen
to a channel that is the name of the method. If a Component defines a method
called <tt class="docutils literal"><span class="pre">foo</span></tt>, an an Event Handler will be created that listens to the
channel &#8220;foo&#8221;.</li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="components">
<h2>Components<a class="headerlink" href="#components" title="Permalink to this headline">¶</a></h2>
<p>What makes circuits unique in its own way is its <strong>Component Architecture</strong>.
The &#8220;circuits way&#8221; (tm) is to create components that represent different
functional parts of your system or application. One of the key concepts
is to create more complex components from simpler components. This is a bit
different to subclassing and using multiple inheritance in OOP
(<em>Object Orientated Programming</em>). Components are registered to one another
in a directed graph/structure giving a system/application great flexibility.
Components can be registered and unregistered at run-time and even modified.</p>
<p>A Component is also a Manager and every Component can be run independently.</p>
<p>There are three ways in which you can start a Component/Manager:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">.run()</span></tt>: running in the main thread.</li>
<li><tt class="docutils literal"><span class="pre">.start()</span></tt>: running in a new separate thread.</li>
<li><tt class="docutils literal"><span class="pre">.start(process=True)</span></tt>: running in a new separate process.</li>
</ul>
<p>Let&#8217;s look at a few common things that components are used for...</p>
<div class="section" id="defining-a-new-component">
<h3>Defining a new Component<a class="headerlink" href="#defining-a-new-component" title="Permalink to this headline">¶</a></h3>
<p>To define a new (<em>more complex</em>) Component, simply create a new class that
derives from <tt class="docutils literal"><span class="pre">Component</span></tt>:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">circuits</span> <span class="kn">import</span> <span class="n">Component</span>

<span class="k">class</span> <span class="nc">System</span><span class="p">(</span><span class="n">Component</span><span class="p">):</span>
   <span class="sd">&quot;&quot;&quot;My System Component&quot;&quot;&quot;</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="registering-components">
<h3>Registering Components<a class="headerlink" href="#registering-components" title="Permalink to this headline">¶</a></h3>
<p>Components are registered to one another or a Manager by simply calling
the <tt class="docutils literal"><span class="pre">.register(...)</span></tt> method of a Component or by using the short-hand
<tt class="docutils literal"><span class="pre">+</span></tt> or <tt class="docutils literal"><span class="pre">+=</span></tt> syntax. For example:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">circuits</span> <span class="kn">import</span> <span class="n">handler</span><span class="p">,</span> <span class="n">Event</span><span class="p">,</span> <span class="n">Component</span><span class="p">,</span> <span class="n">Debugger</span>

<span class="k">class</span> <span class="nc">Add</span><span class="p">(</span><span class="n">Event</span><span class="p">):</span>
   <span class="sd">&quot;&quot;&quot;Add Event&quot;&quot;&quot;</span>

<span class="k">class</span> <span class="nc">Print</span><span class="p">(</span><span class="n">Event</span><span class="p">):</span>
   <span class="sd">&quot;&quot;&quot;Print Event&quot;&quot;&quot;</span>

   <span class="n">end</span> <span class="o">=</span> <span class="s">&quot;print_ended&quot;</span><span class="p">,</span>

<span class="k">class</span> <span class="nc">Adder</span><span class="p">(</span><span class="n">Component</span><span class="p">):</span>

   <span class="nd">@handler</span><span class="p">(</span><span class="s">&quot;add&quot;</span><span class="p">)</span>
   <span class="k">def</span> <span class="nf">onAdd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">Print</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">))</span>

<span class="k">class</span> <span class="nc">Printer</span><span class="p">(</span><span class="n">Component</span><span class="p">):</span>

   <span class="nd">@handler</span><span class="p">(</span><span class="s">&quot;print&quot;</span><span class="p">)</span>
   <span class="k">def</span> <span class="nf">onPrint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
      <span class="k">print</span> <span class="n">s</span>

<span class="k">class</span> <span class="nc">System</span><span class="p">(</span><span class="n">Component</span><span class="p">):</span>

   <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="nb">super</span><span class="p">(</span><span class="n">System</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>

      <span class="n">Debugger</span><span class="p">()</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
      <span class="bp">self</span> <span class="o">+=</span> <span class="p">(</span><span class="n">Adder</span><span class="p">()</span> <span class="o">+</span> <span class="n">Printer</span><span class="p">())</span>

   <span class="k">def</span> <span class="nf">started</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">component</span><span class="p">,</span> <span class="n">mode</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">Add</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

   <span class="k">def</span> <span class="nf">print_ended</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
      <span class="k">raise</span> <span class="ne">SystemExit</span><span class="p">,</span> <span class="mi">0</span>

<span class="n">System</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>Although this example above seems quite complex and uses quite a few of
circuits&#8217; features, it is actually quite simple. You can learn more
about some of the features used above in later documentation but the key
things here are lines 28 and 29 showing the different ways of registering
components.</p>
<p>Here&#8217;s the output of the above example system/application:</p>
<div class="highlight-sh"><div class="highlight"><pre><span class="nv">$ </span>python demo.py
&lt;Registered<span class="o">[</span>*:registered<span class="o">]</span> <span class="o">[</span>&lt;Debugger/* <span class="o">(</span><span class="nv">queued</span><span class="o">=</span>0, <span class="nv">channels</span><span class="o">=</span>1, <span class="nv">handlers</span><span class="o">=</span>1<span class="o">)</span> <span class="o">[</span>S<span class="o">]</span>&gt;, &lt;System/* <span class="o">(</span><span class="nv">queued</span><span class="o">=</span>0, <span class="nv">channels</span><span class="o">=</span>5, <span class="nv">handlers</span><span class="o">=</span>5<span class="o">)</span> <span class="o">[</span>R<span class="o">]</span>&gt;<span class="o">]</span> <span class="o">{}</span>&gt;
&lt;Registered<span class="o">[</span>*:registered<span class="o">]</span> <span class="o">[</span>&lt;Printer/* <span class="o">(</span><span class="nv">queued</span><span class="o">=</span>0, <span class="nv">channels</span><span class="o">=</span>1, <span class="nv">handlers</span><span class="o">=</span>1<span class="o">)</span> <span class="o">[</span>S<span class="o">]</span>&gt;, &lt;Adder/* <span class="o">(</span><span class="nv">queued</span><span class="o">=</span>0, <span class="nv">channels</span><span class="o">=</span>2, <span class="nv">handlers</span><span class="o">=</span>2<span class="o">)</span> <span class="o">[</span>S<span class="o">]</span>&gt;<span class="o">]</span> <span class="o">{}</span>&gt;
&lt;Registered<span class="o">[</span>*:registered<span class="o">]</span> <span class="o">[</span>&lt;Adder/* <span class="o">(</span><span class="nv">queued</span><span class="o">=</span>0, <span class="nv">channels</span><span class="o">=</span>2, <span class="nv">handlers</span><span class="o">=</span>2<span class="o">)</span> <span class="o">[</span>S<span class="o">]</span>&gt;, &lt;System/* <span class="o">(</span><span class="nv">queued</span><span class="o">=</span>0, <span class="nv">channels</span><span class="o">=</span>5, <span class="nv">handlers</span><span class="o">=</span>5<span class="o">)</span> <span class="o">[</span>R<span class="o">]</span>&gt;<span class="o">]</span> <span class="o">{}</span>&gt;
&lt;Started<span class="o">[</span>*:started<span class="o">]</span> <span class="o">[</span>&lt;System/* <span class="o">(</span><span class="nv">queued</span><span class="o">=</span>0, <span class="nv">channels</span><span class="o">=</span>5, <span class="nv">handlers</span><span class="o">=</span>5<span class="o">)</span> <span class="o">[</span>R<span class="o">]</span>&gt;, None<span class="o">]</span> <span class="o">{}</span>&gt;
&lt;Add<span class="o">[</span>*:add<span class="o">]</span> <span class="o">[</span>4, 5<span class="o">]</span> <span class="o">{}</span>&gt;
&lt;Print<span class="o">[</span>*:print<span class="o">]</span> <span class="o">[</span>9<span class="o">]</span> <span class="o">{}</span>&gt;
9
&lt;End<span class="o">[</span>*:print_ended<span class="o">]</span> <span class="o">[</span>&lt;Print<span class="o">[</span>*:print<span class="o">]</span> <span class="o">[</span>9<span class="o">]</span> <span class="o">{}</span>&gt;, &lt;bound method Printer.onPrint of &lt;Printer/* <span class="o">(</span><span class="nv">queued</span><span class="o">=</span>0, <span class="nv">channels</span><span class="o">=</span>1, <span class="nv">handlers</span><span class="o">=</span>1<span class="o">)</span> <span class="o">[</span>S<span class="o">]</span>&gt;&gt;, None<span class="o">]</span> <span class="o">{}</span>&gt;
</pre></div>
</div>
<p>Don&#8217;t worry about understanding the output above right now. Most of this is
events flowing through the system and printed to the screen by the Debugger
Component so you can see what&#8217;s going on.</p>
</div>
<div class="section" id="running-starting-components">
<h3>Running/Starting Components<a class="headerlink" href="#running-starting-components" title="Permalink to this headline">¶</a></h3>
<p>As stated, you can start a Component in one of three ways. Line #37 in the
above example could have been one of:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">System</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">()</span> <span class="c"># start in main thread.</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">System</span><span class="p">()</span><span class="o">.</span><span class="n">start</span><span class="p">()</span> <span class="c"># start in a new separate thread.</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">System</span><span class="p">()</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">process</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c"># start in a new separate process.</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="values-and-future-values">
<h2>Values and Future Values<a class="headerlink" href="#values-and-future-values" title="Permalink to this headline">¶</a></h2>
<p>Now no Event-Driven, Asynchronous Framewotk with a Component Architecture would
be complete unless you could do useful things like compute values, nested
values (<em>those which have not been computed yet</em>) and future values
(<em>values which take time to compute - potentially blocking</em>).</p>
<p>circuits has built-in support for all of this and more!</p>
<p>Let&#8217;s look at two commonly used features, Values and Future Values...</p>
<div class="section" id="values">
<h3>Values<a class="headerlink" href="#values" title="Permalink to this headline">¶</a></h3>
<p>Everytime you push/fire an Event, the return value is a <tt class="docutils literal"><span class="pre">Value</span></tt> object
with some very useful properties and behaviors.</p>
<p>Let&#8217;s consider the following python interactive session:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">circuits</span> <span class="kn">import</span> <span class="n">Event</span><span class="p">,</span> <span class="n">Component</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Test</span><span class="p">(</span><span class="n">Component</span><span class="p">):</span>
<span class="gp">... </span>   <span class="k">def</span> <span class="nf">event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="gp">... </span>      <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test</span> <span class="o">=</span> <span class="n">Test</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">Event</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">x</span>
<span class="go">9</span>
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">x</span></tt> in the session above is an instance of a <tt class="docutils literal"><span class="pre">Value</span></tt> which is used to
hold and represent the final computed value of an Event and its associated
Event Handlers.</p>
</div>
<div class="section" id="future-values">
<h3>Future Values<a class="headerlink" href="#future-values" title="Permalink to this headline">¶</a></h3>
<p>Future Values are very similar to Values, the only difference being that
a Future Value is computed in a Thread and the Event Handler executed in
this new Thread. This is to ensure that potentially blocking operations
do not block and are asynchronous.</p>
<p>A quick modification of the previous example to demonstrate:</p>
<div class="highlight-python"><pre>   &gt;&gt;&gt; from time import sleep
&gt;&gt;&gt; from circuits import future, Event, Component
&gt;&gt;&gt; class Test(Component):
...    @future()
...    def event(self, x, y):
...       sleep(5) # simulate long computation
...       return x + y
...
&gt;&gt;&gt; test = Test()
&gt;&gt;&gt; test.start()
&gt;&gt;&gt; x = test.push(Event(4, 5))
&gt;&gt;&gt; x.result
False
&gt;&gt;&gt; print x
9
&gt;&gt;&gt; x.result
True</pre>
</div>
<p>The first time <tt class="docutils literal"><span class="pre">x.result</span></tt> is evaluated, it is <tt class="xref docutils literal"><span class="pre">False</span></tt> as the Event Handler
has not yet completed and the computation has not finished. The 2nd time
we try to use <tt class="docutils literal"><span class="pre">x</span></tt> (<em>after 5s</em>), we get its computed value. The entire
operations is non-blocking/asynchronous.</p>
</div>
</div>
<div class="section" id="networking-and-i-o">
<h2>Networking and I/O<a class="headerlink" href="#networking-and-i-o" title="Permalink to this headline">¶</a></h2>
<p>As you&#8217;d expect, circuits does come complete with non-blocking/asynchronous
networking and i/o components allowing you to build systems and applications
that require network/socket and file operations. This tutorial however is
not intended as an introduction to Networking, Socket Programming, etc...</p>
<p>Instead here are three very simple examples to serve as demonstrations
of Server/Client sockets and File I/O:</p>
<p>Echo Server:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">circuits.net.sockets</span> <span class="kn">import</span> <span class="n">TCPServer</span><span class="p">,</span> <span class="n">Write</span>

<span class="k">class</span> <span class="nc">EchoServer</span><span class="p">(</span><span class="n">TCPServer</span><span class="p">):</span>

   <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sock</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">Write</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="n">data</span><span class="p">))</span>

<span class="n">EchoServer</span><span class="p">(</span><span class="mi">8000</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>Echo Client:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">circuits.io</span> <span class="kn">import</span> <span class="n">stdin</span>
<span class="kn">from</span> <span class="nn">circuits</span> <span class="kn">import</span> <span class="n">handler</span><span class="p">,</span> <span class="n">Component</span>
<span class="kn">from</span> <span class="nn">circuits.net.sockets</span> <span class="kn">import</span> <span class="n">TCPClient</span><span class="p">,</span> <span class="n">Connect</span><span class="p">,</span> <span class="n">Write</span>

<span class="k">class</span> <span class="nc">EchoClient</span><span class="p">(</span><span class="n">Component</span><span class="p">):</span>

   <span class="n">channel</span> <span class="o">=</span> <span class="s">&quot;echo&quot;</span>

   <span class="n">stdin</span> <span class="o">=</span> <span class="n">stdin</span>

   <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="nb">super</span><span class="p">(</span><span class="n">EchoClient</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>

      <span class="n">TCPClient</span><span class="p">(</span><span class="n">channel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">channel</span><span class="p">)</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">Connect</span><span class="p">(</span><span class="s">&quot;127.0.0.1&quot;</span><span class="p">,</span> <span class="mi">8000</span><span class="p">))</span>

   <span class="k">def</span> <span class="nf">connected</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">):</span>
      <span class="k">print</span> <span class="s">&quot;Connected to </span><span class="si">%s</span><span class="s">:</span><span class="si">%d</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span>

   <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
      <span class="k">print</span> <span class="n">data</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

   <span class="nd">@handler</span><span class="p">(</span><span class="s">&quot;read&quot;</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="n">stdin</span><span class="p">)</span>
   <span class="k">def</span> <span class="nf">stdin_read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">Write</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

<span class="n">EchoClient</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>Cat:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">sys</span>

<span class="kn">from</span> <span class="nn">circuits.io</span> <span class="kn">import</span> <span class="n">stdout</span><span class="p">,</span> <span class="n">File</span><span class="p">,</span> <span class="n">Write</span>

<span class="k">class</span> <span class="nc">Cat</span><span class="p">(</span><span class="n">File</span><span class="p">):</span>

   <span class="n">stdout</span> <span class="o">=</span> <span class="n">stdout</span>

   <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">Write</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">target</span><span class="o">=</span><span class="n">stdout</span><span class="p">)</span>

   <span class="k">def</span> <span class="nf">eof</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="k">raise</span> <span class="ne">SystemExit</span><span class="p">,</span> <span class="mi">0</span>

<span class="n">Cat</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>circuits comes shipped with the following networking, polling and i/o support:</p>
<ul>
<li><dl class="first docutils">
<dt>Sockets: TCPServer, TCPClient, UDPServer, UDPClient, UNIXServer, UNIXClient</dt>
<dd><p class="first last">and Pipe</p>
</dd>
</dl>
</li>
<li><p class="first">Pollers: Select, Poll and EPoll</p>
</li>
<li><p class="first">I/O: File and Serial</p>
</li>
</ul>
</div>
<div class="section" id="development-tools">
<h2>Development Tools<a class="headerlink" href="#development-tools" title="Permalink to this headline">¶</a></h2>
<p>circuits includes various tools useful while developing a system/application.</p>
<div class="section" id="debugger">
<h3>Debugger<a class="headerlink" href="#debugger" title="Permalink to this headline">¶</a></h3>
<p>Often while developing a new system/application, you&#8217;d like to know what&#8217;s
going on and the sequence of events flowing through the system.</p>
<p>circuits contains a builtin <tt class="docutils literal"><span class="pre">Debugger</span></tt> Component for this very purpose
with file and logging support. To use it simply register it to the system.</p>
<p>Example:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">circuits</span> <span class="kn">import</span> <span class="n">Component</span><span class="p">,</span> <span class="n">Debugger</span>

<span class="k">class</span> <span class="nc">System</span><span class="p">(</span><span class="n">Component</span><span class="p">):</span>
   <span class="sd">&quot;&quot;&quot;My System&quot;&quot;&quot;</span>

<span class="p">(</span><span class="n">System</span><span class="p">()</span> <span class="o">+</span> <span class="n">Debugger</span><span class="p">())</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="tools">
<h3>Tools<a class="headerlink" href="#tools" title="Permalink to this headline">¶</a></h3>
<p><tt class="docutils literal"><span class="pre">circuits.tools</span></tt> contains various utility functions also useful for
development, debugging, etc. The two most common that you&#8217;ll likely
use are:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">inspect(x)</span></tt>: print a detailed report of the system/component.</li>
<li><tt class="docutils literal"><span class="pre">graph(x)</span></tt>: print (<em>and optionally create a .dot/.png</em>) graph of the system structure.</li>
</ul>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Tutorial</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#events">Events</a><ul>
<li><a class="reference internal" href="#creating-an-event">Creating an event</a></li>
<li><a class="reference internal" href="#using-an-event">Using an Event</a></li>
</ul>
</li>
<li><a class="reference internal" href="#event-handlers">Event Handlers</a></li>
<li><a class="reference internal" href="#components">Components</a><ul>
<li><a class="reference internal" href="#defining-a-new-component">Defining a new Component</a></li>
<li><a class="reference internal" href="#registering-components">Registering Components</a></li>
<li><a class="reference internal" href="#running-starting-components">Running/Starting Components</a></li>
</ul>
</li>
<li><a class="reference internal" href="#values-and-future-values">Values and Future Values</a><ul>
<li><a class="reference internal" href="#values">Values</a></li>
<li><a class="reference internal" href="#future-values">Future Values</a></li>
</ul>
</li>
<li><a class="reference internal" href="#networking-and-i-o">Networking and I/O</a></li>
<li><a class="reference internal" href="#development-tools">Development Tools</a><ul>
<li><a class="reference internal" href="#debugger">Debugger</a></li>
<li><a class="reference internal" href="#tools">Tools</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="installing.html"
                        title="previous chapter">Installing</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="manual.html"
                        title="next chapter">Manual</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/tutorial.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="manual.html" title="Manual"
             >next</a> |</li>
        <li class="right" >
          <a href="installing.html" title="Installing"
             >previous</a> |</li>
        <li><a href="index.html">circuits v1.5 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2004-2011, James Mills.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.7.
    </div>
  </body>
</html>