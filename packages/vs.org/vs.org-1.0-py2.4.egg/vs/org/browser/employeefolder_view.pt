 <html xmlns="http://www.w3.org/1999/xhtml"
          xmlns:tal="http://xml.zope.org/namespaces/tal"
          xmlns:metal="http://xml.zope.org/namespaces/metal"
          xmlns:i18n="http://xml.zope.org/namespaces/i18n"
          metal:use-macro="here/main_template/macros/master"
          i18n:domain="vs.org">
 <body>
    <div metal:fill-slot="main">
        <tal:main-macro 
            metal:define-macro="main"
            tal:define="kssClassesView context/@@kss_field_decorator_view;
                        getKssClasses nocall:kssClassesView/getKssClassesInlineEditable;
                        templateId template/getId;">

            <div tal:replace="structure provider:plone.abovecontenttitle" />
            <h1 class="documentFirstHeading"> 
                <metal:field use-macro="python:here.widget('title', mode='view')">
                            Title
                </metal:field>
            </h1>
            <div tal:replace="structure provider:plone.belowcontenttitle" />

            <p metal:use-macro="here/kss_generic_macros/macros/generic_description_view">
                Description
            </p>
            <div tal:replace="structure provider:plone.abovecontentbody" />

            <form name="searchform"
                  action="search"
                  method="post"
                  tal:attributes="action string:${context/@@plone_context_state/object_url}">

                <input type="hidden" name="path" tal:attributes="value python:'/'.join(context.getPhysicalPath())" />

                <label for="lastname" i18n:translate="label_lastname">Lastname</label>
                <input name="lastname"
                       id="lastname"
                       type="text"
                       size="20"
                       value=""
                       title="Lastname"
                       tal:attributes="value request/lastname|nothing;"
                       class="inputLabel" />

                <input class="searchButton"
                       type="submit"
                       value="Search"
                       i18n:attributes="value label_search;" i18n:domain="plone" />
            </form>

            <div id="employeefolderSearchResult" 
                tal:define="
                    b_size python:30;b_start python:0;b_start request/b_start | b_start;
                    use_types_blacklist python:False;
                    use_navigation_root request/use_navigation_root | python:True;
                    results python: context.queryCatalog(REQUEST=request,use_types_blacklist=use_types_blacklist, use_navigation_root=use_navigation_root);
                    Batch python:modules['Products.CMFPlone'].Batch;
                    batch python:Batch(results, b_size, int(b_start), orphan=1);
                    normalizeString nocall:context/@@plone/normalizeString;"
                    >

                <div tal:condition="not: results" i18n:translate="label_no_results">No result</div>                    

                <dl class="searchResults" tal:condition="results">
                    <tal:results repeat="result batch">
                        <tal:entry define="url result/getURL;
                            employee result/getObject;
                            result_type result/portal_type;
                            item_icon python:plone_view.getIcon(result);">
                            <dt tal:define="item_wf_state_class string:state-${result/review_state};"
                                tal:attributes="class python:'contenttype-' + normalizeString(result.portal_type)">
                                <img tal:replace="structure item_icon/html_tag" />
                                <a href="#" 
                                   tal:attributes="href url; class string:$item_wf_state_class"
                                   tal:content="result/pretty_title_or_id">url</a>
                            </dt>
                            <dd>
                                <p tal:repeat="number_type employee/getNumberTypes">
                                    <tal:loop repeat="number python: employee.getNumbersByType(number_type)">
                                        <img class="entry_label"
                                         tal:attributes="src string:$portal_url/++resource++vs.org.images/${number_type/lower}_icon.gif;
                                                         title number_type;
                                                         alt   number_type;"
                                         i18n:attributes="title; alt"  />
                                        <span tal:content="number" class="portlet_content" />
                                    </tal:loop>
                                </p>
                                <p tal:condition="employee/getEmail">
                                    <img src="mail_icon"
                                        tal:attributes="src string:${portal_url}/++resource++vs.org.images/email_icon.gif;"
                                        title="label_email"
                                        alt="label_email"
                                        i18n:attributes="title" />
                                    <a href="mail" tal:attributes="href string:mailto:${employee/getEmail}"
                                       tal:content="employee/getEmail" 
                                    />
                                </p>
                            </dd>
                        </tal:entry>
                    </tal:results>
                </dl>
            </div>

            <div tal:replace="structure provider:plone.belowcontentbody" />
        </tal:main-macro>
    </div>
</body>
</html>
